(self.webpackChunkFrontend=self.webpackChunkFrontend||[]).push([[2856],{54411:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:String(t)}n(58188),n(88233),n(28673),n(15735),n(6886),n(95342),n(32501),n(71372),n(18178),n(43430),n(9575),n(96264),n(34115),n(634),n(71245),n(20796);var a=function(){"use strict";function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),null==t&&(t=[]),this.changes=t,null==n&&(n=[]),this.comments=n,this.track_changes=!1,this.id_seed=e.generateIdSeed(),this.id_increment=0,this._dirtyState={comment:{moved:{},removed:{},added:{}},change:{moved:{},removed:{},added:{}}}}var t,n,r;return t=e,r=[{key:"generateIdSeed",value:function(){var e=Math.floor(32767*Math.random()).toString(16),t=Math.floor(16777216*Math.random()).toString(16),n=Math.floor((new Date).valueOf()/1e3).toString(16);return"00000000".substr(0,8-n.length)+n+"000000".substr(0,6-t.length)+t+"0000".substr(0,4-e.length)+e}},{key:"generateId",value:function(){return this.generateIdSeed()+"000001"}}],(n=[{key:"getIdSeed",value:function(){return this.id_seed}},{key:"setIdSeed",value:function(e){this.id_seed=e,this.id_increment=0}},{key:"newId",value:function(){this.id_increment++;var e=this.id_increment.toString(16);return this.id_seed+"000000".substr(0,6-e.length)+e}},{key:"getComment",value:function(e){var t=null;for(var n of this.comments)if(n.id===e){t=n;break}return t}},{key:"removeCommentId",value:function(e){var t=this.getComment(e);null!=t&&(this.comments=this.comments.filter((function(t){return t.id!==e})),this._markAsDirty(t,"comment","removed"))}},{key:"moveCommentId",value:function(e,t,n){for(var r of this.comments)r.id===e&&(r.op.p=t,r.op.c=n,this._markAsDirty(r,"comment","moved"))}},{key:"getChange",value:function(e){var t=null;for(var n of this.changes)if(n.id===e){t=n;break}return t}},{key:"getChanges",value:function(e){var t=[],n={};for(var r of e)n[r]=!0;for(var o of this.changes)n[o.id]&&(delete n[o.id],t.push(o));return t}},{key:"removeChangeId",value:function(e){var t=this.getChange(e);null!=t&&this._removeChange(t)}},{key:"removeChangeIds",value:function(e){if(null!=e&&0!==e.length){var t={};for(var n of e)t[n]=!0;var r=[];for(var o of this.changes)t[o.id]?(delete t[o.id],this._markAsDirty(o,"change","removed")):r.push(o);this.changes=r}}},{key:"validate",value:function(e){for(var t of this.changes)if(null!=t.op.i&&e.slice(t.op.p,t.op.p+t.op.i.length)!==t.op.i)throw new Error("insertion does not match text in document");for(var n of this.comments)if(e.slice(n.op.p,n.op.p+n.op.c.length)!==n.op.c)throw new Error("comment does not match text in document")}},{key:"applyOp",value:function(e,t){if(null==t&&(t={}),null==t.ts&&(t.ts=new Date),null!=e.i)this.applyInsertToChanges(e,t),this.applyInsertToComments(e);else if(null!=e.d)this.applyDeleteToChanges(e,t),this.applyDeleteToComments(e);else{if(null==e.c)throw new Error("unknown op type");this.addComment(e,t)}}},{key:"applyOps",value:function(e,t){for(var n of(null==t&&(t={}),e))this.applyOp(n,t)}},{key:"addComment",value:function(e,t){var n;null!=this.getComment(e.t)?this.moveCommentId(e.t,e.p,e.c):(this.comments.push(n={id:e.t||this.newId(),op:{c:e.c,p:e.p,t:e.t},metadata:t}),this._markAsDirty(n,"comment","added"))}},{key:"applyInsertToComments",value:function(e){for(var t of this.comments)if(e.p<=t.op.p)t.op.p+=e.i.length,this._markAsDirty(t,"comment","moved");else if(e.p<t.op.p+t.op.c.length){var n=e.p-t.op.p;t.op.c=t.op.c.slice(0,+(n-1)+1||void 0)+e.i+t.op.c.slice(n),this._markAsDirty(t,"comment","moved")}}},{key:"applyDeleteToComments",value:function(e){var t=e.p,n=e.d.length,r=e.p+n;for(var o of this.comments){var i=o.op.p,a=o.op.p+o.op.c.length,c=a-i;if(r<=i)o.op.p-=n,this._markAsDirty(o,"comment","moved");else if(t>=a);else{var l=void 0,s=void 0;s=t<=i?"":o.op.c.slice(0,t-i),l=r>=a?"":o.op.c.slice(r-i);var u=o.op.c.slice(s.length,c-l.length),d=Math.max(0,i-t);if(u!==e.d.slice(d).slice(0,u.length))throw new Error("deleted content does not match comment content");o.op.p=Math.min(i,t),o.op.c=s+l,this._markAsDirty(o,"comment","moved")}}}},{key:"applyInsertToChanges",value:function(e,t){for(var n,r=e.p,o=e.i.length,i=e.p+o,a=!!e.u,c=!1,l=null,s=[],u=[],d=[],f=0;f<this.changes.length;f++){var h=(n=this.changes[f]).op.p;if(null!=n.op.d)r<h?(n.op.p+=o,s.push(n)):r===h&&(a&&n.op.d.length>=e.i.length&&n.op.d.slice(0,e.i.length)===e.i?(n.op.d=n.op.d.slice(e.i.length),n.op.p+=e.i.length,""===n.op.d?u.push(n):s.push(n),c=!0):(n.op.p+=o,s.push(n)));else if(null!=n.op.i){var p=void 0,m=h+n.op.i.length,g=r>=h&&r<=m,v=t.user_id===n.metadata.user_id,y=this.changes[f+1],_=null!=y&&null!=y.op.d&&e.p===m&&y.op.p===e.p,b=a&&_&&y.op.d.slice(0,e.i.length)===e.i,w=null!=l&&null!=l.op.d&&l.op.p===i;if(this.track_changes&&g&&!w&&!c&&!b&&v)p=r-h,n.op.i=n.op.i.slice(0,p)+e.i+n.op.i.slice(p),n.metadata.ts=t.ts,c=!0,s.push(n);else if(r<=h)n.op.p+=o,s.push(n);else if((!v||!this.track_changes)&&h<r&&r<m){p=r-h;var k=n.op.i.slice(0,p),x=n.op.i.slice(p);n.op.i=k,s.push(n);var j={op:{i:x,p:h+p+o},metadata:{}};for(var T in n.metadata){var S=n.metadata[T];j.metadata[T]=S}d.push(j)}}l=n}for(var I of(this.track_changes&&!c&&this._addOp(e,t),d)){var C=I;e=C.op,t=C.metadata,this._addOp(e,t)}for(n of u)this._removeChange(n);for(n of s)this._markAsDirty(n,"change","moved")}},{key:"applyDeleteToChanges",value:function(e,t){var n=this,r=e.p,o=e.d.length,i=e.p+o,a=[],c=[],l=[];for(var s of this.changes){var u=void 0;if(null!=s.op.i){var d=(u=s.op.p)+s.op.i.length;if(i<=u)s.op.p-=o,c.push(s);else if(r>=d);else{var f=void 0,h=void 0,p=void 0,m=void 0;r>=u?(h="",m=s.op.i.slice(0,r-u)):(h=e.d.slice(0,u-r),m=""),i<=d?(f="",p=s.op.i.slice(i-u)):(f=e.d.slice(d-r),p="");var g=m+p;g.length>0?(s.op.i=g,s.op.p=Math.min(u,r),c.push(s)):a.push(s);var v=e.d.length-h.length-f.length,y=h.length,_={d:e.d.slice(y,y+v),p:y};_.d.length>0&&l.push(_)}}else if(null!=s.op.d)if(i<(u=s.op.p)||!this.track_changes&&i===u)s.op.p-=o,c.push(s);else if(r<=u&&u<=i)if(this.track_changes){var b=u-r;l.push({i:s.op.d,p:b}),a.push(s)}else s.op.p=r,c.push(s)}for(var w of(e={p:e.p,d:this._applyOpModifications(e.d,l)},a))e.d.length>0&&null!=w.op.d&&e.p<=w.op.p&&w.op.p<=e.p+e.d.length?(w.op.p=e.p,w.op.d=e.d,w.metadata=t,c.push(w),e.d=""):this._removeChange(w);if(this.track_changes&&e.d.length>0)this._addOp(e,t);else{var k=this._scanAndMergeAdjacentUpdates();c=c.concat(k.movedChanges);var x=function(e){n._removeChange(e),c=c.filter((function(t){return t!==e}))};for(var j of k.removeChanges)x(j)}for(var T of c)this._markAsDirty(T,"change","moved")}},{key:"_addOp",value:function(e,t){var n={id:this.newId(),op:this._clone(e),metadata:this._clone(t)};this.changes.push(n),this.changes.sort((function(e,t){var n=e.op.p-t.op.p;return 0!==n?n:null!=e.op.i&&null!=t.op.d?1:null!=e.op.d&&null!=t.op.i?-1:0})),this._markAsDirty(n,"change","added")}},{key:"_removeChange",value:function(e){this.changes=this.changes.filter((function(t){return t.id!==e.id})),this._markAsDirty(e,"change","removed")}},{key:"_applyOpModifications",value:function(e,t){for(var n of(t.sort((function(e,t){var n=t.p-e.p;return 0!==n?n:null!=e.i&&null!=t.d?1:null!=e.d&&null!=t.i?-1:0})),t))if(null!=n.i)e=e.slice(0,n.p)+n.i+e.slice(n.p);else if(null!=n.d){if(e.slice(n.p,n.p+n.d.length)!==n.d)throw new Error("deletion does not match text in document");e=e.slice(0,n.p)+e.slice(n.p+n.d.length)}return e}},{key:"_scanAndMergeAdjacentUpdates",value:function(){var e=null,t=[],n=[];for(var r of this.changes){var o,i,a;if(null!=(null===(o=e)||void 0===o?void 0:o.op.i)&&null!=r.op.i){var c=e.op.p+e.op.i.length,l=e.metadata.user_id,s=r.op.p,u=r.metadata.user_id;c===s&&l===u&&(t.push(r),e.op.i+=r.op.i,n.push(e))}else null!=(null===(i=e)||void 0===i?void 0:i.op.d)&&null!=r.op.d&&(null===(a=e)||void 0===a?void 0:a.op.p)===r.op.p?(e.op.d+=r.op.d,t.push(r),n.push(e)):e=r}return{movedChanges:n,removeChanges:t}}},{key:"resetDirtyState",value:function(){this._dirtyState={comment:{moved:{},removed:{},added:{}},change:{moved:{},removed:{},added:{}}}}},{key:"getDirtyState",value:function(){return this._dirtyState}},{key:"_markAsDirty",value:function(e,t,n){this._dirtyState[t][n][e.id]=e}},{key:"_clone",value:function(e){var t={};for(var n in e){var r=e[n];t[n]=r}return t}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=a},73720:function(e,t,n){"use strict";n.d(t,{n:function(){return i},q:function(){return o}});n(39529),n(31235),n(32501),n(18178),n(58188),n(1939);var r=3e5;function o(e,t,n){if(n.includes(t.id))return{messages:e,uniqueMessageIds:n};(n=n.slice(0)).push(t.id);var o=e[e.length-1];return{messages:e=o&&t&&t.user&&t.user.id&&t.user.id===o.user.id&&t.timestamp-o.timestamp<r?e.slice(0,e.length-1).concat({...o,id:t.id,timestamp:t.timestamp,contents:o.contents.concat(t.content)}):e.slice(0).concat({id:t.id,user:t.user,timestamp:t.timestamp,contents:[t.content]}),uniqueMessageIds:n}}function i(e,t,n){var o=e.slice(0);return n=n.slice(0),t.slice(0).reverse().forEach((function(e){if(!n.includes(e.id)){n.push(e.id);var t=o[0];t&&e&&e.user&&e.user.id===t.user.id&&t.timestamp-e.timestamp<r?(t.id=e.id,t.timestamp=e.timestamp,t.contents=[e.content].concat(t.contents)):o.unshift({id:e.id,user:e.user,timestamp:e.timestamp,contents:[e.content]})}})),{messages:o,uniqueMessageIds:n}}},51261:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372);var r=n(2784),o=n(96931),i=n(37246);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(){var e=(0,o.IM)(),t=a((0,i.Z)("project"),2),n=t[0],c=t[1],l=(0,r.useCallback)((function(e){n&&c({...n,compiler:e})}),[n,c]),s=(0,r.useCallback)((function(e){n&&c({...n,imageName:e})}),[n,c]),u=(0,r.useCallback)((function(e){n&&c({...n,spellCheckLanguage:e})}),[n,c]);(0,r.useEffect)((function(){if(!!n&&null!=e&&e.socket)return e.socket.on("compilerUpdated",l),e.socket.on("imageNameUpdated",s),e.socket.on("spellCheckLanguageUpdated",u),function(){e.socket.removeListener("compilerUpdated",l),e.socket.removeListener("imageNameUpdated",s),e.socket.removeListener("spellCheckLanguageUpdated",u)}}),[null==e?void 0:e.socket,n,l,s,u])}},77241:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372);var r=n(2784),o=n(37246),i=(n(73439),n(84050)),a=n(2982),c=n(72526);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(){var e=l((0,o.Z)("project"),2),t=e[0],n=e[1],r=(0,c.d)()._id;return async function(e,o){if(t&&t[e]!==o){await(0,a.W)(r,{[e]:o});var i="rootDocId"===e?"rootDoc_id":e;n({...t,[i]:o})}}}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=n(45177);function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(){var e=g((0,o.Z)("project"),1)[0],t=u(),n=(0,r.useCallback)((function(e){t("compiler",e).catch(m.c.error)}),[t]),c=(0,r.useCallback)((function(e){t("imageName",e).catch(m.c.error)}),[t]),l=function(){var e=d((0,o.Z)("project.rootDoc_id"),1)[0],t=(0,i._i)().permissionsLevel,n=u(),a=(0,r.useCallback)((async function(r){if(void 0!==e&&"readOnly"!==t)try{await n("rootDocId",r)}catch(e){}}),[t,e,n]);return{rootDocId:e,setRootDocId:a}}(),s=l.setRootDocId,f=l.rootDocId,p=function(){var e=h((0,o.Z)("project.spellCheckLanguage"),2),t=e[0],n=e[1],i=u();return(0,r.useCallback)((function(e){null!=t&&e!==t&&(n(e),i("spellCheckLanguage",e),(0,a._)("spellCheckLanguage",e))}),[n,t,i])}();return{compiler:null==e?void 0:e.compiler,setCompiler:n,imageName:null==e?void 0:e.imageName,setImageName:c,rootDocId:f,setRootDocId:s,spellCheckLanguage:null==e?void 0:e.spellCheckLanguage,setSpellCheckLanguage:p}}},45564:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(2784),o=n(72309),i=(n(49228),n(58188),n(34115),n(634),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372),n(76635)),a=n.n(i),c=n(37246),l=n(2982),s=n(66041);function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(){var e=function(){var e=(0,o.cq)(),t=e.userSettings,n=e.setUserSettings;return function(e,r){t[e]!==r&&(n({...t,[e]:r}),(0,l._)(e,r))}}(),t=(0,o.cq)().userSettings,n=t.overallTheme,i=t.autoComplete,d=t.autoPairDelimiters,f=t.syntaxValidation,h=t.editorTheme,p=t.mode,m=t.fontSize,g=t.fontFamily,v=t.lineHeight,y=t.pdfViewer,_=function(){var e=u((0,r.useState)(null),2),t=e[0],n=e[1],i=u((0,c.Z)("ui.loadingStyleSheet"),2),d=i[0],f=i[1],h=(0,o.cq)(),p=h.userSettings,m=h.setUserSettings,g=p.overallTheme,v=(0,r.useCallback)((function(e){m((function(t){return{...t,overallTheme:e}}))}),[m]);return(0,r.useEffect)((function(){var e,n=document.querySelector("head"),r=document.getElementById("main-stylesheet"),o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("id","main-stylesheet"),o.setAttribute("href",null!==(e=null==t?void 0:t.path)&&void 0!==e?e:"");var i=function(){f(!1),n&&r&&n.removeChild(r)};return d&&(o.addEventListener("load",i,{once:!0}),null==n||n.appendChild(o)),function(){o.removeEventListener("load",i)}}),[d,f,null==t?void 0:t.path]),(0,r.useCallback)((function(e){if(g!==e){var t=a().find((0,s.Z)("ol-overallThemes"),(function(t){return t.val===e}));t&&(f(!0),n(t),v(e),(0,l._)("overallTheme",e))}}),[g,f,v])}(),b=(0,r.useCallback)((function(t){e("autoComplete",t)}),[e]),w=(0,r.useCallback)((function(t){e("autoPairDelimiters",t)}),[e]),k=(0,r.useCallback)((function(t){e("syntaxValidation",t)}),[e]),x=(0,r.useCallback)((function(t){e("editorTheme",t)}),[e]),j=(0,r.useCallback)((function(t){e("mode",t)}),[e]),T=(0,r.useCallback)((function(t){e("fontSize",t)}),[e]),S=(0,r.useCallback)((function(t){e("fontFamily",t)}),[e]),I=(0,r.useCallback)((function(t){e("lineHeight",t)}),[e]),C=(0,r.useCallback)((function(t){e("pdfViewer",t)}),[e]);return{autoComplete:i,setAutoComplete:b,autoPairDelimiters:d,setAutoPairDelimiters:w,syntaxValidation:f,setSyntaxValidation:k,editorTheme:h,setEditorTheme:x,overallTheme:n,setOverallTheme:_,mode:p,setMode:j,fontSize:m,setFontSize:T,fontFamily:g,setFontFamily:S,lineHeight:v,setLineHeight:I,pdfViewer:y,setPdfViewer:C}}},2982:function(e,t,n){"use strict";n.d(t,{W:function(){return c},_:function(){return a}});n(58188),n(73439);var r=n(96227),o=n(28684),i=n(45177);function a(e,t){(0,r.BZ)("setting-changed",{changedSetting:e,changedSettingVal:t}),(0,o.ty)("/user/settings",{body:{[e]:t}}).catch(i.c.error)}var c=async function(e,t){await(0,o.ty)("/project/".concat(e,"/settings"),{body:{...t}})}},97502:function(e,t,n){"use strict";n.d(t,{Ek:function(){return s},Yt:function(){return u}});n(71372);var r=n(2784),o=n(47481),i=n(66041),a=n(22110),c=n(52322),l=(0,r.createContext)(void 0),s=function(e){var t=e.children,n=(0,o.O)().fileTreeData,s=(0,i.Z)("ol-project_id"),u=(0,r.useCallback)((function(e){return(0,a.Te)(n,e)}),[n]),d=(0,r.useCallback)((function(e){return(0,a.LZ)(n,e)}),[n]),f=(0,r.useCallback)((function(e){return(0,a.M2)(n,s,e)}),[n,s]),h=(0,r.useCallback)((function(e){return(0,a.XX)(n,e)}),[n]),p=(0,r.useMemo)((function(){return{pathInFolder:u,findEntityByPath:d,previewByPath:f,dirname:h}}),[u,d,f,h]);return(0,c.jsx)(l.Provider,{value:p,children:t})};function u(){var e=(0,r.useContext)(l);if(!e)throw new Error("useFileTreePathContext is only available inside FileTreePathProvider");return e}},53687:function(e,t,n){"use strict";n.d(t,{y:function(){return o}});n(28673),n(15735),n(6886);var r=n(66041);function o(e){if(!e)return 0;var t=function(e){function t(e){if(null==e)return 0;var n=0;if(e.folders)for(var r of(n+=e.folders.length,e.folders))n+=t(r);return e.docs&&(n+=e.docs.length),e.fileRefs&&(n+=e.fileRefs.length),n}return t(e)}(e),n=(0,r.Z)("ol-ExposedSettings").maxEntitiesPerProject,o=function(e,t,n){if(e>=t)return"error";if(e>=t-n)return"warning";return"success"}(t,n,Math.ceil(n/20));return{value:t,status:o,limit:n}}},55108:function(e,t,n){"use strict";n.d(t,{m:function(){return a}});n(43450),n(26936),n(28673),n(15735),n(6886),n(18178),n(43430),n(77950),n(74069),n(34115),n(634),n(58188),n(20796),n(27233),n(32501),n(88233),n(21850),n(71372);function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.docs.map((function(e){return{doc:{id:e._id,name:e.name},path:t+e.name}}));for(var o of e.folders)n.push.apply(n,r(i(o,"".concat(t).concat(o.name,"/"))));return n}function a(e){var t=i(e);return t.sort((function(e,t){var n=(e.path.match(/\//g)||[]).length,r=(t.path.match(/\//g)||[]).length;return n-r!=0?-(n-r):e.path<t.path?-1:e.path>t.path?1:0})),t}},20681:function(e,t,n){"use strict";n.d(t,{$O:function(){return h},Gd:function(){return u},RB:function(){return f},xv:function(){return d}});n(34115),n(634),n(58188),n(20796),n(27233),n(88233),n(26936),n(77950),n(21850),n(34769),n(43105),n(18178),n(32501),n(71372),n(28673),n(15735),n(6886),n(43450);var r=n(38113),o=["type"];function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function c(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n){var r=n.newName;return p(e,t,(function(e,t,n){var o=Object.assign([],e),i={...t,name:r};return o[n]=i,o}))}function d(e,t){return p(e,t,(function(e,t,n){return[].concat(c(e.slice(0,n)),c(e.slice(n+1)))}))}function f(e,t,n){var o=(0,r.we)(e,t);return o.parentFolderId===n?e:h(d(e,t),n,{...o.entity,type:o.type})}function h(e,t,n){var r=n.type,i=a(n,o);if(!r)throw new Error("Entity has no type");var l="".concat(r,"s");return p(e,t,(function(e,t,n){return e[n]={...t,[l]:[].concat(c(t[l]),[i])},e}))}function p(e,t,n){if(!t||e._id===t)return i(n([],e,0),1)[0];for(var r of["docs","fileRefs","folders"])for(var o=0;o<e[r].length;o++){var a=e[r][o];if(a._id===t)return{...e,[r]:n(e[r],a,o)}}var c=e.folders.map((function(e){return p(e,t,n)}));return{...e,folders:c}}},22110:function(e,t,n){"use strict";n.d(t,{LZ:function(){return i},M2:function(){return a},Te:function(){return o},XX:function(){return c}});n(49228),n(58188),n(18178),n(28673),n(15735),n(6886),n(16781),n(43450),n(26936),n(32501);function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=e.docs.find((function(e){return e._id===t}))||e.fileRefs.find((function(e){return e._id===t}));if(o)return n.concat([o]);for(var i of e.folders){if(i._id===t)return n.concat([i]);var a=r(i,t,n.concat([i]));if(null!==a)return a}return null}function o(e,t){var n;return(null===(n=r(e,t))||void 0===n?void 0:n.map((function(e){return e.name})).join("/"))||null}function i(e,t){if(""===t)return{entity:e,type:"folder"};var n=t.split("/"),r=n.shift(),o=n.join("/");if("."===r)return i(e,o);var a=e.docs.find((function(e){return e.name===r}));if(a)return{entity:a,type:"doc"};var c=e.fileRefs.find((function(e){return e.name===r}));if(c)return{entity:c,type:"fileRef"};for(var l of e.folders)if(l.name===r)return""===o?{entity:l,type:"folder"}:i(l,o);return null}function a(e,t,n){for(var r of["",".png",".jpg",".jpeg",".pdf",".PNG",".JPG",".JPEG",".PDF"]){var o=i(e,n+r);if(o){var a=o.entity,c=a.name,l=a._id;return{url:"/project/".concat(t,"/file/").concat(l),extension:c.slice(c.lastIndexOf(".")+1)}}}return null}function c(e,t){var n=o(e,t);return(null==n?void 0:n.split("/").slice(0,-1).join("/"))||null}},90350:function(e,t,n){"use strict";function r(e){if(!e)return 0;var t=Math.ceil((e-performance.now())/1e3);return t>0?t:0}n.d(t,{o:function(){return r}})},5446:function(e,t,n){"use strict";n.d(t,{U:function(){return J},Km:function(){return Y}});n(71372),n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850);var r=n(2784),o=(n(14121),n(60523),n(28399),n(94908),n(96928),n(61229),n(92215),n(79321),n(9575),n(96264),n(71245),n(99805),n(1939),n(34769),n(6710),n(45177));n(78297);function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}function c(e){var t=s();return function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}(this,n)}}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(s=function(){return!!e})()}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function p(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:String(t)}var g=function(){function e(t){f(this,e),this._socket=t}return p(e,null,[{key:"connect",value:function(t,n){return new e}}]),e}(),v=function(e){g.prototype[e]=function(){this._socket[e].apply(this._socket,arguments)}};for(var y of["connect","disconnect","emit","on","removeListener"])v(y);var _,b=function(e){i(n,e);var t=c(n);function n(e){var r;return f(this,n),(r=t.call(this,e)).socket={get connected(){return!1},get sessionid(){},get transport(){return{}},connect:function(){},disconnect:function(e){}},r}return p(n,[{key:"connect",value:function(){}},{key:"disconnect",value:function(e){}},{key:"emit",value:function(){}},{key:"on",value:function(){}},{key:"removeListener",value:function(){}}],[{key:"connect",value:function(){return new n}}]),n}(g),w=function(e){i(n,e);var t=c(n);function n(e){var r;return f(this,n),(r=t.call(this,e)).socket=r._socket.socket,r}return p(n,null,[{key:"connect",value:function(e,t){return new n(io.connect(e,t))}}]),n}(g),k=function(e){i(n,e);var t=c(n);function n(e,r){var o;f(this,n),(o=t.call(this,n.createNewSocket(e,r)))._url=e,o._options=r,o._events=new Map;var i=l(o);function a(){return i._socket.io&&i._socket.io.engine||{}}return o.socket={get connected(){return i._socket.connected},get sessionid(){return i._socket.id?i._socket.id:a().id},get transport(){return a().transport},connect:function(){i._replaceSocketWithNewInstance()},disconnect:function(e){return i._socket.disconnect(e)}},o}return p(n,[{key:"_on",value:function(e,t){this._events.has(e)?this._events.get(e).push(t):this._events.set(e,[t]),this._socket.on(e,t)}},{key:"on",value:function(e,t){if(n.EVENT_MAP.has(e))for(var r of n.EVENT_MAP.get(e))this._on(r,t);else this._on(e,t)}},{key:"_removeListener",value:function(e,t){if(this._events.has(e)){var n=this._events.get(e),r=n.indexOf(t);-1!==r&&n.splice(r,1)}this._socket.removeListener(e,t)}},{key:"removeListener",value:function(e,t){if(n.EVENT_MAP.has(e))for(var r of n.EVENT_MAP.get(e))this._removeListener(r,t);else this._removeListener(e,t)}},{key:"_replaceSocketWithNewInstance",value:function(){var e=this._socket,t=n.createNewSocket(this._url,this._options);this._events.forEach((function(n,r){for(var o of n)e.removeListener(r,o),t.on(r,o)})),e.connected&&e.disconnect(),this._socket=t}},{key:"connect",value:function(){this._replaceSocketWithNewInstance()}}],[{key:"connect",value:function(e,t){return t.forceNew=t["force new connection"],t.path="/"+t.resource,t.reconnection=t.reconnect,t.timeout=t["connect timeout"],new n(e,t)}},{key:"EVENT_MAP",get:function(){var e=["connect_error","connect_timeout","error"];return new Map([["connect_failed",e],["error",e]])}},{key:"createNewSocket",value:function(e,t){return io.Manager(e,t).socket("/",t)}}]),n}(g);"undefined"!=typeof io&&io?"string"==typeof io.version&&"0"===io.version.slice(0,1)?(o.c.log("[socket.io] Shim: detected v0"),_=w):(o.c.log("[socket.io] Shim: detected v2"),_=k):(o.c.log("[socket.io] Shim: socket.io is not loaded, returning noop"),_=b);var x={SocketShimNoop:b,SocketShimV0:w,SocketShimV2:k,current:_,connect:_.connect,stub:function(){return new b}},j=n(66041);function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function S(e,t,n){return(t=E(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,E(r.key),r)}}function C(e,t,n){return t&&I(e.prototype,t),n&&I(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function E(e){var t=function(e,t){if("object"!=T(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==T(t)?t:String(t)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X(e,t)}function A(e){var t=F();return function(){var n,r=Z(e);if(t){var o=Z(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return M(this,n)}}function M(e,t){if(t&&("object"===T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return P(e)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e){var t="function"==typeof Map?new Map:void 0;return D=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(F())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return n&&X(o,n.prototype),o}(e,arguments,Z(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),X(n,e)},D(e)}function F(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(F=function(){return!!e})()}function X(e,t){return X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},X(e,t)}function Z(e){return Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Z(e)}var R=36e5,U=864e5,N={readyState:WebSocket.CLOSED,forceDisconnected:!1,inactiveDisconnect:!1,lastConnectionAttempt:0,reconnectAt:null,forcedDisconnectDelay:0,error:""},W=function(e){L(n,e);var t=A(n);function n(){return O(this,n),t.apply(this,arguments)}return C(n)}(D(CustomEvent)),$=function(e){L(n,e);var t=A(n);function n(){var e;O(this,n),S(P(e=t.call(this)),"state",N),S(P(e),"connectionAttempt",null),S(P(e),"gracefullyReconnectUntil",0),S(P(e),"protocolVersion",-1),S(P(e),"reconnectCountdownInterval",0),S(P(e),"userIsLeavingPage",!1),e.lastUserActivity=performance.now(),e.idleDisconnectInterval=window.setInterval((function(){e.disconnectIfIdleSince(U)}),R),window.addEventListener("online",(function(){return e.onOnline()})),window.addEventListener("beforeunload",(function(){e.userIsLeavingPage=!0}));var r=new URL((0,j.Z)("ol-wsUrl")||"/socket.io",window.origin),i=x.connect(r.origin,{resource:r.pathname.slice(1),"auto connect":!1,"connect timeout":3e4,"force new connection":!0,query:new URLSearchParams({projectId:(0,j.Z)("ol-project_id")}).toString(),reconnect:!1});return e.socket=i,"object"!==T(window.io)?(e.switchToWsFallbackIfPossible(),o.c.error("Socket.io javascript not loaded. Please check that the real-time service is running and accessible."),e.changeState({...e.state,error:"io-not-loaded"}),M(e)):(i.on("disconnect",(function(){return e.onDisconnect()})),i.on("error",(function(){return e.onConnectError()})),i.on("connect_failed",(function(){return e.onConnectError()})),i.on("joinProjectResponse",(function(t){return e.onJoinProjectResponse(t)})),i.on("connectionRejected",(function(t){return e.onConnectionRejected(t)})),i.on("reconnectGracefully",(function(){return e.onReconnectGracefully()})),i.on("forceDisconnect",(function(t,n){return e.onForceDisconnect(n)})),e.tryReconnect(),e)}return C(n,[{key:"close",value:function(e){this.onForceDisconnect(0,e)}},{key:"tryReconnectNow",value:function(){this.tryReconnectWithBackoff(1e3)}},{key:"registerUserActivity",value:function(){this.lastUserActivity=performance.now(),this.userIsLeavingPage=!1,this.ensureIsConnected()}},{key:"changeState",value:function(e){var t=this.state;this.state=e,o.c.log("[ConnectionManager] changed state",{previousState:t,state:e}),this.dispatchEvent(new W("statechange",{detail:{state:e,previousState:t}}))}},{key:"switchToWsFallbackIfPossible",value:function(){var e=new URLSearchParams(window.location.search);return!(!(0,j.Z)("ol-wsUrl")||"fallback"===e.get("ws"))&&(e.set("ws","fallback"),window.location.search=e.toString(),!0)}},{key:"onOnline",value:function(){this.state.inactiveDisconnect||this.ensureIsConnected()}},{key:"onConnectionRejected",value:function(e){switch(null==e?void 0:e.message){case"retry":this.startAutoReconnectCountdown(0);break;case"rate-limit hit when joining project":this.changeState({...this.state,error:"rate-limited"});break;case"not authorized":case"invalid session":this.changeState({...this.state,error:"not-logged-in",forceDisconnected:!0});break;case"project not found":this.changeState({...this.state,error:"project-deleted",forceDisconnected:!0});break;default:this.changeState({...this.state,error:"unable-to-join"})}}},{key:"onConnectError",value:function onConnectError(){var e=this;null!==this.connectionAttempt&&(this.connectionAttempt++<5?setTimeout((function(){e.canReconnect()&&e.socket.socket.connect()}),this.connectionAttempt*(1+Math.random())*1e3):this.switchToWsFallbackIfPossible()||(this.disconnect(),this.changeState({...this.state,error:"unable-to-connect"})))}},{key:"onDisconnect",value:function(){this.connectionAttempt=null,this.changeState({...this.state,readyState:WebSocket.CLOSED}),this.disconnectIfIdleSince(U)||("rate-limited"===this.state.error?this.tryReconnectWithBackoff(15e3):this.startAutoReconnectCountdown(0))}},{key:"onForceDisconnect",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"maintenance";clearInterval(this.idleDisconnectInterval),clearTimeout(this.reconnectCountdownInterval),window.removeEventListener("online",this.onOnline),window.setTimeout((function(){return t.disconnect()}),1e3*e),this.changeState({...this.state,forceDisconnected:!0,forcedDisconnectDelay:e,error:n})}},{key:"onJoinProjectResponse",value:function(e){var t=e.protocolVersion,n=e.publicId;-1===this.protocolVersion||this.protocolVersion===t?(this.protocolVersion=t,this.socket.publicId=n,this.connectionAttempt=null,this.changeState({...this.state,readyState:WebSocket.OPEN,error:"",reconnectAt:null})):this.onForceDisconnect(0,"protocol-changed")}},{key:"onReconnectGracefully",value:function(){this.disconnectIfIdleSince(648e5)||this.gracefullyReconnectUntil||(this.gracefullyReconnectUntil=performance.now()+45e3,this.tryReconnectGracefully())}},{key:"canReconnect",value:function(){return this.state.readyState!==WebSocket.OPEN&&!this.state.forceDisconnected}},{key:"isReconnectingSoon",value:function(e){return!!this.state.reconnectAt&&this.state.reconnectAt-performance.now()<=e}},{key:"hasReconnectedRecently",value:function(e){return performance.now()-this.state.lastConnectionAttempt<e}},{key:"isUserInactiveSince",value:function(e){return performance.now()-this.lastUserActivity>e}},{key:"disconnectIfIdleSince",value:function(e){if(!this.isUserInactiveSince(e))return!1;var t=this.state.readyState===WebSocket.CLOSED;return this.changeState({...this.state,readyState:WebSocket.CLOSED,inactiveDisconnect:!0}),t||this.socket.disconnect(),!0}},{key:"disconnect",value:function(){this.changeState({...this.state,readyState:WebSocket.CLOSED}),this.socket.disconnect()}},{key:"ensureIsConnected",value:function(){this.state.readyState!==WebSocket.OPEN&&this.tryReconnectWithBackoff("rate-limited"===this.state.error?15e3:5e3)}},{key:"startAutoReconnectCountdown",value:function(e){var t=this;if(!this.userIsLeavingPage&&this.canReconnect()){var n=e+1e3*(this.isUserInactiveSince(12e4)?60+Math.floor(2*Math.random()*60):3+Math.floor(7*Math.random()));this.isReconnectingSoon(n)||(this.changeState({...this.state,reconnectAt:performance.now()+n}),clearTimeout(this.reconnectCountdownInterval),this.reconnectCountdownInterval=window.setTimeout((function(){t.isReconnectingSoon(0)&&t.tryReconnect()}),n))}}},{key:"tryReconnect",value:function(){this.gracefullyReconnectUntil=0,this.changeState({...this.state,reconnectAt:null}),this.canReconnect()&&(this.connectionAttempt=0,this.changeState({...this.state,readyState:WebSocket.CONNECTING,error:"",inactiveDisconnect:!1,lastConnectionAttempt:performance.now()}),this.addReconnectListeners(),this.socket.socket.connect())}},{key:"addReconnectListeners",value:function(){var e=this,t=function(){r(),e.startAutoReconnectCountdown(0)},n=function(){r()},r=function(){e.socket.removeListener("error",t),e.socket.removeListener("connect",n)};this.socket.on("error",t),this.socket.on("connect",n)}},{key:"tryReconnectGracefully",value:function(){var e=this;this.state.readyState!==WebSocket.CLOSED&&this.gracefullyReconnectUntil&&(this.gracefullyReconnectUntil<performance.now()||this.isUserInactiveSince(5e3)?(this.disconnect(),this.tryReconnect()):setTimeout((function(){e.tryReconnectGracefully()}),5e3))}},{key:"tryReconnectWithBackoff",value:function(e){this.hasReconnectedRecently(e)?this.startAutoReconnectCountdown(e):this.tryReconnect()}}]),n}(D(EventTarget)),B=n(90350),q=n(46267),V=n(52322);function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var G=(0,r.createContext)(void 0),J=function(e){var t=e.children,n=(0,q.T)(),o=z((0,r.useState)((function(){return new $})),1)[0],i=z((0,r.useState)(o.state),2),a=i[0],c=i[1];(0,r.useEffect)((function(){var e=function(e){c(e.detail.state)};return o.addEventListener("statechange",e),function(){o.removeEventListener("statechange",e)}}),[o]);var l=a.readyState===WebSocket.OPEN,s=a.readyState===WebSocket.CONNECTING&&performance.now()-a.lastConnectionAttempt>1e3,u=(0,r.useCallback)((function(){return(0,B.o)(a.reconnectAt)}),[a.reconnectAt]),d=(0,r.useCallback)((function(){return o.tryReconnectNow()}),[o]),f=(0,r.useCallback)((function(){return o.registerUserActivity()}),[o]),h=(0,r.useCallback)((function(){o.disconnect()}),[o]);(0,r.useEffect)((function(){if(a.forceDisconnected){var e=window.setTimeout((function(){return n.reload()}),1e3*a.forcedDisconnectDelay);return function(){window.clearTimeout(e)}}}),[a.forceDisconnected,a.forcedDisconnectDelay,n]);var p=(0,r.useMemo)((function(){return{socket:o.socket,connectionState:a,isConnected:l,isStillReconnecting:s,secondsUntilReconnect:u,tryReconnectNow:d,registerUserActivity:f,disconnect:h}}),[o.socket,a,l,s,f,u,d,h]);return(0,V.jsx)(G.Provider,{value:p,children:t})};function Y(){var e=(0,r.useContext)(G);if(!e)throw new Error("useConnectionContext is only available inside ConnectionProvider");return e}},91661:function(e,t,n){"use strict";n.d(t,{b3:function(){return ge},QA:function(){return ve}});n(58188),n(73439),n(21515),n(71372),n(16781),n(18178),n(26936),n(39529),n(31235),n(77950),n(21850),n(34115),n(634),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(27233);var r=n(2784),o=n(96227),i=n(37246),a=n(96931),c=(n(79321),n(9575),n(96264),n(71245),n(43450),n(95342),n(96928),n(61229),n(92215),n(54411)),l=n.n(c),s=(n(43430),n(78297)),u=n(58976),d=n(45177);function f(e){return decodeURIComponent(escape(e))}function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function g(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e,t,n){return(t=y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e){var t=function(e,t){if("object"!=h(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==h(t)?t:String(t)}var _="ShareJsDoc",b=function(){function e(t){p(this,e),v(this,"lastReport",null),v(this,"queue",[]),this.onTimeoutHandler=t}return g(e,[{key:"getMetaPreferLocal",value:function(){for(var e of this.queue)if(e.scope===_)return e;return this.queue.pop()}},{key:"onTimeout",value:function(e){var t=this;this.queue.push(e),setTimeout((function(){if(t.queue.length){var e=t.getMetaPreferLocal();t.queue.length=0;var n=Date.now();null!==t.lastReport&&n-t.lastReport<6e4||(t.lastReport=n,t.onTimeoutHandler(e))}}))}}]),e}(),w=function(){function e(t){var n=t.parent,r=t.onTimeoutHandler;if(p(this,e),v(this,"lastAck",null),this.scope=n?_:"global",this.timeout=6e4,this.parent=n,n)this.reporter=n.reporter;else{if(!r)throw new Error("No parent or onTimeoutHandler");this.reporter=new b(r)}this.lastAck=null,this.lastUnackedEdit=null}return g(e,[{key:"onAck",value:function(){this.lastAck=performance.now(),this.parent&&this.parent.onAck()}},{key:"onEdit",value:function(){var e=performance.now();this.lastAck>this.lastUnackedEdit&&(this.lastUnackedEdit=null),this.lastUnackedEdit||(this.lastUnackedEdit=e);var t=e-this.lastUnackedEdit;if(t>this.timeout){var n=Date.now()-e,r={scope:this.scope,delay:t,lastAck:this.lastAck?n+this.lastAck:0,lastUnackedEdit:n+this.lastUnackedEdit};this.log("timedOut",r),this.reporter.onTimeout(r)}}},{key:"attachToEditor",value:function(e){var t=this;this.log("attach to editor");var n=function(e,n){"remote"!==n.origin&&(n.removed||n.inserted)&&t.onEdit()};return e.on("change",n),function(){t.log("detach from editor"),e.off("change",n)}}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];d.c.log.apply(d.c,["[EditorWatchdogManager] ".concat(this.scope,":")].concat(t))}}]),e}(),k=n(66041);function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function j(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,M(r.key),r)}}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}function C(e){var t=O();return function(){var n,r=L(e);if(t){var o=L(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===x(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E(e)}(this,n)}}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(O=function(){return!!e})()}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}function A(e,t,n){return(t=M(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e){var t=function(e,t){if("object"!=x(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==x(t)?t:String(t)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(a,e);var t,n,r,i=C(a);function a(e,t,n,r,o,c,l){var s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),A(E(s=i.call(this)),"track_changes",!1),A(E(s),"track_changes_id_seeds",null),A(E(s),"lastAcked",null),A(E(s),"queuedMessageTimer",null),A(E(s),"queuedMessages",[]),A(E(s),"detachEditorWatchdogManager",null),A(E(s),"_timeoutTimer",null),s.doc_id=e,s.socket=r,s.globalEditorWatchdogManager=o,s.eventEmitter=c,s.eventLog=l,s.type="text";var d=t.map((function(e){return f(e)})).join("\n");return s.connection={send:function(e){return s.startInflightOpTimeout(e),s.track_changes&&s.track_changes_id_seeds&&(null==e.meta&&(e.meta={}),e.meta.tc=s.track_changes_id_seeds.inflight),s.socket.emit("applyOtUpdate",s.doc_id,e,(function(e){null!=e&&s.handleError(e)}))},state:"ok",id:s.socket.publicId},s._doc=new u.Q(s.connection,s.doc_id,{type:s.type}),s._doc.setFlushDelay(2e3),s._doc.on("change",(function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=s).trigger.apply(e,["change"].concat(n))})),s.editorWatchdogManager=new w({parent:o}),s._doc.on("acknowledge",(function(){return s.lastAcked=new Date,s.editorWatchdogManager.onAck(),s.trigger("acknowledge")})),s._doc.on("remoteop",(function(){var e;s._doc.setFlushDelay(500);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=s).trigger.apply(e,["remoteop"].concat(n))})),s._doc.on("flipped_pending_to_inflight",(function(){return s.trigger("flipped_pending_to_inflight")})),s._doc.on("saved",(function(){return s.trigger("saved")})),s._doc.on("error",(function(e){return s.handleError(e)})),s.bindToDocChanges(s._doc),s.processUpdateFromServer({open:!0,v:n,snapshot:d}),s.removeCarriageReturnCharFromShareJsDoc(),s}return t=a,n=[{key:"removeCarriageReturnCharFromShareJsDoc",value:function(){var e,t=this._doc;if(-1!==t.snapshot.indexOf("\r"))for(this.eventLog.pushEvent("remove-carriage-return-char",{doc_id:this.doc_id});-1!==(e=t.snapshot.indexOf("\r"));)d.c.log("[ShareJsDoc] remove-carriage-return-char",e),t.del(e,1)}},{key:"submitOp",value:function(e){this._doc.submitOp(e)}},{key:"isAheadOfExpectedVersion",value:function(e){return this._doc.version>0&&e.v>this._doc.version}},{key:"pushOntoQueue",value:function(e){var t=this;d.c.log("[processUpdate] push onto queue ".concat(e.v)),this.queuedMessageTimer||(this.queuedMessageTimer=window.setTimeout((function(){d.c.log("[processUpdate] queue timeout fired for ".concat(e.v)),t.processUpdateFromServer(e)}),5e3)),this.queuedMessages.push(e),this.queuedMessages.sort((function(e,t){return e.v-t.v}))}},{key:"clearQueue",value:function(){this.queuedMessages=[]}},{key:"processQueue",value:function(){if(this.queuedMessages.length>0){var e=this.queuedMessages[0].v;if(e>this._doc.version);else{d.c.log("[processUpdate] taken from queue ".concat(e));var t=this.queuedMessages.shift();t&&this.processUpdateFromServerInOrder(t),0===this.queuedMessages.length&&this.queuedMessageTimer&&(d.c.log("[processUpdate] queue is empty, cleared timeout"),window.clearTimeout(this.queuedMessageTimer),this.queuedMessageTimer=null)}}}},{key:"processUpdateFromServerInOrder",value:function(e){if(this.isAheadOfExpectedVersion(e))this.pushOntoQueue(e);else{var t=this.processUpdateFromServer(e);t instanceof Error&&"Invalid version from server"===t.message?this.clearQueue():this.processQueue()}}},{key:"processUpdateFromServer",value:function(e){var t;try{this._doc._onMessage(e)}catch(e){return d.c.log(e),this.handleError(e),e}if("external"===(null===(t=e.meta)||void 0===t?void 0:t.type))return this.trigger("externalUpdate",e)}},{key:"catchUp",value:function(e){var t=this;return e.map((function(e){return e.v=t._doc.version,e.doc=t.doc_id,t.processUpdateFromServer(e)}))}},{key:"getSnapshot",value:function(){return this._doc.snapshot}},{key:"getVersion",value:function(){return this._doc.version}},{key:"getType",value:function(){return this.type}},{key:"clearInflightAndPendingOps",value:function(){return this.clearFatalTimeoutTimer(),this._doc.inflightOp=null,this._doc.inflightCallbacks=[],this._doc.pendingOp=null,this._doc.pendingCallbacks=[]}},{key:"flushPendingOps",value:function(){return this._doc.flush()}},{key:"updateConnectionState",value:function(e){return d.c.log("[updateConnectionState] Setting state to ".concat(e)),this.connection.state=e,this.connection.id=this.socket.publicId,this._doc.autoOpen=!1,this._doc._connectionStateChanged(e),this.lastAcked=null}},{key:"hasBufferedOps",value:function(){return null!=this._doc.inflightOp||null!=this._doc.pendingOp}},{key:"getInflightOp",value:function(){return this._doc.inflightOp}},{key:"getPendingOp",value:function(){return this._doc.pendingOp}},{key:"getRecentAck",value:function(){return null!==this.lastAcked&&Date.now()-this.lastAcked.getTime()<4e3}},{key:"attachEditorWatchdogManager",value:function(e){this.detachEditorWatchdogManager=this.editorWatchdogManager.attachToEditor(e)}},{key:"attachToEditor",value:function(e,t){this.attachEditorWatchdogManager(e),t()}},{key:"maybeDetachEditorWatchdogManager",value:function(){this.detachEditorWatchdogManager&&(this.detachEditorWatchdogManager(),this.detachEditorWatchdogManager=null)}},{key:"attachToCM6",value:function(e){var t=this;this.attachToEditor(e,(function(){e.attachShareJs(t._doc,(0,k.Z)("ol-maxDocLength"))}))}},{key:"detachFromCM6",value:function(){this.maybeDetachEditorWatchdogManager(),this._doc.detach_cm6&&this._doc.detach_cm6()}},{key:"startInflightOpTimeout",value:function(e){var t=this;this.startFatalTimeoutTimer(e);var n=window.setTimeout((function n(){if(d.c.log("[inflightOpTimeout] Trying op again"),null!=t._doc.inflightOp){if(e.dupIfSource=[t.connection.id].concat(j(Array.from(t._doc.inflightSubmittedIds))),"ok"===t.connection.state)return d.c.log("[inflightOpTimeout] Sending"),t.connection.send(e);d.c.log("[inflightOpTimeout] Not connected, retrying in 0.5s"),window.setTimeout(n,500)}}),5e3);return this._doc.inflightCallbacks.push((function(){t.clearFatalTimeoutTimer(),window.clearTimeout(n)}))}},{key:"startFatalTimeoutTimer",value:function(e){var t=this;if(null==this._timeoutTimer)return this._timeoutTimer=window.setTimeout((function(){return t.clearFatalTimeoutTimer(),t.trigger("op:timeout",e)}),3e4)}},{key:"clearFatalTimeoutTimer",value:function(){if(null!=this._timeoutTimer)return clearTimeout(this._timeoutTimer),this._timeoutTimer=null}},{key:"handleError",value:function handleError(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.trigger("error",e,t)}},{key:"bindToDocChanges",value:function(e){var t=this,n=e.submitOp;e.submitOp=function(r,i){var a;return a=(0,k.Z)("ol-project_id"),(0,o.Cq)("document-first-change",{projectId:a,isSmallDevice:o.UJ}),t.trigger("op:sent",r),e.pendingCallbacks.push((function(){return t.trigger("op:acknowledged",r)})),n.call(e,r,i)};var r=e.flush;e.flush=function(){return t.trigger("flush",e.inflightOp,e.pendingOp,e.version),r.call(e)}}}],n&&S(t.prototype,n),r&&S(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(s.Z),D=n(13684);function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,B(r.key),r)}}function Z(e,t){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Z(e,t)}function R(e){var t=N();return function(){var n,r=W(e);if(t){var o=W(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===F(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return U(e)}(this,n)}}function U(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(N=function(){return!!e})()}function W(e){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},W(e)}function $(e,t,n){return(t=B(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e){var t=function(e,t){if("object"!=F(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=F(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==F(t)?t:String(t)}function q(e){return e.reduce((function(e,t){return e+function(e){return(0,D.wM)(e)?e.i.length:(0,D.Zh)(e)?e.d.length:0}(t)}),0)}var V=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z(e,t)}(i,e);var t,n,r,o=R(i);function i(e,t,n,r,a,c){var l;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),$(U(l=o.call(this)),"wantToBeJoined",!1),$(U(l),"chaosMonkeyTimer",null),$(U(l),"track_changes_as",null),$(U(l),"joinCallbacks",[]),$(U(l),"leaveCallbacks",[]),$(U(l),"joined",!1),$(U(l),"docName",""),$(U(l),"checkConsistency",(function(e){window.setTimeout((function(){var t,n=null==e?void 0:e.getValue();if(n!==(null===(t=l.doc)||void 0===t?void 0:t.getSnapshot()))return l.onError(new Error("Editor text does not match server text"),{},n)}),0)})),$(U(l),"onUpdateAppliedHandler",(function(e){return l.onUpdateApplied(e)})),$(U(l),"onErrorHandler",(function(e,t){t.doc_id===l.doc_id&&l.onError(e,t)})),$(U(l),"onDisconnectHandler",(function(){return l.onDisconnect()})),$(U(l),"onReconnect",(function(){var e,t;(d.c.log("[onReconnect] reconnected (joined project)"),l.eventLog.pushEvent("reconnected:afterJoinProject"),l.connected=!0,l.wantToBeJoined||null!==(e=l.doc)&&void 0!==e&&e.hasBufferedOps())&&(d.c.log("[onReconnect] Rejoining (wantToBeJoined: ".concat(l.wantToBeJoined," OR hasBufferedOps: ").concat(null===(t=l.doc)||void 0===t?void 0:t.hasBufferedOps(),")")),l.joinDoc((function(e){var t,n;e?l.onError(e):(null===(t=l.doc)||void 0===t||t.updateConnectionState("ok"),null===(n=l.doc)||void 0===n||n.flushPendingOps(),l.callJoinCallbacks())})))})),l.doc_id=e,l.socket=t,l.globalEditorWatchdogManager=n,l.ideEventEmitter=r,l.eventLog=a,l.detachDoc=c,l.connected=l.socket.socket.connected,l.bindToEditorEvents(),l.bindToSocketEvents(),l}return t=i,n=[{key:"attachToCM6",value:function(e){this.cm6=e,this.doc&&this.doc.attachToCM6(this.cm6),this.cm6&&this.cm6.on("change",this.checkConsistency)}},{key:"detachFromCM6",value:function(){this.doc&&this.doc.detachFromCM6(),this.cm6&&this.cm6.off("change",this.checkConsistency),delete this.cm6,this.clearChaosMonkey(),this.doc&&this.ideEventEmitter.emit("document:closed",this.doc)}},{key:"submitOp",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];null===(e=this.doc)||void 0===e||e.submitOp(n)}},{key:"getSnapshot",value:function(){var e;return null===(e=this.doc)||void 0===e?void 0:e.getSnapshot()}},{key:"getType",value:function(){var e;return null===(e=this.doc)||void 0===e?void 0:e.getType()}},{key:"getInflightOp",value:function(){var e;return null===(e=this.doc)||void 0===e?void 0:e.getInflightOp()}},{key:"getPendingOp",value:function(){var e;return null===(e=this.doc)||void 0===e?void 0:e.getPendingOp()}},{key:"getRecentAck",value:function(){var e;return null===(e=this.doc)||void 0===e?void 0:e.getRecentAck()}},{key:"hasBufferedOps",value:function(){var e;return null===(e=this.doc)||void 0===e?void 0:e.hasBufferedOps()}},{key:"setTrackingChanges",value:function(e){this.doc&&(this.doc.track_changes=e)}},{key:"getTrackingChanges",value:function(){var e;return!(null===(e=this.doc)||void 0===e||!e.track_changes)}},{key:"setTrackChangesIdSeeds",value:function(e){this.doc&&(this.doc.track_changes_id_seeds=e)}},{key:"bindToSocketEvents",value:function(){return this.socket.on("otUpdateApplied",this.onUpdateAppliedHandler),this.socket.on("otUpdateError",this.onErrorHandler),this.socket.on("disconnect",this.onDisconnectHandler)}},{key:"unBindFromSocketEvents",value:function(){return this.socket.removeListener("otUpdateApplied",this.onUpdateAppliedHandler),this.socket.removeListener("otUpdateError",this.onErrorHandler),this.socket.removeListener("disconnect",this.onDisconnectHandler)}},{key:"bindToEditorEvents",value:function(){this.ideEventEmitter.on("project:joined",this.onReconnect)}},{key:"unBindFromEditorEvents",value:function(){this.ideEventEmitter.off("project:joined",this.onReconnect)}},{key:"leaveAndCleanUp",value:function(e){var t=this;return this.leave((function(n){t.cleanUp(),e&&e(n)}))}},{key:"leaveAndCleanUpPromise",value:function(){var e=this;return new Promise((function(t,n){e.leaveAndCleanUp((function(e){e?n(e):t()}))}))}},{key:"join",value:function(e){this.wantToBeJoined=!0,this.cancelLeave(),this.connected?this.joinDoc(e):e&&this.joinCallbacks.push(e)}},{key:"leave",value:function(e){var t;this.flush(),this.wantToBeJoined=!1,this.cancelJoin(),null!==(t=this.doc)&&void 0!==t&&t.hasBufferedOps()?(d.c.log("[leave] Doc has buffered ops, pushing callback for later"),e&&this.leaveCallbacks.push(e)):this.connected?(d.c.log("[leave] Leaving now"),this.leaveDoc(e)):(d.c.log("[leave] Not connected, returning now"),null==e||e())}},{key:"flush",value:function(){var e;return null===(e=this.doc)||void 0===e?void 0:e.flushPendingOps()}},{key:"chaosMonkey",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"a",r=n,o=null,i=0;!function a(){null!=o&&o.length||(o=r.slice()+" "+new Date+"\n",(t+=Math.random()>.1?1:-2)<0&&(t=0),i=0),n=o[0],o=o.slice(1),e.cm6&&e.cm6.view.dispatch({changes:{from:Math.min(i,e.cm6.view.state.doc.length),insert:n}}),i+=1,e.chaosMonkeyTimer=window.setTimeout(a,100+(Math.random()<.1?1e3:0))}()}},{key:"clearChaosMonkey",value:function(){var e=this.chaosMonkeyTimer;e&&(this.chaosMonkeyTimer=null,window.clearTimeout(e))}},{key:"pollSavedStatus",value:function(){var e,t=this.getInflightOp(),n=this.getPendingOp(),r=this.getRecentAck(),o=n?q(n):0;return null==t&&null==n?(e=!0,d.c.log("[pollSavedStatus] no inflight or pending ops")):t&&t===this.oldInflightOp?(e=!1,d.c.log("[pollSavedStatus] inflight op is same as before")):null!=n&&r&&o<64?(e=!0,d.c.log("[pollSavedStatus] pending op (small with recent ack) assume ok",n,o)):(e=!1,d.c.log("[pollSavedStatus] assuming not saved (inflightOp?: ".concat(null!=t,", pendingOp?: ").concat(null!=n,")"))),this.oldInflightOp=t,e}},{key:"cancelLeave",value:function(){this.leaveCallbacks=[]}},{key:"cancelJoin",value:function(){this.joinCallbacks=[]}},{key:"onUpdateApplied",value:function(e){if(this.eventLog.pushEvent("received-update",{doc_id:this.doc_id,remote_doc_id:null==e?void 0:e.doc,wantToBeJoined:this.wantToBeJoined,update:e,hasDoc:!!this.doc}),(null==e?void 0:e.doc)===this.doc_id&&null!=this.doc&&(this.eventLog.pushEvent("received-update:processing",{update:e}),this.doc.processUpdateFromServerInOrder(e),!this.wantToBeJoined))return this.leave()}},{key:"onDisconnect",value:function(){return d.c.log("[onDisconnect] disconnecting"),this.connected=!1,this.joined=!1,null!=this.doc?this.doc.updateConnectionState("disconnected"):void 0}},{key:"callJoinCallbacks",value:function(){for(var e of this.joinCallbacks)e();this.joinCallbacks=[]}},{key:"joinDoc",value:function(e){var t=this;if(this.doc)return this.eventLog.pushEvent("joinDoc:existing",{doc_id:this.doc_id,version:this.doc.getVersion()}),this.socket.emit("joinDoc",this.doc_id,this.doc.getVersion(),{encodeRanges:!0},(function(n,r,o,i,a){var c;n?null==e||e(n):(t.joined=!0,null===(c=t.doc)||void 0===c||c.catchUp(i),t.decodeRanges(a),t.catchUpRanges(null==a?void 0:a.changes,null==a?void 0:a.comments),null==e||e())}));this.eventLog.pushEvent("joinDoc:new",{doc_id:this.doc_id}),this.socket.emit("joinDoc",this.doc_id,{encodeRanges:!0},(function(n,r,o,i,a){n?null==e||e(n):(t.joined=!0,t.eventLog.pushEvent("joinDoc:inited",{doc_id:t.doc_id,version:o}),t.doc=new P(t.doc_id,r,o,t.socket,t.globalEditorWatchdogManager,t.ideEventEmitter,t.eventLog),t.decodeRanges(a),t.ranges=new(l())(null==a?void 0:a.changes,null==a?void 0:a.comments),t.bindToShareJsDocEvents(),null==e||e())}))}},{key:"decodeRanges",value:function(e){try{if(e.changes)for(var t of e.changes)(0,D.wM)(t.op)&&(t.op.i=f(t.op.i)),(0,D.Zh)(t.op)&&(t.op.d=f(t.op.d));return e.comments?e.comments.map((function(e){return null!=e.op.c?e.op.c=f(e.op.c):void 0})):[]}catch(e){d.c.error(e)}}},{key:"leaveDoc",value:function(e){var t=this;this.eventLog.pushEvent("leaveDoc",{doc_id:this.doc_id}),d.c.log("[leaveDoc] Sending leaveDoc request"),this.socket.emit("leaveDoc",this.doc_id,(function(n){if(n)null==e||e(n);else{for(var r of(t.joined=!1,t.leaveCallbacks))d.c.log("[_leaveDoc] Calling buffered callback",r),r(n);t.leaveCallbacks=[],null==e||e()}}))}},{key:"cleanUp",value:function(){this.hasBufferedOps()?d.c.log("[cleanUp] Document (".concat(this.doc_id,") has buffered ops, refusing to remove from openDocs")):(this.detachDoc(this.doc_id,this),this.unBindFromEditorEvents(),this.unBindFromSocketEvents())}},{key:"bindToShareJsDocEvents",value:function(){var e=this;if(this.doc){this.doc.on("error",(function(t,n){return e.onError(t,n)})),this.doc.on("externalUpdate",(function(t){return e.eventLog.pushEvent("externalUpdate",{doc_id:e.doc_id}),e.trigger("externalUpdate",t)})),this.doc.on("remoteop",(function(){e.eventLog.pushEvent("remoteop",{doc_id:e.doc_id});for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.trigger.apply(e,["remoteop"].concat(n))})),this.doc.on("op:sent",(function(t){return e.eventLog.pushEvent("op:sent",{doc_id:e.doc_id,op:t}),e.trigger("op:sent")})),this.doc.on("op:acknowledged",(function(t){return e.eventLog.pushEvent("op:acknowledged",{doc_id:e.doc_id,op:t}),e.ideEventEmitter.emit("ide:opAcknowledged",{doc_id:e.doc_id,op:t}),e.trigger("op:acknowledged")})),this.doc.on("op:timeout",(function(t){return e.eventLog.pushEvent("op:timeout",{doc_id:e.doc_id,op:t}),e.trigger("op:timeout"),e.onError(new Error("op timed out"))})),this.doc.on("flush",(function(t,n,r){return e.eventLog.pushEvent("flush",{doc_id:e.doc_id,inflightOp:t,pendingOp:n,v:r})}));var t,n=null;this.doc.on("change",(function(t,r,o){e.applyOpsToRanges(t,o),n&&window.clearTimeout(n),n=window.setTimeout((function(){window.dispatchEvent(new CustomEvent("doc:changed",{detail:{id:e.doc_id}})),e.ideEventEmitter.emit("doc:changed",{doc_id:e.doc_id})}),50)})),this.doc.on("flipped_pending_to_inflight",(function(){return e.trigger("flipped_pending_to_inflight")})),this.doc.on("saved",(function(){t&&window.clearTimeout(t),t=window.setTimeout((function(){window.dispatchEvent(new CustomEvent("doc:saved",{detail:{id:e.doc_id}})),e.ideEventEmitter.emit("doc:saved",{doc_id:e.doc_id})}),50)}))}}},{key:"onError",value:function onError(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;t.doc_id=this.doc_id,d.c.log("ShareJS error",e,t),"no project_id found on client"!==e.message?(this.doc&&this.doc.clearInflightAndPendingOps(),this.trigger("error",e,t,n),this.cleanUp()):d.c.log("ignoring error, will wait to join project")}},{key:"applyOpsToRanges",value:function(e,t){var n,r=this,o=null,i=null!=t;for(var a of(i&&null!=t&&t.meta.tc?(n=this.ranges.getIdSeed(),this.ranges.setIdSeed(t.meta.tc),o=t.meta.user_id):i||null==this.track_changes_as||(o=this.track_changes_as),this.ranges.track_changes=null!=o,this.filterOps(e)))this.ranges.applyOp(a,{user_id:o});return null!=n&&this.ranges.setIdSeed(n),i?window.setTimeout((function(){return r.emit("ranges:dirty")})):this.emit("ranges:dirty")}},{key:"catchUpRanges",value:function(e,t){var n,r;for(var o of(null==e&&(e=[]),null==t&&(t=[]),this.emit("ranges:clear"),this.ranges.changes=e,this.ranges.comments=t,this.ranges.track_changes=null!==(n=null===(r=this.doc)||void 0===r?void 0:r.track_changes)&&void 0!==n&&n,this.filterOps((null===(i=this.doc)||void 0===i?void 0:i.getInflightOp())||[]))){var i,a;this.ranges.setIdSeed(null===(a=this.doc)||void 0===a||null===(a=a.track_changes_id_seeds)||void 0===a?void 0:a.inflight),this.ranges.applyOp(o,{user_id:this.track_changes_as})}for(var c of this.filterOps((null===(l=this.doc)||void 0===l?void 0:l.getPendingOp())||[])){var l,s;this.ranges.setIdSeed(null===(s=this.doc)||void 0===s||null===(s=s.track_changes_id_seeds)||void 0===s?void 0:s.pending),this.ranges.applyOp(c,{user_id:this.track_changes_as})}return this.emit("ranges:redraw")}},{key:"filterOps",value:function(e){return(0,k.Z)("ol-isRestrictedTokenMember")?e.filter((function(e){return!(0,D.A2)(e)})):e}}],n&&X(t.prototype,n),r&&X(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(s.Z);function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Y(r.key),r)}}function Y(e){var t=function(e,t){if("object"!=z(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==z(t)?t:String(t)}var K=function(){function e(t,n,r,o){var i,a,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=this,a="openDocs",c=new Map,(a=Y(a))in i?Object.defineProperty(i,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):i[a]=c,this.socket=t,this.globalEditorWatchdogManager=n,this.events=r,this.eventLog=o}var t,n,r;return t=e,(n=[{key:"getDocument",value:function(e){var t;return this.openDocs.has(e)&&(d.c.log("[getDocument] Cleaning up existing document instance for ".concat(e)),null===(t=this.openDocs.get(e))||void 0===t||t.cleanUp()),this.openDocs.has(e)?d.c.log("[getDocument] Returning existing document instance for ".concat(e)):(d.c.log("[getDocument] Creating new document instance for ".concat(e)),this.createDoc(e)),this.openDocs.get(e)}},{key:"createDoc",value:function(e){var t=new V(e,this.socket,this.globalEditorWatchdogManager,this.events,this.eventLog,this.detachDoc.bind(this));this.openDocs.set(e,t)}},{key:"detachDoc",value:function(e,t){this.openDocs.get(e)===t?(d.c.log("[detach] Removing document with ID (".concat(e,") from openDocs")),this.openDocs.delete(e)):d.c.log("[_cleanUp] New instance of (".concat(e,") created. Not removing"))}},{key:"hasUnsavedChanges",value:function(){for(var e of this.openDocs.values())if(e.hasBufferedOps())return!0;return!1}},{key:"flushAll",value:function(){for(var e of this.openDocs.values())e.flush()}},{key:"unsavedDocIds",value:function(){var e=[];for(var t of this.openDocs){var n=H(t,2),r=n[0];n[1].pollSavedStatus()||e.push(r)}return e}}])&&J(t.prototype,n),r&&J(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Q=n(8596),ee=n(5446),te=n(39493),ne=n(47481),re=n(14595),oe=n(44466),ie=n(50066),ae=n(75234),ce=n(76066),le=n(32687),se=n(59295);var ue=function(e,t){var n=(0,r.useRef)(null),o=(0,r.useRef)(null),i=(0,r.useRef)({});(0,r.useEffect)((function(){n.current=t}),[t]),(0,r.useEffect)((function(){o.current=e}),[e]);var a=(0,r.useMemo)((function(){return async function(){var e,t;return await async function(e,t,n){if(d.c.debug("tryGetDiffSize"),!t)return d.c.debug("tryGetDiffSize: missing projectId"),null;if(!e)return d.c.debug("tryGetDiffSize: missing currentContents"),null;if(!n)return d.c.debug("tryGetDiffSize: missing docId"),null;try{var r=await fetch("/Project/".concat(t,"/doc/").concat(n,"/download"),{signal:AbortSignal.timeout(5e3)}),o=await r.text(),i=(0,se.Kx)(o,e),a=0;for(var c of i)(c.added||c.removed)&&(a+=c.value.length);return a}catch(e){return d.c.debug("tryGetDiffSize: fetch failed"),null}}(null===(e=n.current)||void 0===e?void 0:e.getSnapshot(),o.current,null===(t=n.current)||void 0===t?void 0:t.doc_id)}}),[]);return{createDebugDiff:a,debugTimers:i}},de=n(84050),fe=n(52322);function he(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var me=(0,r.createContext)(void 0),ge=function(e){var t=e.children,n=(0,ae.$G)().t,c=(0,a.IM)(),l=(0,Q.I)().projectId,s=(0,Q.I)(),u=s.reportError,f=s.eventEmitter,h=s.eventLog,p=(0,de._i)().setOutOfSync,m=(0,ee.Km)(),g=m.socket,v=m.disconnect,y=m.connectionState,_=(0,te.l5)(),b=_.view,k=_.setView,x=(0,ie.a)(),j=x.showGenericMessageModal,T=x.genericModalVisible,S=x.showOutOfSyncModal,I=he((0,i.Z)("editor.showSymbolPalette"),2),C=I[0],E=I[1],O=he((0,i.Z)("editor.showVisual"),1)[0],L=he((0,i.Z)("editor.sharejs_doc"),2),A=L[0],M=L[1],P=he((0,i.Z)("editor.open_doc_id"),2),D=P[0],F=P[1],X=he((0,i.Z)("editor.open_doc_name"),2)[1],Z=he((0,i.Z)("editor.opening"),2)[1],R=he((0,i.Z)("editor.error_state"),2)[1],U=he((0,i.Z)("editor.trackChanges"),2)[1],N=he((0,i.Z)("editor.wantTrackChanges"),2),W=N[0],$=N[1],B=(0,r.useRef)(W);(0,r.useEffect)((function(){B.current=W}),[W]);var q=(0,oe.Z)("editor:gotoLine"),V=(0,ne.O)().fileTreeData,z=he((0,r.useState)(!1),2),H=z[0],G=z[1],J=ue(l,A),Y=J.createDebugDiff,se=J.debugTimers,pe=(0,r.useState)((function(){return new w({onTimeoutHandler:function(e){var t=null;Y().then((function(e){t=e})).finally((function(){(0,o.BZ)("losing-edits",{...e,diffSize:t,timers:se.current}),u("losing-edits",{...e,diffSize:t,timers:se.current})}))}})})),ge=he(pe,1)[0],ve=he((0,r.useState)(null),2),ye=ve[0],_e=ve[1],be=he((0,r.useState)(!1),2),we=be[0],ke=be[1];(0,r.useEffect)((function(){T||ke(!1)}),[T]);var xe=he((0,r.useState)((function(){return new K(g,ge,f,h)})),1)[0],je="doc.open_id.".concat(l);(0,r.useEffect)((function(){D&&ce.Z.setItem(je,D)}),[D,je]);var Te=(0,r.useRef)(0);(0,r.useEffect)((function(){c.scopeStore.set("editor.toggleSymbolPalette",(function(){E((function(e){var t=!e;return(0,o.BZ)(t?"symbol-palette-show":"symbol-palette-hide"),t}))}))}),[c.scopeStore,E]);var Se=(0,r.useCallback)((function(){return A?O?"cm6-rich-text":"cm6":null}),[A,O]),Ie=(0,r.useCallback)((function(){var e;return null!==(e=null==A?void 0:A.getSnapshot())&&void 0!==e?e:null}),[A]),Ce=(0,r.useCallback)((function(){return D}),[D]),Ee=(0,r.useCallback)((function(){return G(!0)}),[]),Oe=(0,r.useCallback)((function(){return G(!1)}),[]),Le=(0,r.useCallback)((function(e){var t,n;q(e.gotoLine,null!==(t=e.gotoColumn)&&void 0!==t?t:0,null!==(n=e.syncToPdf)&&void 0!==n&&n)}),[q]),Ae=(0,r.useCallback)((function(e,t){t.on("error",(function(n,r,o){_e({doc:e,document:t,error:n,meta:r,editorContent:o})}))}),[]),Me=(0,r.useCallback)((function(e,t){Ae(e,t),t.on("externalUpdate",(function(e){var t;H||"external"===e.meta.type&&"git-bridge"===e.meta.source||"file-restore"!==(null===(t=e.meta.origin)||void 0===t?void 0:t.kind)&&j(n("document_updated_externally"),n("document_updated_externally_detail"))}))}),[Ae,H,j,n]),Pe=(0,r.useRef)(null),De=(0,r.useCallback)((function(e){if(e){Pe.current&&(window.clearTimeout(Pe.current),Pe.current=null);var t=B.current,n=e.getTrackingChanges();if(t!==n){!function n(){null==e.getInflightOp()&&null==e.getPendingOp()?(e.setTrackingChanges(t),U(t)):Pe.current=window.setTimeout(n,100)}()}else U(t)}}),[U]),Fe=(0,r.useCallback)((function(e){return new Promise((function(t,n){d.c.log("[doOpenNewDocument] Opening...");var r=xe.getDocument(e._id);if(!r)return d.c.error("No open document with ID '".concat(e._id,"' found")),void n(new Error("no open document found"));var o=++Te.current;r.join((function(i){if(i)return d.c.log("[doOpenNewDocument] error joining doc ".concat(e._id),i),void n(i);Te.current!==o&&(d.c.log("[doOpenNewDocument] editorOpenDocEpoch mismatch ".concat(Te.current," vs ").concat(o)),r.leaveAndCleanUp(),n(new Error("another document was loaded"))),Me(e,r),t(r)}))}))}),[Me,xe]),Xe=(0,r.useCallback)((async function(e){var t=null==A?void 0:A.doc_id,n=null==A?void 0:A.hasBufferedOps();if(A&&t!==e._id||n){d.c.log("[openNewDocument] Leaving existing open doc..."),function(e){e.off()}(A),Ae(e,A);var r=++Te.current;try{await A.leaveAndCleanUpPromise()}catch(e){throw d.c.log("[openNewDocument] error leaving doc ".concat(t),e),e}if(Te.current!==r)throw d.c.log("[openNewDocument] editorOpenDocEpoch mismatch ".concat(Te.current," vs ").concat(r)),new Error("another document was loaded")}return Fe(e)}),[Ae,Fe,A]),Ze=(0,r.useRef)(D);(0,r.useEffect)((function(){Ze.current=D}),[D]);var Re=(0,r.useCallback)((async function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d.c.log("[openDoc] Opening ".concat(e._id)),"editor"===b&&f.emit("store-doc-position"),t.keepCurrentView||k("editor");var r=function(n){window.dispatchEvent(new CustomEvent("doc:after-opened",{detail:{isNewDoc:n,docId:e._id}})),!function(e){return"number"==typeof e.gotoLine}(t)?function(e){return"number"==typeof e.gotoOffset}(t)&&window.setTimeout((function(){f.emit("editor:gotoOffset",t.gotoOffset)})):(window.setTimeout((function(){return Le(t)})),n&&window.addEventListener("editor:scroll-position-restored",(function(){return Le(t)}),{once:!0}))};if(e._id!==Ze.current||t.forceReopen){Ze.current=e._id,F(e._id),X(e.name),Z(!0);try{var o=await Xe(e);De(o),f.emit("doc:opened"),Z(!1),M(o),r(!0)}catch(t){if("another document was loaded"===(null==t?void 0:t.message))return void d.c.log("[openDoc] another document was loaded while ".concat(e._id," was loading"));d.c.error("Error opening document",t),j(n("error_opening_document"),n("error_opening_document_detail"))}}else r(!1)}),[f,Le,Xe,M,F,X,Z,k,j,De,n,b]),Ue=(0,r.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,re.I)(V,e);n&&Re(n,t)}),[V,Re]),Ne=(0,r.useCallback)((function(e){var t=ce.Z.getItem(je)||e;t&&Ue(t)}),[je,Ue]);(0,r.useEffect)((function(){if(ye){var e,t=ye.doc,r=ye.document,o=ye.error,i=ye.meta,a=ye.editorContent,c="string"==typeof o?o:null!==(e=null==o?void 0:o.message)&&void 0!==e?e:"";if(_e(null),c.includes("maxDocLength"))Re(t,{forceReopen:!0}),j(n("document_too_long"),n("document_too_long_detail")),ke(!0);else if(/too many comments or tracked changes/.test(c))j(n("too_many_comments_or_tracked_changes"),n("too_many_comments_or_tracked_changes_detail"));else if(!we){var l;return r.off("error"),a="string"==typeof a?a:null===(l=r.doc)||void 0===l?void 0:l._doc.snapshot,r.doc&&r.doc.clearInflightAndPendingOps(),r.leaveAndCleanUp(),v(),u(o,i),R(!0),p(!0),void S(a||"")}var s=function(){Re(t,{forceReopen:!0})};return f.once("project:joined",s),function(){f.off("project:joined",s)}}}),[v,ye,we,f,Re,u,R,j,S,p,n]),(0,le.Z)("editor:insert-symbol",(function(){(0,o.BZ)("symbol-palette-insert")})),(0,le.Z)("flush-changes",(function(){xe.flushAll()})),(0,le.Z)("blur",(function(){xe.flushAll()})),(0,r.useEffect)((function(){y.forceDisconnected&&xe.flushAll()}),[y.forceDisconnected,xe]);var We=(0,r.useRef)(W);(0,r.useEffect)((function(){W!==We.current&&(We.current=W,De(A))}),[A,De,W]);var $e=(0,r.useMemo)((function(){return{getEditorType:Se,showSymbolPalette:C,currentDocument:A,currentDocumentId:D,getCurrentDocValue:Ie,getCurrentDocId:Ce,startIgnoringExternalUpdates:Ee,stopIgnoringExternalUpdates:Oe,openDocId:Ue,openDoc:Re,openDocs:xe,openInitialDoc:Ne,jumpToLine:Le,wantTrackChanges:W,setWantTrackChanges:$,debugTimers:se}}),[Se,C,A,D,Ie,Ce,Ee,Oe,Ue,Re,xe,Ne,Le,W,$,se]);return c.editorManager=$e,(0,fe.jsx)(me.Provider,{value:$e,children:t})};function ve(){var e=(0,r.useContext)(me);if(!e)throw new Error("useEditorManagerContext is only available inside EditorManagerProvider");return e}},8596:function(e,t,n){"use strict";n.d(t,{eH:function(){return re},I:function(){return oe}});n(26936),n(28673),n(15735),n(6886),n(24905),n(71372),n(34115),n(634),n(58188),n(20796),n(32501),n(88233),n(27233),n(77950),n(21850);var r=n(2784),o=(n(79321),n(44112),n(93244),n(34769),n(18178),n(9575),n(96264),n(71245),n(76635)),i=n.n(o),a=n(76066),c=n(45177);function l(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function h(e,t,n){return(t=p(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==m(t)?t:String(t)}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}var g=Symbol("not found");function v(e){return null!==e&&"object"===m(e)&&!("length"in e&&"number"==typeof e.length&&e.length>0)}function y(e){for(var t,n=[],r=e;-1!==(t=r.lastIndexOf("."));)r=r.slice(0,t),n.push(r);return n}var _=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),h(this,"items",new Map),h(this,"persisters",new Map),h(this,"watcherUpdates",new Map),h(this,"watcherUpdateTimer",null),h(this,"allowedNonExistentPaths",[])}var t,n,r;return t=e,n=[{key:"nonExistentPathAllowed",value:function(e){return this.allowedNonExistentPaths.some((function(t){return t.path===e||t.deep&&e.startsWith(t.path+".")}))}},{key:"findInAncestors",value:function(e){for(var t of y(e)){var n=this.items.get(t);if(n&&"value"in n&&v(n.value)){var r=e.slice(t.length+1),o=i().get(n.value,r);if(o!==g)return{value:o,watchers:[]}}}return{watchers:[]}}},{key:"getItem",value:function(e){var t=this.items.get(e)||this.findInAncestors(e);if(!("value"in t)){if(this.nonExistentPathAllowed(e))return c.c.log("No value found for key '".concat(e,"'. This is allowed because the path is in allowedNonExistentPaths")),{value:void 0};throw new Error("No value found for key '".concat(e,"'"))}return t}},{key:"reassembleObjectValue",value:function(e,t){var n={...t},r=e+".";for(var o of this.items.entries()){var i=s(o,2),a=i[0],c=i[1];if(a.startsWith(r)){var l=a.slice(r.length);-1===l.indexOf(".")&&"value"in c&&(n[l]=c.value)}}return n}},{key:"flushUpdates",value:function(){this.watcherUpdateTimer&&(window.clearTimeout(this.watcherUpdateTimer),this.watcherUpdateTimer=null);var e=l(this.watcherUpdates.values());for(var t of(this.watcherUpdates=new Map,e)){var n=t.value,r=t.watchers;for(var o of r)o.removed||o.callback.call(null,n)}}},{key:"scheduleWatcherUpdate",value:function(e,t,n){var r=this,o={value:t,path:e,watchers:l(n)};this.watcherUpdates.set(e,o),this.watcherUpdateTimer||(this.watcherUpdateTimer=window.setTimeout((function(){r.watcherUpdateTimer=null,r.flushUpdates()}),0))}},{key:"get",value:function(e){return this.getItem(e).value}},{key:"setValue",value:function(e,t){c.c.log("setValue",e,t);var n=this.items.get(e);if(void 0===n)n={value:t,watchers:[]},this.items.set(e,n);else if("value"in n){if(n.value===t)return;n.value=t}else n={...n,value:t},this.items.set(e,n);this.scheduleWatcherUpdate(e,t,n.watchers);var r,o=this.persisters.get(e);o&&a.Z.setItem(o.localStorageKey,(null===(r=o.toPersisted)||void 0===r?void 0:r.call(o,t))||t)}},{key:"setValueAndDescendants",value:function(e,t){if(this.setValue(e,t),v(t)){var n=e+".";for(var r of this.items.entries()){var o=s(r,2),a=o[0],c=o[1];if(a.startsWith(n)){var l=i().get(t,a.slice(n.length),g);l===g||"value"in c&&l===c.value||this.setValue(a,l)}}var u=[],d=new Set(Object.keys(t));for(var f of this.items.keys())if(f.startsWith(n)){var h=f.slice(n.length).split(".",1)[0];d.has(h)||u.push(f)}for(var p of u)this.items.delete(p)}}},{key:"set",value:function(e,t){for(var n of(this.setValueAndDescendants(e,t),y(e))){var r=this.items.get(n);r&&"value"in r&&(r.value=this.reassembleObjectValue(n,r.value),this.scheduleWatcherUpdate(n,r.value,r.watchers))}}},{key:"watch",value:function(e,t){var n=this.items.get(e);n||(n=this.findInAncestors(e),this.items.set(e,n));var r=n.watchers,o={removed:!1,callback:t};if(n.watchers.push(o),"value"in n){var a,c=(null!==(a=this.watcherUpdates.get(e))&&void 0!==a?a:{watchers:[]}).watchers;this.scheduleWatcherUpdate(e,n.value,[].concat(l(c),[o]))}return function(){o.removed=!0,i().pull(r,o)}}},{key:"persisted",value:function(e){function t(t,n,r,o){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n,r){var o=a.Z.getItem(n),i=t;null!==o&&(i=r?r.fromPersisted(o):o),this.set(e,i),this.persisters.set(e,{localStorageKey:n,toPersisted:null==r?void 0:r.toPersisted})}))},{key:"allowNonExistentPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.allowedNonExistentPaths.push({path:e,deep:t})}},{key:"dump",value:function(){var e=[];for(var t of this.items.entries()){var n=s(t,2),r=n[0],o=n[1];e.push({path:r,value:"value"in o?o.value:"[not set]",watcherCount:o.watchers.length})}return e}}],n&&f(t.prototype,n),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),b=n(66041),w="ui.reviewPanelOpen.".concat((0,b.Z)("ol-project_id"));var k=n(96931);n(96928),n(61229),n(92215);function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T(r.key),r)}}function T(e){var t=function(e,t){if("object"!=x(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==x(t)?t:String(t)}function S(e){var t=C();return function(){var n,r=O(e);if(t){var o=O(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===x(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function I(e){var t="function"==typeof Map?new Map:void 0;return I=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(C())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return n&&E(o,n.prototype),o}(e,arguments,O(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),E(n,e)},I(e)}function C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(C=function(){return!!e})()}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}function O(e){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},O(e)}var L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(i,e);var t,n,r,o=S(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.apply(this,arguments)}return t=i,n=[{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.dispatchEvent(new CustomEvent(e,{detail:n}))}},{key:"on",value:function(e,t){this.addEventListener(e,t)}},{key:"once",value:function(e,t){this.addEventListener(e,t,{once:!0})}},{key:"off",value:function(e,t){this.removeEventListener(e,t)}}],n&&j(t.prototype,n),r&&j(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(I(EventTarget));function A(){return new L}var M=n(5446);function P(e,t){e.set("state.loading",!1),e.set("project.name",null),e.set("editor",{showSymbolPalette:!1,toggleSymbolPalette:function(){},sharejs_doc:null,open_doc_id:null,open_doc_name:null,opening:!0,trackChanges:!1,wantTrackChanges:!1,newSourceEditor:!0,error_state:!1}),e.persisted("editor.showVisual",function(e){var t="editor.mode.".concat(e),n=a.Z.getItem(t);n&&a.Z.removeItem(t);return"rich-text"===n}(t),"editor.lastUsedMode",{toPersisted:function(e){return e?"visual":"code"},fromPersisted:function(e){return"visual"===e}})}var D=n(28684);function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,U(r.key),r)}}function Z(e,t,n){return t&&X(e.prototype,t),n&&X(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function R(e,t,n){return(t=U(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e){var t=function(e,t){if("object"!=F(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=F(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==F(t)?t:String(t)}var N=Z((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),R(this,"recentEvents",[]),R(this,"pushEvent",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(c.c.log("event",e,n),t.recentEvents.push({type:e,meta:n,date:new Date}),t.recentEvents.length>100)return t.recentEvents.shift()}))})),W=n(28865),$=n(57743);function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function q(e){return function(e){if(Array.isArray(e))return V(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,H(r.key),r)}}function H(e){var t=function(e,t){if("object"!=B(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==B(t)?t:String(t)}var G=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventEmitter=t}var t,n,r;return t=e,n=[{key:"emit",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];this.eventEmitter.dispatchEvent(new CustomEvent(e,{detail:r}))}},{key:"on",value:function(e,t){var n=this,r=function(e){t.apply(void 0,[{}].concat(q(e.detail)))};return this.eventEmitter.addEventListener(e,r),function(){n.eventEmitter.removeEventListener(e,r)}}}],n&&z(t.prototype,n),r&&z(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),J=n(52322);function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function K(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ee=new Date,te=(0,r.createContext)(void 0);function ne(e){var t=new _;return t.set("sync_tex_error",!1),P(t,e),function(e){e.set("ui.view","editor"),e.set("openFile",null),e.persisted("ui.chatOpen",!1,"ui.chatOpen"),e.persisted("ui.reviewPanelOpen",!1,w),e.set("ui.leftMenuShown",!1),e.set("ui.miniReviewPanelVisible",!1),e.set("ui.pdfLayout","sideBySide"),e.set("ui.loadingStyleSheet",!1)}(t),function(e){e.allowNonExistentPath("project",!0),e.set("permissionsLevel","readOnly"),e.set("permissions",{read:!0,write:!1,admin:!1,comment:!0})}(t),function(e){e.allowNonExistentPath("pdf",!0)}(t),(0,W.tA)(t),(0,$.H6)(t),function(e){e.set("loadingThreads",!0),e.set("users",{}),e.set("addNewComment",(function(){}))}(t),t.allowNonExistentPath("hasLintingError"),t.allowNonExistentPath("loadingThreads"),t}var re=function(e){var t,n,o=e.children,i=(0,b.Z)("ol-project_id"),a=K((0,r.useState)((function(){return ne(i)})),1)[0],c=K((0,r.useState)(A),1)[0],l=K((0,r.useState)((function(){return new G(c)})),1)[0],s=K((0,r.useState)((function(){return new N})),1)[0],u=K((0,r.useState)(!1),2),d=u[0],f=u[1],h=null!==(t=null===(n=(0,b.Z)("ol-ExposedSettings"))||void 0===n?void 0:n.sentryRelease)&&void 0!==t?t:null,p=K((0,r.useState)(!1),2),m=p[0],g=p[1],v=(0,M.Km)().socket,y=(0,r.useCallback)((function(e,t){var n,r,o={...t,user_id:(0,b.Z)("ol-user_id"),project_id:i,client_id:null===(n=v.socket)||void 0===n?void 0:n.sessionid,transport:null===(r=v.socket)||void 0===r||null===(r=r.transport)||void 0===r?void 0:r.name,client_now:new Date,release:h,client_load:ee},a={};if("object"===Y(e))for(var c of Object.getOwnPropertyNames(e))a[c]=e[c];else"string"==typeof e&&(a.message=e);return(0,D.ty)("/error/client",{body:{error:a,meta:o}})}),[v.socket,h,i]);(0,r.useEffect)((function(){function e(e){var t=e.project,n=e.permissionsLevel;a.set("project",{rootDoc_id:null,...t}),a.set("permissionsLevel",n),a.flushUpdates(),c.emit("project:joined",{project:t,permissionsLevel:n}),g(!0)}return v.on("joinProjectResponse",e),function(){v.removeListener("joinProjectResponse",e)}}),[v,c,a]);var _=(0,r.useMemo)((function(){return{_id:(0,b.Z)("ol-project_id"),$scope:{$on:function(){},$watch:function(){},$applyAsync:function(){},user:{},project:{_id:(0,b.Z)("ol-project_id"),name:(0,b.Z)("ol-projectName"),rootDocId:"",members:[],invites:[],features:{collaborators:0,compileGroup:"standard",trackChangesVisible:!1,references:!1,mendeley:!1,zotero:!1},publicAccessLevel:"",owner:{_id:"",email:""}},state:{loading:!1},permissionsLevel:"readOnly",editor:{sharejs_doc:null,showSymbolPalette:!1,toggleSymbolPalette:function(){}},ui:{view:"pdf",chatOpen:!1,reviewPanelOpen:!1,leftMenuShown:!1,pdfLayout:"flat"},pdf:{uncompiled:!0,logEntryAnnotations:{}},settings:{syntaxValidation:!1,pdfViewer:"pdfjs"},hasLintingError:!1},editorManager:{openDoc:function(){},getCurrentDocId:function(){}},socket:v,reportError:y}}),[v,y]),w=(0,r.useMemo)((function(){return{eventEmitter:c,eventLog:s,startedFreeTrial:d,setStartedFreeTrial:f,projectId:i,reportError:y,projectJoined:m}}),[c,s,i,m,y,d]);return(0,J.jsx)(te.Provider,{value:w,children:(0,J.jsx)(k.Pk,{ide:_,scopeStore:a,scopeEventEmitter:l,children:o})})};function oe(){var e=(0,r.useContext)(te);if(!e)throw new Error("useIdeReactContext is only available inside IdeReactProvider");return e}},50066:function(e,t,n){"use strict";n.d(t,{p:function(){return w},a:function(){return k}});n(71372),n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850);var r=n(2784),o=(n(34769),n(75234)),i=n(17631),a=n(11685),c=n(52322),l=["title","message"];function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function u(e){var t=e.title,n=e.message,r=s(e,l),u=(0,o.$G)().t;return(0,c.jsxs)(a.Z,{...r,children:[(0,c.jsx)(i.Z.Header,{closeButton:!0,children:(0,c.jsx)(i.Z.Title,{children:t})}),(0,c.jsx)(i.Z.Body,{className:"modal-body-share",children:n}),(0,c.jsx)(i.Z.Footer,{children:(0,c.jsx)("button",{className:"btn btn-info",onClick:function(){return r.onHide()},children:u("ok")})})]})}var d=(0,r.memo)(u),f=(n(74069),n(63584)),h=n(46267);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e){var t,n=e.editorContent,l=e.show,s=e.onHide,u=(0,o.$G)().t,d=(0,h.T)(),m=p((0,r.useState)(!1),2),g=m[0],v=m[1],y=((null===(t=n.match(/\n/g))||void 0===t?void 0:t.length)||0)+1;function _(){s(),d.reload()}return(0,c.jsxs)(a.Z,{show:l,onHide:_,className:"out-of-sync-modal",backdrop:!1,keyboard:!1,children:[(0,c.jsx)(i.Z.Header,{closeButton:!0,children:(0,c.jsx)(i.Z.Title,{children:u("out_of_sync")})}),(0,c.jsx)(i.Z.Body,{className:"modal-body-share",children:(0,c.jsx)(o.cC,{i18nKey:"out_of_sync_detail",components:[(0,c.jsx)("br",{}),(0,c.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:"/learn/Kb/Editor_out_of_sync_problems"})]})}),(0,c.jsxs)(i.Z.Body,{children:[(0,c.jsx)(f.Z,{bsStyle:"info",onClick:function(){return v((function(e){return!e}))},children:u(g?"hide_local_file_contents":"show_local_file_contents")}),g?(0,c.jsx)("div",{className:"text-preview",children:(0,c.jsx)("textarea",{className:"scroll-container",readOnly:!0,rows:y,value:n})}):null]}),(0,c.jsx)(i.Z.Footer,{children:(0,c.jsx)(f.Z,{bsStyle:"info",onClick:_,children:u("reload_editor")})})]})}var v=(0,r.memo)(g);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=(0,r.createContext)(void 0),w=function(e){var t=e.children,n=y((0,r.useState)(!1),2),o=n[0],i=n[1],a=y((0,r.useState)({title:"",message:""}),2),l=a[0],s=a[1],u=y((0,r.useState)(!1),2),f=u[0],h=u[1],p=y((0,r.useState)({editorContent:""}),2),m=p[0],g=p[1],_=(0,r.useCallback)((function(){i(!1)}),[]),w=(0,r.useCallback)((function(e,t){s({title:e,message:t}),i(!0)}),[]),k=(0,r.useCallback)((function(){h(!1)}),[]),x=(0,r.useCallback)((function(e){g({editorContent:e}),h(!0)}),[]),j=(0,r.useMemo)((function(){return{showGenericMessageModal:w,genericModalVisible:o,showOutOfSyncModal:x}}),[w,o,x]);return(0,c.jsxs)(b.Provider,{value:j,children:[t,(0,c.jsx)(d,{show:o,onHide:_,...l}),(0,c.jsx)(v,{...m,show:f,onHide:k})]})};function k(){var e=(0,r.useContext)(b);if(!e)throw new Error("useModalsContext is only available inside ModalsContextProvider");return e}},28865:function(e,t,n){"use strict";n.d(t,{Bp:function(){return y},tA:function(){return g},uS:function(){return _}});n(28673),n(15735),n(6886),n(35883),n(26936),n(45794),n(18178),n(71372),n(34115),n(634),n(58188),n(20796),n(32501),n(88233),n(27233),n(77950),n(21850);var r=n(2784),o=n(8596),i=n(5446),a=n(37246),c=n(14642),l=n(76635),s=n(47481),u=n(14595),d=n(65403),f=n(45177),h=n(52322);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e){e.set("onlineUsers",{}),e.set("onlineUserCursorHighlights",{}),e.set("onlineUsersArray",[]),e.set("onlineUsersCount",0)}var v=(0,r.createContext)(void 0),y=function(e){var t=e.children,n=(0,o.I)().eventEmitter,m=(0,i.Km)().socket,g=p((0,a.Z)("editor.open_doc_id"),1)[0],y=(0,s.O)().fileTreeData,_=p((0,a.Z)("onlineUsers"),2),b=_[0],w=_[1],k=p((0,a.Z)("onlineUserCursorHighlights"),2),x=k[0],j=k[1],T=p((0,a.Z)("onlineUsersArray"),2),S=T[0],I=T[1],C=p((0,a.Z)("onlineUsersCount"),2),E=C[0],O=C[1],L=p((0,r.useState)(null),2),A=L[0],M=L[1],P=p((0,r.useState)(500),2),D=P[0],F=P[1],X=(0,r.useCallback)((function(e){var t={},n=[],r={};for(var o of Object.entries(e)){var i,a=p(o,2),l=a[0],s=a[1],d={...s},f=s.doc_id;f&&(d.doc=(0,u.I)(y,f)),null!==s.name&&0!==s.name.trim().length||(d.name=s.email?s.email.trim():"Anonymous"),d.initial=null===(i=s.name)||void 0===i?void 0:i[0],d.initial&&" "!==d.initial||(d.initial="?"),n.push(d),t[l]=d,null!=f&&null!=s.row&&null!=s.column&&(r[f]||(r[f]=[]),r[f].push({label:s.name,cursor:{row:s.row,column:s.column},hue:c.Z.getHueForUserId(s.user_id)}))}return{onlineUsers:t,onlineUsersArray:n,onlineUserCursorHighlights:r,cursorUpdateInterval:n.length>0?500:3e5}}),[y]),Z=(0,r.useCallback)((function(e){var t=X(e);w(t.onlineUsers),I(t.onlineUsersArray),O(t.onlineUsersArray.length),j(t.onlineUserCursorHighlights),F(t.cursorUpdateInterval)}),[X,j,w,I,O]);(0,r.useEffect)((function(){var e=function(){m.emit("clientTracking.getConnectedUsers",(function(e,t){if(e)f.c.error(e);else{var n={};for(var r of t){var o,i,a;r.client_id!==m.publicId&&(n[r.client_id]={id:r.client_id,user_id:r.user_id,email:r.email,name:"".concat(r.first_name," ").concat(r.last_name),doc_id:null===(o=r.cursorData)||void 0===o?void 0:o.doc_id,row:null===(i=r.cursorData)||void 0===i?void 0:i.row,column:null===(a=r.cursorData)||void 0===a?void 0:a.column})}Z(n)}}))};return n.on("project:joined",e),function(){n.off("project:joined",e)}}),[n,Z,w,m]),(0,r.useEffect)((function(){var e=function(e){var t=p(e.detail,1)[0];t&&M(t)};return n.on("cursor:editor:update",e),function(){n.off("cursor:editor:update",e)}}),[D,n]),(0,r.useEffect)((function(){var e=window.setTimeout((function(){m.emit("clientTracking.updatePosition",{row:null==A?void 0:A.row,column:null==A?void 0:A.column,doc_id:g})}),D);return function(){window.clearTimeout(e)}}),[A,D,g,m]);var R=(0,r.useCallback)((function(e){e.id!==m.publicId&&Z({...b,[e.id]:e})}),[b,Z,m.publicId]);(0,d.Z)(m,"clientTracking.clientUpdated",R);var U=(0,r.useCallback)((function(e){Z((0,l.omit)(b,e))}),[b,Z]);(0,d.Z)(m,"clientTracking.clientDisconnected",U);var N=(0,r.useMemo)((function(){return{onlineUsers:b,onlineUsersArray:S,onlineUserCursorHighlights:x,onlineUsersCount:E}}),[b,S,x,E]);return(0,h.jsx)(v.Provider,{value:N,children:t})};function _(){var e=(0,r.useContext)(v);if(!e)throw new Error("useOnlineUsersContext is only available inside OnlineUsersProvider");return e}},86845:function(e,t,n){"use strict";n.d(t,{E3:function(){return g},P_:function(){return v}});n(71372),n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850);var r=n(2784),o=n(5446),i=n(84050),a=n(66041),c=n(37246),l=n(49819),s=n(52322);function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=(0,r.createContext)(void 0),h={readOnly:{read:!0,write:!1,admin:!1,comment:!0},readAndWrite:{read:!0,write:!0,admin:!1,comment:!0},owner:{read:!0,write:!0,admin:!0,comment:!0}},p={readOnly:{...h.readOnly,comment:!1},readAndWrite:{...h.readAndWrite,comment:!1},owner:{...h.owner,comment:!1}},m={readOnly:{...h.readOnly,comment:!1},readAndWrite:h.readAndWrite,owner:h.owner},g=function(e){var t=e.children,n=u((0,c.Z)("permissions"),2),d=n[0],g=n[1],v=(0,o.Km)().connectionState,y=(0,i._i)().permissionsLevel,_=(0,l.Z)(),b=(0,a.Z)("ol-anonymous");return(0,r.useEffect)((function(){g((_?m:b?p:h)[y])}),[b,y,g,_]),(0,r.useEffect)((function(){v.forceDisconnected&&g((function(e){return{...e,write:!1}}))}),[v.forceDisconnected,g]),(0,s.jsx)(f.Provider,{value:d,children:t})};function v(){var e=(0,r.useContext)(f);if(!e)throw new Error("usePermissionsContext is only available inside PermissionsProvider");return e}},35324:function(e,t,n){"use strict";n.d(t,{u:function(){return I}});var r=n(5446),o=n(8596),i=n(39493),a=n(99834),c=n(72526),l=n(50641),s=n(84050),u=n(63290),d=n(91661),f=n(47481),h=n(39488),p=n(63551),m=n(87828),g=n(28865),v=n(52654),y=n(57743),_=n(22276),b=n(50066),w=n(97502),k=n(72309),x=n(86845),j=n(7242),T=n(19816),S=n(52322),I=function(e){var t=e.children;return(0,S.jsx)(_._8,{children:(0,S.jsx)(b.p,{children:(0,S.jsx)(r.U,{children:(0,S.jsx)(o.eH,{children:(0,S.jsx)(u.dr,{children:(0,S.jsx)(k.B9,{children:(0,S.jsx)(c.j,{children:(0,S.jsx)(f.T,{children:(0,S.jsx)(w.Ek,{children:(0,S.jsx)(y.nl,{children:(0,S.jsx)(a.dn,{children:(0,S.jsx)(s.KU,{children:(0,S.jsx)(x.E3,{children:(0,S.jsx)(l.ou,{children:(0,S.jsx)(i.aM,{children:(0,S.jsx)(d.b3,{children:(0,S.jsx)(m.gy,{children:(0,S.jsx)(h.in,{children:(0,S.jsx)(p.aM,{children:(0,S.jsx)(j.h,{children:(0,S.jsx)(g.Bp,{children:(0,S.jsx)(v.oU,{children:(0,S.jsx)(T.H,{children:t})})})})})})})})})})})})})})})})})})})})})})})}},48910:function(e,t,n){"use strict";n.d(t,{f:function(){return a}});var r=n(47481),o=n(2784),i=n(38113);function a(){var e=(0,r.O)(),t=e.fileTreeData,n=e.selectedEntities;return{selectEntity:(0,o.useCallback)((function(e){1===n.length&&n[0].entity._id===e||(0,i.Z7)(t,e)&&window.dispatchEvent(new CustomEvent("editor.openDoc",{detail:e}))}),[t,n])}}},65403:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(2784);function o(e,t,n){(0,r.useEffect)((function(){return e.on(t,n),function(){e.removeListener(t,n)}}),[t,n,e])}},14595:function(e,t,n){"use strict";n.d(t,{I:function(){return o}});var r=n(38113);function o(e,t){var n=(0,r.Z7)(e,t);return n&&"doc"===n.type?n.entity:null}},10163:function(e,t,n){"use strict";var r=n(13980),o=n.n(r),i=n(75234),a=n(48755),c=n(52322);function l(e){var t=e.type,n=(0,i.$G)().t,r=(0,c.jsx)(i.cC,{i18nKey:"try_recompile_project_or_troubleshoot",components:[(0,c.jsx)("a",{href:"/learn/how-to/Resolving_access%2C_loading%2C_and_display_problems",target:"_blank"},"troubleshooting-link")]});switch(t){case"pdf":return(0,c.jsxs)(a.l,{children:[(0,c.jsx)("p",{children:n("pdf_viewer_error")}),(0,c.jsx)("p",{children:r})]});case"logs":return(0,c.jsxs)(a.l,{children:[(0,c.jsx)("p",{children:n("log_viewer_error")}),(0,c.jsx)("p",{children:r})]});default:return(0,c.jsxs)(a.l,{children:[(0,c.jsx)("p",{children:n("pdf_preview_error")}),(0,c.jsx)("p",{children:r})]})}}l.propTypes={type:o().oneOf(["preview","pdf","logs"]).isRequired},t.Z=l},16233:function(e,t,n){"use strict";n.d(t,{I:function(){return l},a:function(){return s}});n(71372),n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850);var r=n(2784),o=n(52322);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=(0,r.createContext)(void 0),l=function(){var e=(0,r.useContext)(c);if(!e)throw new Error("usePdfPreviewContext is only avalable inside PdfPreviewProvider");return e},s=function(e){var t=e.children,n=i((0,r.useState)(!1),2),a=n[0],l=n[1],s=(0,r.useMemo)((function(){return{loadingError:a,setLoadingError:l}}),[a]);return(0,o.jsx)(c.Provider,{value:s,children:t})}},31638:function(e,t,n){"use strict";n.d(t,{Z:function(){return ft}});var r={};n.r(r),n.d(r,{default:function(){return k}});var o=n(2784),i=n(12524),a=n.n(i),c=(n(43450),n(35883),n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372),n(75234)),l=n(13980),s=n.n(l);n(18178);var u=function(e,t,n){var r=(0,o.useRef)(),i=(0,o.useCallback)((function(){r.current=new ResizeObserver((function(e){n(e[0])}))}),[n]);(0,o.useLayoutEffect)((function(){if("ResizeObserver"in window){var t=e&&e.current;return t&&i(e.current),r.current&&t&&r.current.observe(t),function(){t&&function(e){r.current.unobserve(e)}(t)}}}),[e,t,i])},d=n(24958),f=n(10280),h=n(52322);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e){var t=e.sourceLocation,n=e.level,r=e.headerTitle,i=e.headerIcon,l=e.logType,s=e.showSourceLocationLink,m=void 0===s||s,g=e.showCloseButton,v=void 0!==g&&g,y=e.onSourceLocationClick,_=e.onClose,b=(0,c.$G)().t,w=(0,o.useRef)(),k=p((0,o.useState)(!1),2),x=k[0],j=k[1];u(w,x,(function(e){var t=e.target,n=t.scrollWidth>t.clientWidth;j(n)}));var T=t?t.file:null,S=t?t.line:null,I=a()("log-entry-header",{"log-entry-header-error":"error"===n,"log-entry-header-warning":"warning"===n,"log-entry-header-info":"info"===n,"log-entry-header-typesetting":"typesetting"===n,"log-entry-header-raw":"raw"===n,"log-entry-header-success":"success"===n}),C=a()("log-entry-header-link",{"log-entry-header-link-error":"error"===n,"log-entry-header-link-warning":"warning"===n,"log-entry-header-link-typesetting":"typesetting"===n,"log-entry-header-link-raw":"raw"===n,"log-entry-header-link-info":"info"===n,"log-entry-header-link-success":"success"===n}),E=b("navigate_log_source",{location:T+(S?", ".concat(S):"")});var O=m&&T?"".concat(T).concat(S?", ".concat(S):""):null,L=O?(0,h.jsxs)("button",{className:C,type:"button","aria-label":E,onClick:y,children:[(0,h.jsx)(f.Z,{type:"chain"})," ",(0,h.jsx)("span",{ref:w,className:"log-entry-header-link-location",children:"‪".concat(O,"‬")})]}):null,A=l?"".concat(l," ").concat(r):r;return(0,h.jsxs)("header",{className:I,children:[i?(0,h.jsx)("div",{className:"log-entry-header-icon-container",children:i}):null,(0,h.jsx)("h3",{className:"log-entry-header-title",children:A}),x&&O?(0,h.jsx)(d.Z,{id:O,description:O,overlayProps:{placement:"left"},tooltipProps:{className:"log-location-tooltip"},children:L}):L,v?(0,h.jsx)("button",{className:"btn-inline-link log-entry-header-link",type:"button","aria-label":b("dismiss_error_popup"),onClick:_,children:(0,h.jsx)("span",{"aria-hidden":"true",children:"×"})}):null]})}g.propTypes={sourceLocation:s().shape({file:s().string,line:s().any,column:s().any}),level:s().string.isRequired,headerTitle:s().oneOfType([s().string,s().node]),headerIcon:s().element,logType:s().string,showSourceLocationLink:s().bool,showCloseButton:s().bool,onSourceLocationClick:s().func,onClose:s().func};var v=g,y=(n(73439),n(66041)),_=(0,o.lazy)((function(){return Promise.all([n.e(9278),n.e(3888),n.e(2495)]).then(n.bind(n,89748))})),b={raw:!1,warning:!0,error:!0,typesetting:!1},w=function(e){var t=e.index,n=e.logEntry;return(0,y.Z)("ol-showAiErrorAssistant")&&n.level&&b[n.level]&&n.raw?(0,h.jsx)(o.Suspense,{fallback:null,children:(0,h.jsx)(_,{index:t,logEntry:n})}):null},k=(0,o.memo)(w),x=(n(45794),n(25897)),j=n(63584);function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I(e){var t=e.rawContent,n=e.collapsedSize,r=void 0===n?0:n,i=T((0,o.useState)(!1),2),l=i[0],s=i[1],u=T((0,o.useState)(!0),2),d=u[0],p=u[1],m=(0,x.y)((0,o.useCallback)((function(e){0!==e.scrollHeight&&p(e.scrollHeight>r)}),[r])).elementRef,g=(0,c.$G)().t;return(0,h.jsxs)("div",{className:"log-entry-content-raw-container",children:[(0,h.jsx)("div",{className:"expand-collapse-container",style:{height:l||!d?"auto":r},children:(0,h.jsx)("pre",{className:"log-entry-content-raw",ref:m,children:t.trim()})}),d&&(0,h.jsx)("div",{className:a()("log-entry-content-button-container",{"log-entry-content-button-container-collapsed":!l}),children:(0,h.jsx)(j.Z,{bsSize:"xs",bsStyle:null,className:"log-entry-btn-expand-collapse btn-secondary",onClick:function(){return s((function(e){return!e}))},children:l?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(f.Z,{type:"angle-up"})," ",g("collapse")]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(f.Z,{type:"angle-down"})," ",g("expand")]})})})]})}I.propTypes={rawContent:s().string.isRequired,collapsedSize:s().number};var C=[{import:r,path:"/overleaf/services/web/modules/ai/frontend/js/components/ai-error-assistant"}];function E(e){var t=e.rawContent,n=e.formattedContent,r=e.extraInfoURL,o=e.index,i=e.logEntry,a=(0,c.$G)().t;return(0,h.jsxs)("div",{className:"log-entry-content",children:[n&&(0,h.jsx)("div",{className:"log-entry-formatted-content",children:n}),r&&(0,h.jsx)("div",{className:"log-entry-content-link",children:(0,h.jsx)("a",{href:r,target:"_blank",rel:"noopener",children:a("log_hint_extra_info")})}),i&&C.map((function(e){var t=e.import.default,n=e.path;return(0,h.jsx)(t,{index:o,logEntry:i},n)})),t&&(0,h.jsx)(I,{rawContent:t,collapsedSize:150})]})}E.propTypes={rawContent:s().string,formattedContent:s().node,extraInfoURL:s().string,index:s().number,logEntry:s().any};n(1939),n(34769);var O=n(56377);function L(e){var t=e.url,n=e.children;return(0,y.Z)("ol-wikiEnabled")?(0,h.jsx)("a",{href:t,target:"_blank",rel:"noopener",children:n}):(0,h.jsx)(h.Fragment,{children:n})}L.propTypes={url:s().string.isRequired,children:s().node.isRequired};var A={hint_misplaced_alignment_tab_character:{extraInfoURL:"https://www.overleaf.com/learn/Errors/Misplaced_alignment_tab_character_%26",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have placed an alignment tab character '&' in the wrong place. If you want to align something, you must write it inside an align environment such as \\begin","{align}"," … \\end","{align}",", \\begin","{tabular}"," … \\end","{tabular}",", etc. If you want to write an ampersand '&' in text, you must write \\& instead."]})}},hint_extra_alignment_tab_has_been_changed:{extraInfoURL:"https://www.overleaf.com/learn/Errors/Extra_alignment_tab_has_been_changed_to_%5Ccr",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have written too many alignment tabs in a table, causing one of them to be turned into a line break. Make sure you have specified the correct number of columns in your"," ",(0,h.jsx)(L,{url:"https://www.overleaf.com/learn/Tables",children:"table"}),"."]})}},hint_display_math_should_end_with:{extraInfoURL:"https://www.overleaf.com/learn/Errors/Display_math_should_end_with_$$",formattedContent:function(){return(0,h.jsx)(h.Fragment,{children:"You have forgotten a $ sign at the end of 'display math' mode. When writing in display math mode, you must always math write inside $$ … $$. Check that the number of $s match around each math expression."})}},hint_missing_inserted:{extraInfoURL:"https://www.overleaf.com/learn/Errors/Missing_$_inserted",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("p",{children:"You need to enclose all mathematical expressions and symbols with special markers. These special markers create a ‘math mode’."}),(0,h.jsxs)("p",{children:["Use ",(0,h.jsx)("code",{children:"$...$"})," for inline math mode, and ",(0,h.jsx)("code",{children:"\\[...\\]"}),"or one of the mathematical environments (e.g. equation) for display math mode."]}),(0,h.jsxs)("p",{children:["This applies to symbols such as subscripts ( ",(0,h.jsx)("code",{children:"_"})," ), integrals ( ",(0,h.jsx)("code",{children:"\\int"})," ), Greek letters ( ",(0,h.jsx)("code",{children:"\\alpha"}),","," ",(0,h.jsx)("code",{children:"\\beta"}),", ",(0,h.jsx)("code",{children:"\\delta"})," ) and modifiers"," ",(0,h.jsx)("code",{children:"(\\vec{x}"}),", ",(0,h.jsxs)("code",{children:["\\tilde{x}",")"]}),"."]})]})}},hint_reference_undefined:{extraInfoURL:"https://www.overleaf.com/learn/Errors/There_were_undefined_references",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have referenced something which has not yet been labelled. If you have labelled it already, make sure that what is written inside \\ref","{...}"," is the same as what is written inside \\label","{...}","."]})}},hint_there_were_undefined_references:{extraInfoURL:"https://www.overleaf.com/learn/Errors/There_were_undefined_references",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have referenced something which has not yet been labelled. If you have labelled it already, make sure that what is written inside \\ref","{...}"," is the same as what is written inside \\label","{...}","."]})}},hint_citation_on_page_undefined_on_input_line:{extraInfoURL:"https://www.overleaf.com/learn/Errors/Citation_XXX_on_page_XXX_undefined_on_input_line_XXX",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have cited something which is not included in your bibliography. Make sure that the citation (\\cite","{...}",") has a corresponding key in your bibliography, and that both are spelled the same way."]})}},hint_label_multiply_defined_labels:{extraInfoURL:"https://www.overleaf.com/learn/Errors/There_were_multiply-defined_labels",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have used the same label more than once. Check that each \\label","{...}"," labels only one item."]})}},hint_float_specifier_changed:{extraInfoURL:"https://www.overleaf.com/learn/Errors/%60!h%27_float_specifier_changed_to_%60!ht%27",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["The float specifier 'h' is too strict of a demand for LaTeX to place your float in a nice way here. Try relaxing it by using 'ht', or even 'htbp' if necessary. If you want to try keep the float here anyway, check out the"," ",(0,h.jsx)(L,{url:"https://www.overleaf.com/learn/Positioning_of_Figures",children:"float package"}),"."]})}},hint_no_positions_in_optional_float_specifier:{extraInfoURL:"https://www.overleaf.com/learn/Errors/No_positions_in_optional_float_specifier",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have forgotten to include a float specifier, which tells LaTeX where to position your figure. To fix this, either insert a float specifier inside the square brackets (e.g. \\begin","{figure}","[h]), or remove the square brackets (e.g. \\begin","{figure}","). Find out more about float specifiers"," ",(0,h.jsx)(L,{url:"https://www.overleaf.com/learn/Positioning_of_Figures",children:"here"}),"."]})}},hint_undefined_control_sequence:{formattedContent:function(e){if(null!=e&&e.length&&O.G.has(e[0])){var t=e[0],n=O.G.get(t);return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("p",{children:["We think you’ve got a missing package! The ",(0,h.jsx)("code",{children:t})," ","command won't work unless you include",(0,h.jsx)("code",{children:n.command})," in your"," ",(0,h.jsx)(L,{url:"https://www.overleaf.com/learn/latex/Learn_LaTeX_in_30_minutes#The_preamble_of_a_document",children:"document preamble"}),"."," ",(0,h.jsx)(L,{url:"https://www.overleaf.com/learn/latex/Learn_LaTeX_in_30_minutes#Finding_and_using_LaTeX_packages",children:"Learn more about packages"}),"."]})})}return(0,h.jsxs)(h.Fragment,{children:["The compiler is having trouble understanding a command you have used. Check that the command is spelled correctly. If the command is part of a package, make sure you have included the package in your preamble using ",(0,h.jsx)("code",{children:"\\usepackage"}),"{...}",".",(0,h.jsx)("div",{className:"log-entry-content-link",children:(0,h.jsx)("a",{href:"https://www.overleaf.com/learn/Errors/Undefined_control_sequence",target:"_blank",rel:"noopener",children:"Learn more"})})]})}},hint_undefined_environment:{formattedContent:function(e){if(null!=e&&e.length&&O.y.has(e[0])){var t=e[0],n=O.y.get(t);return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("p",{children:["We think you’ve got a missing package! The"," ",(0,h.jsx)("code",{children:t})," environment won't work unless you include ",(0,h.jsx)("code",{children:n.command})," in your"," ",(0,h.jsx)(L,{url:"https://www.overleaf.com/learn/latex/Learn_LaTeX_in_30_minutes#The_preamble_of_a_document",children:"document preamble"}),"."," ",(0,h.jsx)(L,{url:"https://www.overleaf.com/learn/latex/Learn_LaTeX_in_30_minutes#Finding_and_using_LaTeX_packages",children:"Learn more about packages"}),"."]})})}return(0,h.jsxs)(h.Fragment,{children:["You have created an environment (using \\begin","{…}"," and \\end","{…}"," commands) which is not recognized. Make sure you have included the required package for that environment in your preamble, and that the environment is spelled correctly.",(0,h.jsx)("div",{className:"log-entry-content-link",children:(0,h.jsx)("a",{href:"https://www.overleaf.com/learn/Errors%2FLaTeX%20Error%3A%20Environment%20XXX%20undefined",target:"_blank",rel:"noopener",children:"Learn more"})})]})}},hint_file_not_found:{extraInfoURL:"https://www.overleaf.com/learn/Errors/File_XXX_not_found_on_input_line_XXX",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["The compiler cannot find the file you want to include. Make sure that you have"," ",(0,h.jsx)(L,{url:"https://www.overleaf.com/learn/how-to/Including_images_on_Overleaf",children:"uploaded the file"})," ","and"," ",(0,h.jsx)(L,{url:"https://www.overleaf.com/learn/Errors/File_XXX_not_found_on_input_line_XXX.",children:"specified the file location correctly"}),"."]})}},hint_unknown_graphics_extension:{extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_Unknown_graphics_extension:_.XXX",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["The compiler does not recognise the file type of one of your images. Make sure you are using a"," ",(0,h.jsx)(L,{url:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_Unknown_graphics_extension:_.gif.",children:"supported image format"})," ","for your choice of compiler, and check that there are no periods (.) in the name of your image."]})}},hint_unknown_float_option_h:{extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_Unknown_float_option_%60H%27",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["The compiler isn't recognizing the float option 'H'. Include \\usepackage","{float}"," in your preamble to fix this."]})}},hint_unknown_float_option_q:{extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_Unknown_float_option_%60q%27",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have used a float specifier which the compiler does not understand. You can learn more about the different float options available for placing figures"," ",(0,h.jsx)(L,{url:"https://www.overleaf.com/learn/Positioning_of_Figures",children:"here"})," ","."]})}},hint_math_allowed_only_in_math_mode:{extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_%5Cmathrm_allowed_only_in_math_mode",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have used a font command which is only available in math mode. To use this command, you must be in maths mode (E.g. $ … $ or \\begin","{math}"," … \\end","{math}","). If you want to use it outside of math mode, use the text version instead: \\textrm, \\textit, etc."]})}},hint_mismatched_environment:{formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have used \\begin","{...}"," without a corresponding \\end","{...}","."]})}},hint_mismatched_brackets:{formattedContent:function(){return(0,h.jsx)(h.Fragment,{children:"You have used an open bracket without a corresponding close bracket."})}},hint_can_be_used_only_in_preamble:{extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_Can_be_used_only_in_preamble",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have used a command in the main body of your document which should be used in the preamble. Make sure that \\documentclass[…]","{…}"," and all \\usepackage","{…}"," commands are written before \\begin","{document}","."]})}},hint_missing_right_inserted:{extraInfoURL:"https://www.overleaf.com/learn/Errors/Missing_%5Cright_insertede",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have started an expression with a \\left command, but have not included a corresponding \\right command. Make sure that your \\left and \\right commands balance everywhere, or else try using \\Biggl and \\Biggr commands instead as shown"," ",(0,h.jsx)(L,{url:"https://www.overleaf.com/learn/Errors/Missing_%5Cright_inserted",children:"here"}),"."]})}},hint_double_superscript:{extraInfoURL:"https://www.overleaf.com/learn/Errors/Double_superscript",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have written a double superscript incorrectly as a^b^c, or else you have written a prime with a superscript. Remember to include ","{and}"," ","when using multiple superscripts. Try a^","{b ^ c}"," instead."]})}},hint_double_subscript:{extraInfoURL:"https://www.overleaf.com/learn/Errors/Double_subscript",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have written a double subscript incorrectly as a_b_c. Remember to include ","{and}"," when using multiple subscripts. Try a_","{b_c}"," instead."]})}},hint_no_author_given:{extraInfoURL:"https://www.overleaf.com/learn/Errors/No_%5Cauthor_given",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have used the \\maketitle command, but have not specified any \\author. To fix this, include an author in your preamble using the \\author","{…}"," command."]})}},hint_somethings_wrong_perhaps_a_missing_item:{extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_Something%27s_wrong--perhaps_a_missing_%5Citem",formattedContent:function(){return(0,h.jsx)(h.Fragment,{children:"There are no entries found in a list you have created. Make sure you label list entries using the \\item command, and that you have not used a list inside a table."})}},hint_misplaced_noalign:{extraInfoURL:"https://www.overleaf.com/learn/Errors/Misplaced_%5Cnoalign",formattedContent:function(){return(0,h.jsx)(h.Fragment,{children:"You have used a \\hline command in the wrong place, probably outside a table. If the \\hline command is written inside a table, try including \\\\ before it."})}},hint_no_line_here_to_end:{extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_There%27s_no_line_here_to_end",formattedContent:function(){return(0,h.jsx)(h.Fragment,{children:"You have used a \\\\ or \\newline command where LaTeX was not expecting one. Make sure that you only use line breaks after blocks of text, and be careful using linebreaks inside lists and other environments."})}},hint_verb_ended_by_end_of_line:{extraInfoURL:"https://www.overleaf.com/learn/Errors/LaTeX_Error:_%5Cverb_ended_by_end_of_line",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have used a \\verb command incorrectly. Try replacling the \\verb command with \\begin","{verbatim}","…\\end","{verbatim}",".\\"]})}},hint_illegal_unit_of_measure_pt_inserted:{extraInfoURL:"https://www.overleaf.com/learn/Errors%2FIllegal%20unit%20of%20measure%20(pt%20inserted)",formattedContent:function(){return(0,h.jsx)(h.Fragment,{children:"You have written a length, but have not specified the appropriate units (pt, mm, cm etc.). If you have not written a length, check that you have not witten a linebreak \\\\ followed by square brackets […] anywhere."})}},hint_extra_right:{extraInfoURL:"https://www.overleaf.com/learn/Errors/Extra_%5Cright",formattedContent:function(){return(0,h.jsx)(h.Fragment,{children:"You have written a \\right command without a corresponding \\left command. Check that all \\left and \\right commands balance everywhere."})}},hint_missing_begin_document_:{extraInfoURL:"https://www.overleaf.com/learn/Errors%2FLaTeX%20Error%3A%20Missing%20%5Cbegin%20document",formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["No \\begin","{document}"," command was found. Make sure you have included \\begin","{document}"," in your preamble, and that your main document is set correctly."]})}},hint_mismatched_environment2:{formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have used \\begin","{}"," without a corresponding \\end","{}","."]})}},hint_mismatched_environment3:{formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have used \\begin","{}"," without a corresponding \\end","{}","."]})}},hint_mismatched_environment4:{formattedContent:function(){return(0,h.jsxs)(h.Fragment,{children:["You have used \\begin","{}"," without a corresponding \\end","{}","."]})}}};(0,y.Z)("ol-wikiEnabled")||Object.keys(A).forEach((function(e){A[e].extraInfoURL=null}));var M=A,P=n(96227);function D(e){var t=e.ruleId,n=e.headerTitle,r=e.headerIcon,i=e.rawContent,c=e.logType,l=e.formattedContent,s=e.extraInfoURL,u=e.level,d=e.sourceLocation,f=e.showSourceLocationLink,p=void 0===f||f,m=e.showCloseButton,g=void 0!==m&&m,_=e.entryAriaLabel,b=void 0===_?null:_,w=e.customClass,k=e.contentDetails,x=e.onSourceLocationClick,j=e.onClose,T=e.index,S=e.logEntry,I=e.id,C=(0,y.Z)("ol-showAiErrorAssistant");if(t&&M[t]){var O=M[t];l=O.formattedContent(k),s=O.extraInfoURL}var L=(0,o.useCallback)((function(e){var n;e.preventDefault(),x(d);var r=null==d||null===(n=d.file)||void 0===n?void 0:n.split("."),o=(null==r?void 0:r.length)>1?r.pop():"";(0,P.BZ)("log-entry-link-click",{level:u,ruleId:t,extension:o})}),[u,x,t,d]);return(0,h.jsxs)("div",{className:a()("log-entry",w),"aria-label":b,"data-ruleid":t,"data-log-entry-id":I,children:[(0,h.jsx)(v,{level:u,sourceLocation:d,headerTitle:n,headerIcon:r,logType:c,showSourceLocationLink:p,onSourceLocationClick:L,showCloseButton:g,onClose:j}),(i||l||C)&&(0,h.jsx)(E,{rawContent:i,formattedContent:l,extraInfoURL:s,index:T,logEntry:S})]})}D.propTypes={ruleId:s().string,sourceLocation:v.propTypes.sourceLocation,headerTitle:v.propTypes.headerTitle,headerIcon:s().element,rawContent:s().string,logType:s().string,formattedContent:s().node,extraInfoURL:s().string,level:s().oneOf(["error","warning","info","typesetting","raw","success"]).isRequired,customClass:s().string,showSourceLocationLink:s().bool,showCloseButton:s().bool,entryAriaLabel:s().string,contentDetails:s().arrayOf(s().string),onSourceLocationClick:s().func,onClose:s().func,index:s().number,logEntry:s().any,id:s().string};var F=(0,o.memo)(D);function X(e){var t=e.issue,n=e.name,r=(0,c.$G)().t;switch(n){case"sizeCheck":return(0,h.jsx)(F,{headerTitle:r("project_too_large"),formattedContent:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{children:r("project_too_large_please_reduce")}),(0,h.jsx)("ul",{className:"list-no-margin-bottom",children:t.resources.map((function(e){return(0,h.jsxs)("li",{children:[e.path," — ",e.kbSize,"kb"]},e.path)}))})]}),entryAriaLabel:r("validation_issue_entry_description"),level:"error"});case"conflictedPaths":return(0,h.jsx)(F,{headerTitle:r("conflicting_paths_found"),formattedContent:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{children:r("following_paths_conflict")}),(0,h.jsx)("ul",{className:"list-no-margin-bottom",children:t.map((function(e){return(0,h.jsxs)("li",{children:["/",e.path]},e.path)}))})]}),entryAriaLabel:r("validation_issue_entry_description"),level:"error"});case"mainFile":return(0,h.jsx)(F,{headerTitle:r("main_file_not_found"),formattedContent:r("please_set_main_file"),entryAriaLabel:r("validation_issue_entry_description"),level:"error"});default:return null}}X.propTypes={name:s().string.isRequired,issue:s().any};var Z=(0,o.memo)(X),R=n(39488),U=n(72526);function useStopOnFirstError(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).eventSource,t=(0,R.Im)(),n=t.stopOnFirstError,r=t.setStopOnFirstError,i=(0,U.d)()._id,a=(0,o.useCallback)((function(){if(!n){var t={projectId:i};e&&(t.source=e),P.BZ("stop-on-first-error-enabled",t)}r(!0)}),[e,i,n,r]),c=(0,o.useCallback)((function(){var t={projectId:i};e&&(t.source=e),n&&P.BZ("stop-on-first-error-disabled",t),r(!1)}),[e,i,n,r]);return{enableStopOnFirstError:a,disableStopOnFirstError:c}}function N(){var e=(0,c.$G)().t,t=(0,R.Im)(),n=t.startCompile,r=t.setAnimateCompileDropdownArrow,i=useStopOnFirstError({eventSource:"logs-pane"}).disableStopOnFirstError,a=(0,o.useCallback)((function(){i(),n({stopOnFirstError:!1}),r(!0)}),[i,n,r]);return(0,h.jsx)(F,{headerTitle:e("stop_on_first_error_enabled_title"),formattedContent:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.cC,{i18nKey:"stop_on_first_error_enabled_description",components:[(0,h.jsx)("strong",{})]})," ",(0,h.jsx)(j.Z,{bsSize:"xs",bsStyle:"info",onClick:a,children:e("disable_stop_on_first_error")})]}),level:"info"})}var W=n(92910),$=n(22276);function B(){var e=(0,R.Im)(),t=e.startCompile,n=e.lastCompileOptions,r=e.setAnimateCompileDropdownArrow,i=e.isProjectOwner,a=useStopOnFirstError({eventSource:"timeout-new"}).enableStopOnFirstError,c=(0,o.useCallback)((function(){a(),t({stopOnFirstError:!0}),r(!0)}),[a,t,r]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(q,{isProjectOwner:i}),(0,y.Z)("ol-ExposedSettings").enableSubscriptions&&(0,h.jsx)(V,{handleEnableStopOnFirstErrorClick:c,lastCompileOptions:n,isProjectOwner:i})]})}var q=(0,o.memo)((function(e){var t=e.isProjectOwner,n=(0,c.$G)().t,r=(0,$.ye)("paywall-cta");return(0,h.jsx)(F,{headerTitle:n("your_compile_timed_out"),formattedContent:(0,y.Z)("ol-ExposedSettings").enableSubscriptions&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("p",{children:n(t?"your_project_exceeded_compile_timeout_limit_on_free_plan":"this_project_exceeded_compile_timeout_limit_on_free_plan")}),t?(0,h.jsxs)("p",{children:[(0,h.jsx)("strong",{children:n("upgrade_for_12x_more_compile_time")})," ",n("plus_additional_collaborators_document_history_track_changes_and_more")]}):(0,h.jsx)(c.cC,{i18nKey:"tell_the_project_owner_and_ask_them_to_upgrade",components:[(0,h.jsx)("strong",{})]}),t&&(0,h.jsx)("p",{className:"text-center",children:(0,h.jsx)(W.Z,{source:"compile-timeout",buttonProps:{variant:"primary",className:"row-spaced-small",bs3Props:{block:!0}},children:n(r?"get_more_compile_time":"start_a_free_trial")})})]}),entryAriaLabel:n("your_compile_timed_out"),level:"error"})})),V=(0,o.memo)((function(e){var t=e.lastCompileOptions,n=e.handleEnableStopOnFirstErrorClick,r=e.isProjectOwner,o=(0,c.$G)().t;var i=(0,h.jsx)("a",{"aria-label":o("read_more_about_free_compile_timeouts_servers"),href:"/blog/changes-to-free-compile-timeouts-and-servers",rel:"noopener noreferrer",target:"_blank",onClick:function(){P.BZ("paywall-info-click",{"paywall-type":"compile-timeout",content:"blog"})}});return(0,h.jsx)(F,{headerTitle:o("reasons_for_compile_timeouts"),formattedContent:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("p",{children:[o("common_causes_of_compile_timeouts_include"),":"]}),(0,h.jsxs)("ul",{children:[(0,h.jsx)("li",{children:(0,h.jsx)(c.cC,{i18nKey:"large_or_high-resolution_images_taking_too_long",components:[(0,h.jsx)("a",{href:"/learn/how-to/Optimising_very_large_image_files",rel:"noopener noreferrer",target:"_blank"})]})}),(0,h.jsxs)("li",{children:[(0,h.jsx)(c.cC,{i18nKey:"a_fatal_compile_error_that_completely_blocks_compilation",components:[(0,h.jsx)("a",{href:"/learn/how-to/Fixing_and_preventing_compile_timeouts#Step_3:_Assess_your_project_for_time-consuming_tasks_and_fatal_errors",rel:"noopener noreferrer",target:"_blank"})]}),!t.stopOnFirstError&&(0,h.jsxs)(h.Fragment,{children:[" ",(0,h.jsx)(c.cC,{i18nKey:"enable_stop_on_first_error_under_recompile_dropdown_menu",components:[(0,h.jsx)(j.Z,{bsSize:"xs",bsStyle:"info-ghost-inline",onClick:n}),(0,h.jsx)("strong",{})]})," "]})]})]}),(0,h.jsx)("p",{children:(0,h.jsx)(c.cC,{i18nKey:"learn_more_about_other_causes_of_compile_timeouts",components:[(0,h.jsx)("a",{href:"/learn/how-to/Fixing_and_preventing_compile_timeouts",rel:"noopener noreferrer",target:"_blank"})]})}),(0,h.jsx)("p",{children:(0,h.jsx)("em",{children:(0,h.jsx)(h.Fragment,{children:r?(0,h.jsx)(c.cC,{i18nKey:"weve_recently_reduced_the_compile_timeout_limit_which_may_have_affected_your_project",components:[i]}):(0,h.jsx)(c.cC,{i18nKey:"weve_recently_reduced_the_compile_timeout_limit_which_may_have_affected_this_project",components:[i]})})})})]}),entryAriaLabel:o("reasons_for_compile_timeouts"),level:"raw"})})),z=(0,o.memo)(B);n(14121),n(60523),n(28399);function PdfPreviewError(e){var t=e.error,n=(0,c.$G)().t,r=(0,R.Im)().startCompile;switch(t){case"rendering-error-expected":return(0,h.jsx)(F,{headerTitle:n("pdf_rendering_error"),formattedContent:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.cC,{i18nKey:"something_went_wrong_rendering_pdf_expected",components:[(0,h.jsx)(j.Z,{bsSize:"xs",bsStyle:"info",onClick:function(){return r()}})]}),(0,h.jsx)("br",{}),(0,h.jsx)("br",{}),(0,h.jsx)(c.cC,{i18nKey:"last_resort_trouble_shooting_guide",components:[(0,h.jsx)("a",{href:"/learn/how-to/Resolving_access%2C_loading%2C_and_display_problems",target:"_blank"},"troubleshooting-link")]})]}),level:"warning"});case"rendering-error":return(0,h.jsxs)(G,{title:n("pdf_rendering_error"),children:[n("something_went_wrong_rendering_pdf")," ",(0,h.jsx)(c.cC,{i18nKey:"try_recompile_project_or_troubleshoot",components:[(0,h.jsx)("a",{href:"/learn/how-to/Resolving_access%2C_loading%2C_and_display_problems",target:"_blank"},"troubleshooting-link")]}),(0,y.Z)("ol-compilesUserContentDomain")&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("br",{}),(0,h.jsx)("br",{}),(0,h.jsx)(c.cC,{i18nKey:"new_compile_domain_notice",values:{compilesUserContentDomain:new URL((0,y.Z)("ol-compilesUserContentDomain")).hostname},shouldUnescape:!0,tOptions:{interpolation:{escapeValue:!0}},components:[(0,h.jsx)("code",{},"domain"),(0,h.jsx)("a",{href:"/learn/how-to/Resolving_access%2C_loading%2C_and_display_problems",target:"_blank"},"troubleshooting-link")]})]})]});case"clsi-maintenance":return(0,h.jsx)(G,{title:n("server_error"),children:n("clsi_maintenance")});case"clsi-unavailable":return(0,h.jsx)(G,{title:n("server_error"),children:n("clsi_unavailable")});case"too-recently-compiled":return(0,h.jsx)(G,{title:n("server_error"),children:n("too_recently_compiled")});case"terminated":return(0,h.jsx)(G,{title:n("terminated"),children:n("compile_terminated_by_user")});case"rate-limited":return(0,h.jsx)(G,{title:n("pdf_compile_rate_limit_hit"),children:n("project_flagged_too_many_compiles")});case"compile-in-progress":return(0,h.jsx)(G,{title:n("pdf_compile_in_progress_error"),children:n("pdf_compile_try_again")});case"auto-compile-disabled":return(0,h.jsx)(G,{title:n("autocompile_disabled"),children:n("autocompile_disabled_reason")});case"project-too-large":return(0,h.jsx)(G,{title:n("project_too_large"),children:n("project_too_much_editable_text")});case"timedout":return(0,h.jsx)(J,{});case"failure":return(0,h.jsxs)(G,{title:n("no_pdf_error_title"),children:[n("no_pdf_error_explanation"),(0,h.jsxs)("ul",{className:"log-entry-formatted-content-list",children:[(0,h.jsx)("li",{children:n("no_pdf_error_reason_unrecoverable_error")}),(0,h.jsx)("li",{children:(0,h.jsx)(c.cC,{i18nKey:"no_pdf_error_reason_no_content",components:{code:(0,h.jsx)("code",{})}})}),(0,h.jsx)("li",{children:(0,h.jsx)(c.cC,{i18nKey:"no_pdf_error_reason_output_pdf_already_exists",components:{code:(0,h.jsx)("code",{})}})})]})]});case"clear-cache":case"error":default:return(0,h.jsx)(G,{title:n("server_error"),children:n("somthing_went_wrong_compiling")});case"pdf-viewer-loading-error":return(0,h.jsx)(G,{title:n("pdf_rendering_error"),children:(0,h.jsx)(c.cC,{i18nKey:"something_went_wrong_loading_pdf_viewer",components:[(0,h.jsx)("strong",{},"strong-"),(0,h.jsx)("a",{href:"/learn/how-to/Resolving_access%2C_loading%2C_and_display_problems",target:"_blank"},"troubleshooting-link"),(0,h.jsx)("a",{target:"_blank",href:"/contact"},"contact-link")]})});case"validation-problems":return null}}PdfPreviewError.propTypes={error:s().string.isRequired};var H=(0,o.memo)(PdfPreviewError);function G(e){var t=e.title,n=e.headerIcon,r=e.children,o=(0,c.$G)().t;return(0,h.jsx)(F,{headerTitle:t,headerIcon:n,formattedContent:r,entryAriaLabel:o("compile_error_entry_description"),level:"error"})}function J(){var e=(0,c.$G)().t,t=useStopOnFirstError({eventSource:"timeout"}).enableStopOnFirstError,n=(0,R.Im)(),r=n.startCompile,i=n.lastCompileOptions,a=n.setAnimateCompileDropdownArrow,l=(0,o.useCallback)((function(){t(),r({stopOnFirstError:!0}),a(!0)}),[t,r,a]);return(0,h.jsxs)(G,{title:e("timedout"),children:[(0,h.jsx)("p",{children:e("project_timed_out_intro")}),(0,h.jsxs)("ul",{children:[(0,h.jsx)("li",{children:(0,h.jsx)(c.cC,{i18nKey:"project_timed_out_optimize_images",components:[(0,h.jsx)("a",{href:"https://www.overleaf.com/learn/how-to/Optimising_very_large_image_files"})]})}),(0,h.jsxs)("li",{children:[(0,h.jsx)(c.cC,{i18nKey:"project_timed_out_fatal_error",components:[(0,h.jsx)("a",{href:"https://www.overleaf.com/learn/how-to/Why_do_I_keep_getting_the_compile_timeout_error_message%3F#Fatal_compile_errors_blocking_the_compilation"})]}),!i.stopOnFirstError&&(0,h.jsxs)(h.Fragment,{children:[" ",(0,h.jsx)(c.cC,{i18nKey:"project_timed_out_enable_stop_on_first_error",components:[(0,h.jsx)(j.Z,{bsSize:"xs",bsStyle:"info",onClick:l})]})," "]})]})]}),(0,h.jsx)("p",{children:(0,h.jsx)(c.cC,{i18nKey:"project_timed_out_learn_more",components:[(0,h.jsx)("a",{href:"https://www.overleaf.com/learn/how-to/Why_do_I_keep_getting_the_compile_timeout_error_message%3F"})]})})]})}function Y(){var e=(0,R.Im)(),t=e.compiling,n=e.clearCache,r=e.clearingCache,o=(0,c.$G)().t;return(0,h.jsxs)(j.Z,{bsSize:"small",bsStyle:"danger",className:"logs-pane-actions-clear-cache",onClick:function(){return n()},disabled:r||t,children:[r?(0,h.jsx)(f.Z,{type:"refresh",spin:!0}):(0,h.jsx)(f.Z,{type:"trash-o"})," ",(0,h.jsx)("span",{children:o("clear_cached_files")})]})}G.propTypes={title:s().string.isRequired,headerIcon:s().element,children:s().any.isRequired},J.propTypes={};var K=(0,o.memo)(Y),Q=n(82752),ee=n(13253);function te(e){var t,n=e.fileList,r=(0,c.$G)().t;if(!n)return null;function o(e){return e.path.split("/").pop()}return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(ee.Z,{header:!0,children:r("other_output_files")}),n.top.map((function(e){return(0,h.jsx)(ee.Z,{download:o(e),href:e.url,children:(0,h.jsx)("b",{children:e.path})},e.path)})),n.other.length>0&&n.top.length>0&&(0,h.jsx)(ee.Z,{divider:!0}),n.other.map((function(e){return(0,h.jsx)(ee.Z,{download:o(e),href:e.url,children:(0,h.jsx)("b",{children:e.path})},e.path)})),(null===(t=n.archive)||void 0===t?void 0:t.fileCount)>0&&(0,h.jsx)(ee.Z,{download:o(n.archive),href:n.archive.url,children:(0,h.jsxs)("b",{children:[r("download_all")," (",n.archive.fileCount,")"]})},n.archive.path)]})}var ne=s().arrayOf(s().shape({path:s().string.isRequired,url:s().string.isRequired}));te.propTypes={fileList:s().shape({top:ne,other:ne,archive:s().shape({path:s().string.isRequired,url:s().string.isRequired,fileCount:s().number.isRequired})})};var re=(0,o.memo)(te),oe=n(15300);function ie(){var e=(0,R.Im)(),t=e.compiling,n=e.fileList,r=(0,c.$G)().t;return(0,h.jsxs)(oe.Z,{id:"dropdown-files-logs-pane",dropup:!0,pullRight:!0,disabled:t||!n,children:[(0,h.jsx)(Q.Z.Toggle,{className:"dropdown-toggle btn-secondary-info btn-secondary",title:r("other_logs_and_files"),bsSize:"small",bsStyle:null}),(0,h.jsx)(Q.Z.Menu,{id:"dropdown-files-logs-pane-list",children:(0,h.jsx)(re,{fileList:n})})]})}var ae=(0,o.memo)(ie);function ce(e){var t=e.totalEntries,n=e.entriesShown,r=e.hasErrors,i=(0,c.$G)().t,a=(0,R.Im)(),l=a.startCompile,s=a.stoppedOnFirstError,u=a.setAnimateCompileDropdownArrow,d=useStopOnFirstError({eventSource:"too-many-logs"}).enableStopOnFirstError,p=i("log_entry_maximum_entries_title",{total:t,displayed:n}),m=(0,o.useCallback)((function(){d(),l({stopOnFirstError:!0}),u(!0)}),[d,l,u]);return(0,h.jsxs)("div",{className:"log-entry","aria-label":i("log_entry_maximum_entries"),children:[(0,h.jsx)(v,{level:"raw",headerTitle:p}),(0,h.jsx)("div",{className:"log-entry-content",children:(0,h.jsx)("div",{className:"log-entry-formatted-content",children:r&&!s?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("p",{children:[(0,h.jsx)(f.Z,{type:"lightbulb-o"})," ",(0,h.jsxs)("strong",{children:[i("tip"),": "]}),(0,h.jsx)(c.cC,{i18nKey:"log_entry_maximum_entries_enable_stop_on_first_error",components:[(0,h.jsx)(j.Z,{bsSize:"xs",bsStyle:"info",onClick:m},"enable-stop-on-first-error"),(0,h.jsx)("a",{href:"https://www.overleaf.com/learn/latex/Questions/Tips_and_Tricks_for_Troubleshooting_LaTeX"},"learn-more")]})," "]}),(0,h.jsx)("p",{children:i("log_entry_maximum_entries_see_full_logs")})]}):(0,h.jsxs)("p",{children:[(0,h.jsx)(f.Z,{type:"lightbulb-o"})," ",(0,h.jsxs)("strong",{children:[i("tip"),": "]}),i("log_entry_maximum_entries_see_full_logs")]})})})]})}ce.propTypes={totalEntries:s().number,entriesShown:s().number,hasErrors:s().bool};var le=ce;function se(e){var t=e.entries,n=e.hasErrors,r=(0,c.$G)().t,o=(0,R.Im)().syncToEntry,i=t.slice(0,100);return(0,h.jsxs)(h.Fragment,{children:[t.length>100&&(0,h.jsx)(le,{totalEntries:t.length,entriesShown:100,hasErrors:n}),i.map((function(e,t){var n;return(0,h.jsx)(F,{index:t,id:e.key,logEntry:e,ruleId:e.ruleId,headerTitle:null!==(n=e.messageComponent)&&void 0!==n?n:e.message,rawContent:e.content,logType:e.type,level:e.level,contentDetails:e.contentDetails,entryAriaLabel:r("log_entry_description",{level:e.level}),sourceLocation:{file:e.file,line:e.line,column:e.column},onSourceLocationClick:o},e.key)}))]})}se.propTypes={entries:s().arrayOf(s().object),hasErrors:s().bool};var ue=(0,o.memo)(se),de=n(23357),fe=n(10163);function he(){var e=(0,c.$G)().t;return(0,h.jsx)("div",{className:"log-entry",children:(0,h.jsxs)("div",{className:"log-entry-header log-entry-header-error",children:[(0,h.jsx)("div",{className:"log-entry-header-icon-container",children:(0,h.jsx)(f.Z,{type:"exclamation-triangle",fw:!0})}),(0,h.jsx)("h3",{className:"log-entry-header-title",children:e("code_check_failed_explanation")})]})})}var pe=(0,o.memo)(he),me=n(16233);function ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ve(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ye(){var e=(0,R.Im)(),t=e.codeCheckFailed,n=e.error,r=e.hasShortCompileTimeout,o=e.logEntries,i=e.rawLog,l=e.validationIssues,s=e.showLogs,u=e.stoppedOnFirstError,d=(0,me.I)().loadingError,f=(0,c.$G)().t;return(0,h.jsx)("div",{className:a()("logs-pane",{hidden:!s&&!d}),children:(0,h.jsxs)("div",{className:"logs-pane-content",children:[t&&(0,h.jsx)(pe,{}),u&&(0,h.jsx)(N,{}),d&&(0,h.jsx)(H,{error:"pdf-viewer-loading-error"}),r&&"timedout"===n?(0,h.jsx)(z,{}):(0,h.jsx)(h.Fragment,{children:n&&(0,h.jsx)(H,{error:n})}),l&&Object.entries(l).map((function(e){var t=ge(e,2),n=t[0],r=t[1];return(0,h.jsx)(Z,{name:n,issue:r},n)})),(null==o?void 0:o.all)&&(0,h.jsx)(ue,{entries:o.all,hasErrors:o.errors.length>0}),i&&(0,h.jsx)(F,{headerTitle:f("raw_logs"),rawContent:i,entryAriaLabel:f("raw_logs_description"),level:"raw"}),(0,h.jsxs)("div",{className:"logs-pane-actions",children:[(0,h.jsx)(K,{}),(0,h.jsx)(ae,{})]})]})})}var _e=(0,de.Z)((0,o.memo)(ye),(function(){return(0,h.jsx)(fe.Z,{type:"logs"})})),be=(0,o.lazy)((function(){return Promise.all([n.e(2385),n.e(8404),n.e(5277)]).then(n.bind(n,68050))}));function we(){var e=(0,R.Im)(),t=e.pdfUrl,n=e.pdfFile,r=e.pdfViewer;return t?"native"===r?(0,h.jsx)("iframe",{title:"PDF Preview",src:t}):(0,h.jsx)(be,{url:t,pdfFile:n}):null}var ke=(0,o.memo)(we),xe=n(28500),je=n(56469),Te=n(39493),Se=["tooltip","icon"],Ie=["onClick","disabled","tooltip","bsStyle","children","className"];function Ce(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Ee(e){var t=e.bsStyle,n=e.bsSize,r=void 0===n?"md":n,o=e.button,i=e.dropdown,c=e.dropdownToggle,l=e.disabled,s=void 0!==l&&l,u=e.children,d=o.tooltip,p=o.icon,m=Ce(o,Se),g=a()("split-menu",{["btn-".concat(r)]:!0}),v=a()("split-menu-dropdown-toggle",null==c?void 0:c.className);return(0,h.jsxs)("div",{className:g,children:[(0,h.jsxs)(Oe,{onClick:m.onClick,className:m.className,disabled:s,tooltip:d,bsStyle:t,children:[p?(0,h.jsx)(f.Z,{className:"split-menu-icon",type:p.type,spin:p.spin}):null,(0,h.jsx)("span",{className:"split-menu-button",children:m.text})]}),(0,h.jsxs)(Q.Z,{className:a()("split-menu-dropdown",i.className),id:i.id,children:[(0,h.jsx)(Q.Z.Toggle,{"aria-label":null==c?void 0:c["aria-label"],className:v,bsStyle:t,onAnimationEnd:null==c?void 0:c.handleAnimationEnd,"data-ol-loading":s}),(0,h.jsx)(Q.Z.Menu,{children:u})]})]})}function Oe(e){var t=e.onClick,n=e.disabled,r=e.tooltip,o=e.bsStyle,i=e.children,c=e.className,l=Ce(e,Ie),s=a()("split-menu-button",c);return r?(0,h.jsx)(d.Z,{id:r.id,description:r.description,tooltipProps:r.tooltipProps,overlayProps:r.overlayProps,children:(0,h.jsx)(j.Z,{className:s,bsStyle:o,onClick:t,"aria-label":l["aria-label"],disabled:n,"data-ol-loading":n,children:i})}):(0,h.jsx)(j.Z,{className:s,bsStyle:o,onClick:t,"aria-label":l["aria-label"],disabled:n,"data-ol-loading":n,children:i})}Ee.Item=function(e){return(0,h.jsx)(ee.Z,{...e,draggable:"false"})};var Le=Ee,Ae=/Mac/i.test(navigator.platform)?"Cmd":"Ctrl";function Me(e,t,n){P.BZ("recompile-setting-changed",{setting:n,settingVal:e}),t(e)}function Pe(){var e=(0,R.Im)(),t=e.animateCompileDropdownArrow,n=e.autoCompile,r=e.compiling,o=e.draft,i=e.hasChanges,l=e.setAnimateCompileDropdownArrow,s=e.setAutoCompile,u=e.setDraft,d=e.setStopOnValidationError,p=e.stopOnFirstError,m=e.stopOnValidationError,g=e.startCompile,v=e.stopCompile,y=e.recompileFromScratch,_=useStopOnFirstError({eventSource:"dropdown"}),b=_.enableStopOnFirstError,w=_.disableStopOnFirstError,k=(0,c.$G)().t,x=r?"".concat(k("compiling"),"…"):k("recompile"),j=(0,h.jsxs)(h.Fragment,{children:[k("recompile_pdf")," ",(0,h.jsxs)("span",{className:"keyboard-shortcut",children:["(",Ae," + Enter)"]})]}),T=a()({"detach-compile-button-animate":t,"btn-striped-animated":i,"no-left-border":!0}),S=a()({"btn-striped-animated":i,"no-left-radius":!0});return(0,h.jsxs)(Le,{bsStyle:"primary",bsSize:"xs",disabled:r,button:{tooltip:{description:j,id:"compile",tooltipProps:{className:"keyboard-tooltip"},overlayProps:{delayShow:500}},icon:{type:"refresh",spin:r},onClick:function(){return g()},text:x,className:S},dropdownToggle:{"aria-label":k("toggle_compile_options_menu"),handleAnimationEnd:function(){return l(!1)},className:T},dropdown:{id:"pdf-recompile-dropdown"},children:[(0,h.jsx)(Le.Item,{header:!0,children:k("auto_compile")}),(0,h.jsxs)(Le.Item,{onSelect:function(){return Me(!0,s,"auto-compile")},children:[(0,h.jsx)(f.Z,{type:n?"check":"",fw:!0}),k("on")]}),(0,h.jsxs)(Le.Item,{onSelect:function(){return Me(!1,s,"auto-compile")},children:[(0,h.jsx)(f.Z,{type:n?"":"check",fw:!0}),k("off")]}),(0,h.jsx)(Le.Item,{header:!0,children:k("compile_mode")}),(0,h.jsxs)(Le.Item,{onSelect:function(){return Me(!1,u,"compile-mode")},children:[(0,h.jsx)(f.Z,{type:o?"":"check",fw:!0}),k("normal")]}),(0,h.jsxs)(Le.Item,{onSelect:function(){return Me(!0,u,"compile-mode")},children:[(0,h.jsx)(f.Z,{type:o?"check":"",fw:!0}),k("fast")," ",(0,h.jsx)("span",{className:"subdued",children:"[draft]"})]}),(0,h.jsx)(Le.Item,{header:!0,children:"Syntax Checks"}),(0,h.jsxs)(Le.Item,{onSelect:function(){return Me(!0,d,"syntax-check")},children:[(0,h.jsx)(f.Z,{type:m?"check":"",fw:!0}),k("stop_on_validation_error")]}),(0,h.jsxs)(Le.Item,{onSelect:function(){return Me(!1,d,"syntax-check")},children:[(0,h.jsx)(f.Z,{type:m?"":"check",fw:!0}),k("ignore_validation_errors")]}),(0,h.jsx)(Le.Item,{header:!0,children:k("compile_error_handling")}),(0,h.jsxs)(Le.Item,{onSelect:b,children:[(0,h.jsx)(f.Z,{type:p?"check":"",fw:!0}),k("stop_on_first_error")]}),(0,h.jsxs)(Le.Item,{onSelect:w,children:[(0,h.jsx)(f.Z,{type:p?"":"check",fw:!0}),k("try_to_compile_despite_errors")]}),(0,h.jsx)(Le.Item,{divider:!0}),(0,h.jsx)(Le.Item,{onSelect:function(){return v()},disabled:!r,"aria-disabled":!r,children:k("stop_compile")}),(0,h.jsx)(Le.Item,{onSelect:function(){P.BZ("recompile-setting-changed",{setting:"from-scratch"}),y()},disabled:r,"aria-disabled":r,children:k("recompile_from_scratch")})]})}var De=(0,o.memo)(Pe);var Fe=function(){var e=(0,Te.l5)(),t=e.pdfLayout,n=e.setView,r=e.detachRole,o=(0,c.$G)().t;return r||"sideBySide"===t?null:(0,h.jsxs)(j.Z,{bsStyle:null,bsSize:"xs",onClick:function(){n("editor")},className:"switch-to-editor-btn toolbar-btn-secondary btn-secondary",children:[(0,h.jsx)(f.Z,{type:"code",className:"toolbar-btn-secondary-icon"}),(0,h.jsx)("span",{className:"toolbar-btn-secondary-text",children:o("switch_to_editor")})]})},Xe=(n(71245),n(9945));function Ze(){var e,t,n=(0,R.Im)(),r=n.error,i=n.logEntries,a=n.toggleLogs,l=n.showLogs,s=n.stoppedOnFirstError,u=(0,c.$G)().t,p=(0,o.useCallback)((function(){l||P.BZ("logs-click"),a()}),[a,l]),m=Number(null==i||null===(e=i.errors)||void 0===e?void 0:e.length),g=m+Number(null==i||null===(t=i.warnings)||void 0===t?void 0:t.length);return(0,h.jsx)(d.Z,{id:"logs-toggle",description:u("logs_and_output_files"),overlayProps:{placement:"bottom"},children:(0,h.jsxs)(j.Z,{bsStyle:"link",disabled:Boolean(r||s),active:l,className:"pdf-toolbar-btn toolbar-item log-btn",onClick:p,style:{position:"relative"},"aria-label":u(l?"view_pdf":"view_logs"),children:[(0,h.jsx)(f.Z,{type:"file-text-o",fw:!0}),!l&&g>0&&(0,h.jsx)(Xe.Z,{bsStyle:0===m?"warning":"danger",children:g})]})})}var Re=(0,o.memo)(Ze);var Ue=function(){var e=(0,R.Im)().pdfDownloadUrl,t=(0,U.d)()._id,n=(0,c.$G)().t,r=n(e?"download_pdf":"please_compile_pdf_before_download");return(0,h.jsx)(d.Z,{id:"download-pdf",description:r,overlayProps:{placement:"bottom"},children:(0,h.jsx)(j.Z,{onClick:function(){P.BZ("download-pdf-button-click",{projectId:t,location:"pdf-preview",isSmallDevice:P.UJ})},bsStyle:"link",className:"pdf-toolbar-btn",draggable:"false",disabled:!e,download:!0,href:e||"#",target:"_blank",style:{pointerEvents:"auto"},"aria-label":n("download_pdf"),children:(0,h.jsx)(f.Z,{type:"download",fw:!0})})})};function Ne(){var e=(0,R.Im)(),t=e.codeCheckFailed,n=e.error,r=e.toggleLogs,i=(0,c.$G)().t,a=(0,o.useCallback)((function(){r()}),[r]);return t?(0,h.jsxs)(j.Z,{bsSize:"xsmall",bsStyle:"danger",disabled:Boolean(n),className:"btn-toggle-logs toolbar-item",onClick:a,children:[(0,h.jsx)(f.Z,{type:"exclamation-triangle"}),(0,h.jsx)("span",{className:"toolbar-text toolbar-hide-small",children:i("code_check_failed")})]}):null}var We=(0,o.memo)(Ne),$e=n(79862),Be=n(46267);function qe(){var e=(0,c.$G)().t,t=(0,Be.T)(),n=(0,o.useCallback)((function(){t.assign((0,$e.g)(null).toString())}),[t]);return(0,h.jsx)(j.Z,{onClick:n,className:"btn-orphan",bsStyle:"primary",bsSize:"small",children:e("redirect_to_editor")})}var Ve=(0,o.memo)(qe),ze=n(14185);function He(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ge(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Je(){var e=(0,Te.l5)(),t=e.detachRole,n=e.detachIsLinked,r=(0,o.useRef)(),i=He((0,o.useState)(!1),2),a=i[0],c=i[1],l=!n&&"detached"===t;(0,o.useEffect)((function(){r.current&&clearTimeout(r.current),l?r.current=setTimeout((function(){c(!0)}),5e3):c(!1)}),[l]);var s=null;return s=a?(0,h.jsx)(Ke,{}):l?(0,h.jsx)(Qe,{}):(0,h.jsx)(Ye,{}),(0,h.jsx)(je.Z,{className:"toolbar toolbar-pdf toolbar-pdf-hybrid",children:s})}function Ye(){var e=(0,$.ye)("pdf-controls");return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"toolbar-pdf-left",children:[(0,h.jsx)(De,{}),(0,h.jsx)(Re,{}),(0,h.jsx)(Ue,{})]}),(0,h.jsxs)("div",{className:"toolbar-pdf-right",children:[e&&(0,h.jsx)("div",{className:"toolbar-pdf-controls",id:"toolbar-pdf-controls"}),(0,h.jsx)(We,{}),(0,h.jsx)(Fe,{}),(0,h.jsx)(ze.yk,{})]})]})}function Ke(){var e=(0,c.$G)().t;return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"toolbar-pdf-orphan",children:[e("tab_no_longer_connected"),(0,h.jsx)(Ve,{})]})})}function Qe(){var e=(0,c.$G)().t;return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"toolbar-pdf-orphan",children:[(0,h.jsx)(f.Z,{type:"refresh",fw:!0,spin:!0}),e("tab_connecting"),"…"]})})}var et=(0,o.memo)(Je),tt=function(e){var t=e.children;return(0,h.jsx)("div",{className:"pdf-preview-messages",children:t})},nt=n(18977),rt=n(96480),ot=function(e){var t=e.handleDismissWarning,n=(0,c.$G)().t,r=(0,$.ye)("paywall-cta");return(0,h.jsx)(rt.Z,{action:(0,h.jsx)(W.Z,{variant:"new-10s",source:"compile-time-warning",buttonProps:{className:"btn-secondary-compile-timeout-override"},children:n(r?"get_more_compile_time":"start_free_trial_without_exclamation")}),ariaLive:"polite",content:(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{children:(0,h.jsx)("span",{children:n("your_project_near_compile_timeout_limit")})}),(0,h.jsx)("strong",{children:n("upgrade_for_12x_more_compile_time")}),". "]}),type:"warning",title:n("took_a_while"),isActionBelowContent:!0,isDismissible:!0,onDismiss:t})};function it(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return at(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return at(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ct(){var e=(0,R.Im)(),t=e.isProjectOwner,n=e.deliveryLatencies,r=e.compiling,i=e.showLogs,a=e.error,c=it((0,o.useState)(!1),2),l=c[0],s=c[1],u=it((0,nt.Z)("has-dismissed-10s-compile-time-warning-until"),2),d=u[0],f=u[1],p=(0,o.useCallback)((function(e){s(!1),e>1e4&&t&&(!d||new Date(d)<new Date)&&(s(!0),P.BZ("compile-time-warning-displayed",{time:10,isProjectOwner:t}))}),[t,d]),m=(0,o.useCallback)((function(){P.BZ("compile-time-warning-dismissed",{time:10,isProjectOwner:t}),s(!1);var e=new Date;e.setDate(e.getDate()+1),f(e)}),[t,f]);return(0,o.useEffect)((function(){r||a||i||p(n.compileTimeServerE2E)}),[r,a,i,n,p]),(0,y.Z)("ol-ExposedSettings").enableSubscriptions?r||a||i?null:l?(0,h.jsx)("div",{children:l&&t&&(0,h.jsx)(ot,{handleDismissWarning:m})}):null:null}var lt=(0,o.memo)(ct);function st(){var e=(0,R.Im)(),t=e.pdfUrl,n=e.hasShortCompileTimeout,r=a()("pdf","full-size",{"pdf-empty":!t});return(0,h.jsx)("div",{className:r,children:(0,h.jsxs)(me.a,{children:[(0,h.jsx)(et,{}),(0,h.jsx)(tt,{children:n&&(0,h.jsx)(lt,{})}),(0,h.jsx)(o.Suspense,{fallback:(0,h.jsx)(xe.w,{delay:500}),children:(0,h.jsx)("div",{className:"pdf-viewer",children:(0,h.jsx)(ke,{})})}),(0,h.jsx)(_e,{})]})})}var ut=(0,o.memo)(st);function dt(){return"detacher"===(0,Te.l5)().detachRole?null:(0,h.jsx)(ut,{})}var ft=(0,de.Z)((0,o.memo)(dt),(function(){return(0,h.jsx)(fe.Z,{type:"preview"})}))},79657:function(e,t,n){"use strict";n(77950),n(85940),n(17368),n(24471),n(51172),n(88233),n(58188),n(73439),n(21515),n(18178),n(15735),n(28673),n(6886),n(60523),n(28399),n(61657),n(34115),n(634),n(20796),n(32501),n(26936),n(27233),n(21850),n(71372);var r=n(12524),o=n.n(r),i=n(2784),a=n(13980),c=n.n(a),l=n(96931),s=n(72526),u=n(28684),d=n(39488),f=n(39493),h=n(37246),p=n(63584),m=n(24958),g=n(10280),v=n(75234),y=n(49169),_=n(30286),b=n(69565),w=n(83976),k=n(76066),x=n(47481),j=n(51294),T=n(96227),S=n(45177),I=n(97502),C=n(52322);function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L(e){var t=e.position,n=e.syncToCode,r=e.syncToCodeInFlight,i=e.isDetachLayout,a=(0,v.$G)().t,c=i?"bottom":"right",l=o()("synctex-control","btn-secondary",{"detach-synctex-control":!!i}),s=null;r?s=(0,C.jsx)(g.Z,{type:"refresh",spin:!0,className:"synctex-spin-icon"}):i||(s=(0,C.jsx)(g.Z,{type:"arrow-left",className:"synctex-control-icon"}));return(0,C.jsx)(m.Z,{id:"sync-to-code",description:a("go_to_pdf_location_in_code"),overlayProps:{placement:c},children:(0,C.jsxs)(p.Z,{bsStyle:null,bsSize:"xs",onClick:function(){T.BZ("jump-to-location",{direction:"pdf-location-in-code",method:"arrow"}),n(t,72)},disabled:r,className:l,"aria-label":a("go_to_pdf_location_in_code"),children:[s,i?(0,C.jsxs)("span",{children:[" ",a("show_in_code")]}):""]})})}function A(e){var t=e.cursorPosition,n=e.syncToPdf,r=e.syncToPdfInFlight,i=e.isDetachLayout,a=e.hasSingleSelectedDoc,c=(0,v.$G)().t,l=i?"bottom":"right",s=o()("synctex-control","btn-secondary","toolbar-btn-secondary",{"detach-synctex-control":!!i}),u=null;return r?u=(0,C.jsx)(g.Z,{type:"refresh",spin:!0,className:"synctex-spin-icon"}):i||(u=(0,C.jsx)(g.Z,{type:"arrow-right",className:"synctex-control-icon"})),(0,C.jsx)(m.Z,{id:"sync-to-pdf",description:c("go_to_code_location_in_pdf"),overlayProps:{placement:l},children:(0,C.jsxs)(p.Z,{bsStyle:null,bsSize:"xs",onClick:function(){return n(t)},disabled:r||!t||!a,className:s,"aria-label":c("go_to_code_location_in_pdf"),children:[u,i?(0,C.jsxs)("span",{children:[" ",c("show_in_pdf")]}):""]})})}function M(){var e=(0,l.IM)(),t=(0,s.d)(),n=t._id,r=t.rootDocId,o=(0,f.l5)().detachRole,a=(0,d.Im)(),c=a.clsiServerId,p=a.pdfUrl,m=a.pdfViewer,g=a.position,v=a.setShowLogs,O=a.setHighlights,M=(0,x.O)().selectedEntities,P=(0,I.Yt)(),D=P.findEntityByPath,F=P.dirname,X=P.pathInFolder,Z=(0,i.useState)((function(){var t=k.Z.getItem("doc.position.".concat(e.editorManager.getCurrentDocId()));return t?t.cursorPosition:null})),R=E(Z,2),U=R[0],N=R[1],W=(0,y.Z)(),$=(0,_.Z)().signal;(0,i.useEffect)((function(){var e=function(e){return N(e.detail)};return window.addEventListener("cursor:editor:update",e),function(){return window.removeEventListener("cursor:editor:update",e)}}),[e]);var B=E((0,i.useState)(!1),2),q=B[0],V=B[1],z=E((0,b.Z)("sync-to-code-inflight",!1,"detacher","detached"),2),H=z[0],G=z[1],J=E((0,h.Z)("sync_tex_error"),2)[1],Y=(0,i.useCallback)((function(){var t=e.editorManager.getCurrentDocId(),n=X(t),o=F(r);return o&&(n=n.replace(RegExp("^".concat(o)),"".concat(o,"/."))),n}),[F,e.editorManager,X,r]),K=(0,i.useCallback)((function(t,n){if(t){var r,o=null===(r=D(t))||void 0===r?void 0:r.entity;if(!o)return void S.c.warn("Document with path ".concat(t," not found"));e.editorManager.openDocId(o._id,{gotoLine:n})}else J(!0),window.setTimeout((function(){W.current&&J(!1)}),4e3)}),[D,e.editorManager,W,J]),Q=(0,i.useCallback)((function(e){V(!0),c&&(e+="&clsiserverid=".concat(c)),(0,u.xA)("/project/".concat(n,"/sync/code?").concat(e),{signal:$}).then((function(e){v(!1),O(e.pdf)})).catch(S.c.error).finally((function(){W.current&&V(!1)}))}),[c,W,n,v,O,V,$]),ee=(0,i.useCallback)((function(e){var t=new URLSearchParams({file:Y(),line:e.row+1,column:e.column}).toString();T.BZ("jump-to-location",{direction:"code-location-in-pdf",method:"arrow"}),Q(t)}),[Y,Q]),te=(0,i.useRef)(U);(0,i.useEffect)((function(){te.current=U}),[U]);var ne=(0,i.useCallback)((function(){ee(te.current)}),[ee]);(0,j.Z)("cursor:editor:syncToPdf",ne);var re=(0,i.useCallback)((function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;G(!0);var o=e.offset.left,i=0;null!==(t=e.pageSize)&&void 0!==t&&t.height?i+=e.pageSize.height-e.offset.top:i+=e.offset.top,i+=r;var a=new URLSearchParams({page:e.page+1,h:o.toFixed(2),v:i.toFixed(2)});c&&a.set("clsiserverid",c),(0,u.xA)("/project/".concat(n,"/sync/pdf?").concat(a),{signal:$}).then((function(e){var t=E(e.code,1)[0],n=t.file,r=t.line;K(n,r)})).catch(S.c.error).finally((function(){W.current&&G(!1)}))}),[c,n,$,W,G,K]),oe=(0,w.Z)("sync-to-code",re,"detached","detacher");(0,i.useEffect)((function(){var e=function(e){return oe(e.detail)};return window.addEventListener("synctex:sync-to-position",e),function(){window.removeEventListener("synctex:sync-to-position",e)}}),[oe]);var ie=E((0,b.Z)("has-single-selected-doc",!1,"detacher","detached"),2),ae=ie[0],ce=ie[1];return(0,i.useEffect)((function(){1===M.length&&"doc"===M[0].type?ce(!0):ce(!1)}),[M,ce]),g&&p&&"native"!==m?"detacher"===o?(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(A,{cursorPosition:U,syncToPdf:ee,syncToPdfInFlight:q,isDetachLayout:!0,hasSingleSelectedDoc:ae})}):"detached"===o?(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(L,{position:g,syncToCode:oe,syncToCodeInFlight:H,isDetachLayout:!0})}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(A,{cursorPosition:U,syncToPdf:ee,syncToPdfInFlight:q,hasSingleSelectedDoc:ae}),(0,C.jsx)(L,{position:g,syncToCode:oe,syncToCodeInFlight:H})]}):null}t.Z=(0,i.memo)(M),L.propTypes={isDetachLayout:c().bool,position:c().object.isRequired,syncToCode:c().func.isRequired,syncToCodeInFlight:c().bool.isRequired},A.propTypes={cursorPosition:c().object,isDetachLayout:c().bool,syncToPdf:c().func.isRequired,syncToPdfInFlight:c().bool.isRequired,hasSingleSelectedDoc:c().bool.isRequired}},17626:function(e,t,n){"use strict";n.d(t,{w:function(){return d},z:function(){return u}});n(6710);var r=n(72045),o=n(96227),i=n(24452),a=n(45177),c=9,l=(0,r.Z)(),s={viewerId:l};function u(){return s}function d(e,t,n){var r=e.timings,s=e.pdfCachingMinChunkSize,u={compileTimeClientE2E:t,compileTimeServerE2E:null==r?void 0:r.compileE2E},d=!0;return{deliveryLatencies:u,firstRenderDone:function(e){var t,r,f=e.latencyFetch,h=e.latencyRender,p=e.pdfCachingMetrics;d&&(d=!1,u.totalDeliveryTime=Math.ceil(performance.now()-n),u.latencyFetch=f,h&&(u.latencyRender=h),i.bO&&(t={pdfCachingMinChunkSize:s,...u,...p},r={version:c,...t,id:l},a.c.log("/event/compile-metrics",JSON.stringify(r)),(0,o.BZ)("compile-metrics-v6",r)))}}}},24452:function(e,t,n){"use strict";n.d(t,{PY:function(){return s},bO:function(){return h},kk:function(){return d},ns:function(){return f},yl:function(){return u}});n(58188);var r,o=n(66041),i=n(45177),a="undefined"!=typeof TextEncoder;a||i.c.warn("TextEncoder is not available. Disabling pdf-caching.");var c=Array.isArray(null===(r=navigator.userAgentData)||void 0===r?void 0:r.brands)&&navigator.userAgentData.brands.some((function(e){return"Opera"===e.brand}));function l(e){var t;return!!a&&(!c&&"enabled"===(null===(t=(0,o.Z)("ol-splitTestVariants"))||void 0===t?void 0:t[e]))}c&&i.c.warn("Browser cache is limited in Opera. Disabling pdf-caching.");var s=l("pdf-caching-cached-url-lookup"),u=l("pdf-caching-prefetching"),d=l("pdf-caching-prefetch-large"),f=l("pdf-caching-mode"),h=l("track-pdf-download")},55185:function(e,t,n){"use strict";var r=n(89551),o=n(52322);t.Z=function(e){var t=e.bs3,n=e.bs5;return(0,o.jsx)(o.Fragment,{children:r.k?n:t})}},95135:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});n(15735),n(79321),n(58188),n(28673),n(6886),n(34769),n(34115);var r=n(9362),o=n(610),i=n(12524),a=n.n(i),c=n(75234),l=n(34557),s=n(52322),u=["children","className","leadingIcon","isLoading","size","trailingIcon","variant"];function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var f=new Map([["small","btn-sm"],["default",""],["large","btn-lg"]]);function h(e){var t=e.children,n=e.className,i=e.leadingIcon,h=e.isLoading,p=void 0!==h&&h,m=e.size,g=void 0===m?"default":m,v=e.trailingIcon,y=e.variant,_=void 0===y?"primary":y,b=d(e,u),w=(0,c.$G)().t,k=f.get(g),x=a()("d-inline-grid",k,n,{"button-loading":p}),j="large"===g?"loading-spinner-large":"loading-spinner-small",T="large"===g?"icon-large":"icon-small";return(0,s.jsxs)(r.Z,{className:x,variant:_,...b,children:[p&&(0,s.jsxs)("span",{className:"spinner-container",children:[(0,s.jsx)(o.Z,{animation:"border","aria-hidden":"true",as:"span",className:j,role:"status"}),(0,s.jsx)("span",{className:"visually-hidden",children:w("loading")})]}),(0,s.jsxs)("span",{className:"button-content","aria-hidden":p,children:[i&&(0,s.jsx)(l.Z,{type:i,className:T}),t,v&&(0,s.jsx)(l.Z,{type:v,className:T})]})]})}},89551:function(e,t,n){"use strict";n.d(t,{J:function(){return o},k:function(){return r}});var r=5===(0,n(66041).Z)("ol-bootstrapVersion"),o=function(e){var t=e.bs5,n=e.bs3;return r?t:n}},56377:function(e,t,n){"use strict";n.d(t,{G:function(){return r},y:function(){return o}});n(15735),n(79321),n(58188),n(28673),n(6886);var r=new Map([["\\includegraphics",{name:"graphicx",command:"\\usepackage{graphicx}"}],["\\toprule",{name:"booktabs",command:"\\usepackage{booktabs}"}],["\\midrule",{name:"booktabs",command:"\\usepackage{booktabs}"}],["\\bottomrule",{name:"booktabs",command:"\\usepackage{booktabs}"}],["\\cmidrule",{name:"booktabs",command:"\\usepackage{booktabs}"}],["\\multirow",{name:"multirow",command:"\\usepackage{multirow}"}],["\\justifying",{name:"ragged2e",command:"\\usepackage{ragged2e}"}],["\\tag",{name:"amsmath",command:"\\usepackage{amsmath}"}],["\\notag",{name:"amsmath",command:"\\usepackage{amsmath}"}],["\\text",{name:"amsmath",command:"\\usepackage{amsmath}"}],["\\boldsymbol",{name:"amsmath",command:"\\usepackage{amsmath}"}],["\\eqref",{name:"amsmath",command:"\\usepackage{amsmath}"}],["\\iint",{name:"amsmath",command:"\\usepackage{amsmath}"}],["\\iiint",{name:"amsmath",command:"\\usepackage{amsmath}"}],["\\nmid",{name:"amssymb",command:"\\usepackage{amssymb}"}],["\\varnothing",{name:"amssymb",command:"\\usepackage{amssymb}"}],["\\Box",{name:"amssymb",command:"\\usepackage{amssymb}"}],["\\citep",{name:"natbib",command:"\\usepackage{natbib}"}],["\\citet",{name:"natbib",command:"\\usepackage{natbib}"}],["\\citepalias",{name:"natbib",command:"\\usepackage{natbib}"}],["\\citetalias",{name:"natbib",command:"\\usepackage{natbib}"}],["\\url",{name:"url",command:"\\usepackage{url}"}],["\\href",{name:"hyperref",command:"\\usepackage{hyperref}"}],["\\texorpdfstring",{name:"hyperref",command:"\\usepackage{hyperref}"}],["\\phantomsection",{name:"hyperref",command:"\\usepackage{hyperref}"}],["\\arraybackslash",{name:"array",command:"\\usepackage{array}"}]]),o=new Map([["justify",{name:"ragged2e",command:"\\usepackage{ragged2e}"}],["align",{name:"amsmath",command:"\\usepackage{amsmath}"}],["align*",{name:"amsmath",command:"\\usepackage{amsmath}"}],["split",{name:"amsmath",command:"\\usepackage{amsmath}"}],["gather",{name:"amsmath",command:"\\usepackage{amsmath}"}],["cases",{name:"amsmath",command:"\\usepackage{amsmath}"}],["matrix",{name:"amsmath",command:"\\usepackage{amsmath}"}],["pmatrix",{name:"amsmath",command:"\\usepackage{amsmath}"}],["bmatrix",{name:"amsmath",command:"\\usepackage{amsmath}"}],["subequations",{name:"amsmath",command:"\\usepackage{amsmath}"}]])},96227:function(e,t,n){"use strict";n.d(t,{BZ:function(){return s},Cq:function(){return h},UJ:function(){return p},lW:function(){return l},mP:function(){return d},xQ:function(){return u}});n(39529),n(15735),n(58188),n(93244),n(28673),n(6886),n(6710);var r=n(93782),o=n(66041),i="mbEvents";function a(e){return!!(r.Z.getItem(i)||{})[e]}function c(e){var t=r.Z.getItem(i)||{};t[e]=!0,r.Z.setItem(i,t)}function l(e,t,n,r){"function"==typeof window.ga&&window.ga("send","event",e,t,n,r)}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.page||(t.page=window.location.pathname),function(e,t){if(!navigator||!navigator.sendBeacon)return;if(!(0,o.Z)("ol-ExposedSettings").isOverleaf)return;t._csrf=(0,o.Z)("ol-csrfToken");var n=new Blob([JSON.stringify(t)],{type:"application/json; charset=UTF-8"});try{navigator.sendBeacon("/event/".concat(e),n)}catch(e){}}(e,t),"function"==typeof window.gtag&&["paywall-click","paywall-prompt","plans-page-click"].includes(e)&&window.gtag("event",e,t)}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(e)||(s(e,t),c(e))}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;Math.random()<n&&s(e,t)}var f=new Set;function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f.has(e)||(s(e,t),f.add(e))}var p=window.screen.width<768},76066:function(e,t,n){"use strict";n(34769),n(6710);var r=n(45177),o=function(e,t,n){try{return e(t,n)}catch(e){return r.c.error("localStorage exception",e),null}},i=function(e){return JSON.parse(localStorage.getItem(e))},a=function(e,t){localStorage.setItem(e,JSON.stringify(t))},c=function(){localStorage.clear()},l=function(e){return localStorage.removeItem(e)},s={getItem:function(e){return o(i,e)},setItem:function(e,t){return o(a,e,t)},clear:function(){return o(c)},removeItem:function(e){return o(l,e)}};t.Z=s},93782:function(e,t,n){"use strict";n(34769),n(6710);var r=n(45177),o=function(e,t,n){try{return e(t,n)}catch(e){return r.c.error("sessionStorage exception",e),null}},i=function(e){return JSON.parse(sessionStorage.getItem(e))},a=function(e,t){sessionStorage.setItem(e,JSON.stringify(t))},c=function(){sessionStorage.clear()},l=function(e){return sessionStorage.removeItem(e)},s={getItem:function(e){return o(i,e)},setItem:function(e,t){return o(a,e,t)},clear:function(){return o(c)},removeItem:function(e){return o(l,e)}};t.Z=s},79477:function(e,t,n){"use strict";n(17368),n(24471),n(77950),n(51172),n(88233),n(16781),n(21850);var r=n(66041);t.Z=function(e){return new RegExp("\\.(".concat((0,r.Z)("ol-ExposedSettings").validRootDocExtensions.join("|"),")$"),"i").test(e)}},11685:function(e,t,n){"use strict";var r=n(2784),o=n(17631),i=n(52322);t.Z=function(e){var t=(0,r.useCallback)((function(t){var n,r=null==t||null===(n=t._modal)||void 0===n?void 0:n.modalNode;r&&(e.show?(r.removeAttribute("role"),r.removeAttribute("aria-hidden")):r.setAttribute("aria-hidden","true"))}),[e.show]);return(0,i.jsx)(o.Z,{...e,ref:t})}},15300:function(e,t,n){"use strict";n(34769),n(34115),n(43450);var r=n(2784),o=n(82752),i=n(47417),a=n(52322),c=["defaultOpen","onMainButtonClick"],l=["onClick"];function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}t.Z=function(e){var t=e.defaultOpen,n=e.onMainButtonClick,u=s(e,c),d=(0,i.Z)(Boolean(t)),f=d.onClick,h=s(d,l),p=(0,r.useCallback)((function(e){f(e),n&&n(h.open)}),[f,n,h.open]);return(0,a.jsx)(o.Z,{...u,...h,onClick:p,children:r.Children.map(u.children,(function(e){return(0,r.isValidElement)(e)?"open"in e.props?(0,r.cloneElement)(e,{open:h.open}):"show"in e.props?(0,r.cloneElement)(e,{show:h.open}):(0,r.cloneElement)(e):e}))})}},48755:function(e,t,n){"use strict";n.d(t,{l:function(){return a}});var r=n(86186),o=n(61179),i=n(52322),a=function(e){var t=e.children,n=e.modal;return(0,i.jsxs)("div",{className:"error-boundary-alert",children:[(0,i.jsx)(r.Z,{bsStyle:"danger",children:t||(0,i.jsx)(o.O,{})}),n]})}},34557:function(e,t,n){"use strict";n(34769),n(34115);var r=n(12524),o=n.n(r),i=(n(2784),n(52322)),a=["type","className","accessibilityLabel"];function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}t.Z=function(e){var t=e.type,n=e.className,r=e.accessibilityLabel,l=c(e,a),s=o()("material-symbols",n);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:s,"aria-hidden":"true",...l,children:t}),r&&(0,i.jsx)("span",{className:"sr-only",children:r})]})}},96480:function(e,t,n){"use strict";n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372);var r=n(12524),o=n.n(r),i=n(2784),a=n(75234),c=n(34557),l=n(52322);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e){var t=e.notificationType,n=e.customIcon,r=(0,l.jsx)(c.Z,{type:"info"});return n?r=n:"success"===t?r=(0,l.jsx)(c.Z,{type:"check_circle"}):"warning"===t?r=(0,l.jsx)(c.Z,{type:"warning"}):"error"===t?r=(0,l.jsx)(c.Z,{type:"error"}):"offer"===t&&(r=(0,l.jsx)(c.Z,{type:"campaign"})),(0,l.jsx)("div",{className:"notification-icon",children:r})}t.Z=function(e){var t=e.action,n=e.ariaLive,r=e.className,u=void 0===r?"":r,f=e.content,h=e.customIcon,p=e.disclaimer,m=e.isActionBelowContent,g=e.isDismissible,v=e.onDismiss,y=e.title,_=e.type,b=e.id;_=_||"info";var w=(0,a.$G)().t,k=s((0,i.useState)(!0),2),x=k[0],j=k[1],T=o()("notification","notification-type-".concat(_),m?"notification-cta-below-content":"",u);return x?(0,l.jsxs)("div",{className:T,"aria-live":n||"off",role:"alert",id:b,children:[null!==h&&(0,l.jsx)(d,{notificationType:_,customIcon:h}),(0,l.jsxs)("div",{className:"notification-content-and-cta",children:[(0,l.jsxs)("div",{className:"notification-content",children:[y&&(0,l.jsx)("p",{children:(0,l.jsx)("b",{children:y})}),f]}),t&&(0,l.jsx)("div",{className:"notification-cta",children:t}),p&&(0,l.jsx)("div",{className:"notification-disclaimer",children:p})]}),g&&(0,l.jsx)("div",{className:"notification-close-btn",children:(0,l.jsx)("button",{"aria-label":w("close"),onClick:function(){j(!1),v&&v()},children:(0,l.jsx)(c.Z,{type:"close"})})})]}):null}},92910:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(2784),o=n(75234),i=n(45643),a=n(96227),c=n(6754),l=n(52322);function s(e){var t=e.buttonProps,n=void 0===t?{variant:"secondary"}:t,s=e.children,u=e.handleClick,d=e.source,f=e.variant,h=(0,o.$G)().t;(0,r.useEffect)((function(){var e={"paywall-type":d};f&&(e.variant=f),a.BZ("paywall-prompt",e)}),[d,f]);var p=(0,r.useCallback)((function(e){e.preventDefault(),u&&u(e),(0,i.Vs)(d,null,null,f)}),[u,d,f]);return(0,l.jsx)(c.ZP,{...n,onClick:p,children:s||h("start_free_trial")})}},24958:function(e,t,n){"use strict";n(34115),n(634);var r=n(2784),o=n(185),i=n(42042),a=n(8846),c=n(52322);t.Z=function(e){var t=e.id,n=e.description,l=e.children,s=e.tooltipProps,u=e.overlayProps,d=e.hidden;return(0,c.jsx)(o.Z,{overlay:(0,c.jsx)(i.Z,{id:"".concat(t,"-tooltip"),...s,style:{display:d?"none":"block"},children:n}),...u,placement:(null==u?void 0:u.placement)||"top",children:(0,r.cloneElement)(l,{onClick:(0,a.w)(l.props.onClick,(function(e){e.currentTarget instanceof HTMLElement&&e.currentTarget.blur()}))})})}},39488:function(e,t,n){"use strict";n.d(t,{in:function(){return g},Im:function(){return v}});n(71372),n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850);var r=n(2784),o=n(87828),i=n(69565);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=function(e,t,n,o){var c=a((0,i.Z)(e,t,n,o),2),l=c[0],s=c[1];return(0,r.useEffect)((function(){s(t)}),[s,t]),[l,s]},s=n(83976),u=n(78237),d=n(39493),f=n(52322);function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=(0,r.createContext)(void 0),g=function(e){var t=e.children,n=(0,o.A3)();if(!n)throw new Error("DetachCompileProvider is only available inside LocalCompileProvider");var i=n.animateCompileDropdownArrow,a=n.autoCompile,c=n.clearingCache,p=n.clsiServerId,g=n.codeCheckFailed,v=n.compiling,y=n.deliveryLatencies,_=n.draft,b=n.editedSinceCompileStarted,w=n.error,k=n.fileList,x=n.hasChanges,j=n.hasShortCompileTimeout,T=n.highlights,S=n.isProjectOwner,I=n.lastCompileOptions,C=n.logEntries,E=n.logEntryAnnotations,O=n.pdfFile,L=n.pdfViewer,A=n.position,M=n.rawLog,P=n.setAnimateCompileDropdownArrow,D=n.setAutoCompile,F=n.setDraft,X=n.setError,Z=n.setHasLintingError,R=n.setHighlights,U=n.setPosition,N=n.setShowCompileTimeWarning,W=n.setShowLogs,$=n.toggleLogs,B=n.setStopOnFirstError,q=n.setStopOnValidationError,V=n.showLogs,z=n.showCompileTimeWarning,H=n.stopOnFirstError,G=n.stopOnValidationError,J=n.stoppedOnFirstError,Y=n.uncompiled,K=n.validationIssues,Q=n.firstRenderDone,ee=n.cleanupCompileResult,te=n.recompileFromScratch,ne=n.setCompiling,re=n.startCompile,oe=n.stopCompile,ie=n.setChangedAt,ae=n.clearCache,ce=n.syncToEntry,le=n.recordAction,se=h(l("animateCompileDropdownArrow",i,"detacher","detached"),1)[0],ue=h(l("autoCompile",a,"detacher","detached"),1)[0],de=h(l("clearingCache",c,"detacher","detached"),1)[0],fe=h(l("clsiServerId",p,"detacher","detached"),1)[0],he=h(l("codeCheckFailed",g,"detacher","detached"),1)[0],pe=h(l("compiling",v,"detacher","detached"),1)[0],me=h(l("deliveryLatencies",y,"detacher","detached"),1)[0],ge=h(l("draft",_,"detacher","detached"),1)[0],ve=h(l("error",w,"detacher","detached"),1)[0],ye=h(l("fileList",k,"detacher","detached"),1)[0],_e=h(l("hasChanges",x,"detacher","detached"),1)[0],be=h(l("hasShortCompileTimeout",j,"detacher","detached"),1)[0],we=h(l("highlights",T,"detacher","detached"),1)[0],ke=h(l("isProjectOwner",S,"detacher","detached"),1)[0],xe=h(l("lastCompileOptions",I,"detacher","detached"),1)[0],je=h(l("logEntries",C,"detacher","detached"),1)[0],Te=h(l("logEntryAnnotations",E,"detacher","detached"),1)[0],Se=h(l("pdfFile",O,"detacher","detached"),1)[0],Ie=h(l("pdfViewer",L,"detacher","detached"),1)[0],Ce=h(l("position",A,"detacher","detached"),1)[0],Ee=h(l("rawLog",M,"detacher","detached"),1)[0],Oe=h(l("showCompileTimeWarning",z,"detacher","detached"),1)[0],Le=h(l("showLogs",V,"detacher","detached"),1)[0],Ae=h(l("stopOnFirstError",H,"detacher","detached"),1)[0],Me=h(l("stopOnValidationError",G,"detacher","detached"),1)[0],Pe=h(l("stoppedOnFirstError",J,"detacher","detached"),1)[0],De=h(l("uncompiled",Y,"detacher","detached"),1)[0],Fe=h(l("editedSinceCompileStarted",b,"detacher","detached"),1)[0],Xe=h(l("validationIssues",K,"detacher","detached"),1)[0],Ze=(0,s.Z)("setAnimateCompileDropdownArrow",P,"detached","detacher"),Re=(0,s.Z)("setAutoCompile",D,"detached","detacher"),Ue=(0,s.Z)("setDraft",F,"detached","detacher"),Ne=(0,s.Z)("setError",X,"detacher","detached"),We=(0,s.Z)("setPosition",U,"detached","detacher"),$e=(0,s.Z)("firstRenderDone",Q,"detached","detacher"),Be=(0,s.Z)("setHasLintingError",Z,"detacher","detached"),qe=(0,s.Z)("setHighlights",R,"detacher","detached"),Ve=(0,s.Z)("setShowCompileTimeWarning",N,"detached","detacher"),ze=(0,s.Z)("setShowLogs",W,"detached","detacher"),He=(0,s.Z)("toggleLogs",$,"detached","detacher"),Ge=(0,s.Z)("setStopOnFirstError",B,"detached","detacher"),Je=(0,s.Z)("setStopOnValidationError",q,"detached","detacher"),Ye=(0,s.Z)("cleanupCompileResult",ee,"detached","detacher"),Ke=(0,s.Z)("recompileFromScratch",te,"detached","detacher"),Qe=(0,s.Z)("setCompiling",ne,"detacher","detached"),et=(0,s.Z)("startCompile",re,"detached","detacher"),tt=(0,s.Z)("stopCompile",oe,"detached","detacher"),nt=(0,s.Z)("setChangedAt",ie,"detached","detacher"),rt=(0,s.Z)("clearCache",ae,"detached","detacher"),ot=(0,s.Z)("sync-to-entry",ce,"detached","detacher"),it=(0,s.Z)("record-action",le,"detached","detacher");(0,u.Z)(et,nt),function(e){var t=(0,d.l5)(),n=t.pdfLayout,o=t.setView;(0,r.useEffect)((function(){var t=function(t){var r=t.detail,i=r.id,a=r.suggestFix;e(!0),"flat"===n&&o("pdf"),window.setTimeout((function(){var e,t=document.querySelector('.log-entry[data-log-entry-id="'.concat(i,'"]'));t&&(t.scrollIntoView({block:"start",inline:"nearest"}),a&&(null===(e=t.querySelector('button[data-action="suggest-fix"]'))||void 0===e||e.click()))}))};return window.addEventListener("editor:view-compile-log-entry",t),function(){window.removeEventListener("editor:view-compile-log-entry",t)}}),[n,o,e])}(ze);var at=(0,r.useMemo)((function(){return{animateCompileDropdownArrow:se,autoCompile:ue,clearCache:rt,clearingCache:de,clsiServerId:fe,codeCheckFailed:he,compiling:pe,deliveryLatencies:me,draft:ge,editedSinceCompileStarted:Fe,error:ve,fileList:ye,hasChanges:_e,hasShortCompileTimeout:be,highlights:we,isProjectOwner:ke,lastCompileOptions:xe,logEntryAnnotations:Te,logEntries:je,pdfDownloadUrl:null==Se?void 0:Se.pdfDownloadUrl,pdfFile:Se,pdfUrl:null==Se?void 0:Se.pdfUrl,pdfViewer:Ie,position:Ce,rawLog:Ee,recompileFromScratch:Ke,setAnimateCompileDropdownArrow:Ze,setAutoCompile:Re,setCompiling:Qe,setDraft:Ue,setError:Ne,setHasLintingError:Be,setHighlights:qe,setPosition:We,setShowCompileTimeWarning:Ve,setShowLogs:ze,toggleLogs:He,setStopOnFirstError:Ge,setStopOnValidationError:Je,showLogs:Le,showCompileTimeWarning:Oe,startCompile:et,stopCompile:tt,stopOnFirstError:Ae,stopOnValidationError:Me,stoppedOnFirstError:Pe,uncompiled:De,validationIssues:Xe,firstRenderDone:$e,setChangedAt:nt,cleanupCompileResult:Ye,syncToEntry:ot,recordAction:it}}),[se,ue,rt,de,fe,he,pe,me,ge,Fe,ve,ye,_e,be,we,ke,xe,Te,je,Se,Ie,Ce,Ee,Ke,Ze,Re,Qe,Ue,Ne,Be,qe,We,Ve,ze,He,Ge,Je,Oe,Le,et,tt,Ae,Me,Pe,De,Xe,$e,nt,Ye,ot,it]);return(0,f.jsx)(m.Provider,{value:at,children:t})};function v(){var e=(0,r.useContext)(m);if(!e)throw new Error("useDetachCompileContext is ony available inside DetachCompileProvider");return e}},99834:function(e,t,n){"use strict";n.d(t,{dn:function(){return m},JY:function(){return g}});n(58188),n(88233),n(71372),n(34115),n(634),n(20796),n(15735),n(28673),n(6886),n(32501),n(26936),n(27233),n(77950),n(21850);var r=n(2784),o=n(66041),i=n(79862);n(93244);var a=n(45177),c=n(52322);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=(0,r.createContext)(void 0),d=(0,o.Z)("ol-debugPdfDetach"),f=(0,o.Z)("ol-project_id"),h="detach-".concat(f),p="BroadcastChannel"in window?new BroadcastChannel(h):void 0,m=function(e){var t,n,s,f,h=e.children,m=l((0,r.useState)(),2),g=m[0],v=m[1],y=l((0,r.useState)((function(){return(0,o.Z)("ol-detachRole")||null})),2),_=y[0],b=y[1],w=(t=(0,r.useRef)(new Set),n=(0,r.useCallback)((function(e){t.current.add(e)}),[]),s=(0,r.useCallback)((function(e){t.current.delete(e)}),[]),f=(0,r.useCallback)((function(){for(var e of t.current)e.apply(void 0,arguments)}),[]),{addHandler:n,deleteHandler:s,callHandlers:f}),k=w.addHandler,x=w.deleteHandler,j=w.callHandlers;(0,r.useEffect)((function(){d&&a.c.warn("Effect",{role:_}),window.history.replaceState({},"",(0,i.g)(_).toString())}),[_]),(0,r.useEffect)((function(){if(p){var e=function(e){d&&a.c.warn("Receiving:",e.data),j(e.data)};return p.addEventListener("message",e),function(){p.removeEventListener("message",e)}}}),[j]);var T=(0,r.useCallback)((function(e,t){if(_){d&&a.c.warn("Broadcasting",{role:_,event:e,data:t});var n={role:_,event:e};t&&(n.data=t),null==p||p.postMessage(n)}else d&&a.c.warn("Not Broadcasting (no role)",{role:_,event:e,data:t})}),[_]);(0,r.useEffect)((function(){T("connected")}),[T]),(0,r.useEffect)((function(){var e=function(){return T("closed")};return window.addEventListener("beforeunload",e),function(){return window.removeEventListener("beforeunload",e)}}),[T]),(0,r.useEffect)((function(){var e=function(e){"detached"===e.role&&"connected"===e.event&&v(new Date)};return k(e),function(){return x(e)}}),[k,x]);var S=(0,r.useMemo)((function(){return{role:_,setRole:b,broadcastEvent:T,lastDetachedConnectedAt:g,addEventHandler:k,deleteEventHandler:x}}),[_,b,T,g,k,x]);return(0,c.jsx)(u.Provider,{value:S,children:h})};function g(){var e=(0,r.useContext)(u);if(!e)throw new Error("useDetachContext is only available inside DetachProvider");return e}},96931:function(e,t,n){"use strict";n.d(t,{IM:function(){return c},Pk:function(){return a}});n(71372);var r=n(2784),o=n(52322),i=(0,r.createContext)(void 0),a=function(e){var t=e.ide,n=e.scopeStore,a=e.scopeEventEmitter,c=e.children;(0,r.useEffect)((function(){var e;window.overleaf={...window.overleaf,unstable:{...null===(e=window.overleaf)||void 0===e?void 0:e.unstable,store:n}}}),[n]);var l=(0,r.useMemo)((function(){return{...t,scopeStore:n,scopeEventEmitter:a}}),[t,n,a]);return(0,o.jsx)(i.Provider,{value:l,children:c})};function c(){var e=(0,r.useContext)(i);if(!e)throw new Error("useIdeContext is only available inside IdeProvider");return e}},87828:function(e,t,n){"use strict";n.d(t,{gy:function(){return Le},A3:function(){return Ae}});n(15735),n(79321),n(58188),n(28673),n(6886),n(39529),n(73439),n(21515),n(71372),n(34115),n(634),n(20796),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850);var r=n(2784),o=n(37246),i=n(32967),a=n(18977),c=n(30286),l=(n(60523),n(28399),n(94908),n(18178),n(9575),n(96264),n(71245),/^[^%]*\\documentclass/),s=n(66041),u=n(28684),d=n(76635),f=n(17626),h=n(24452),p=n(45177);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==m(t)?t:String(t)}var y=new URLSearchParams(window.location.search),_=function(){function e(t){var n=this,r=t.compilingRef,o=t.projectId,i=t.setChangedAt,a=t.setCompiling,c=t.setData,l=t.setFirstRenderDone,s=t.setDeliveryLatencies,u=t.setError,f=t.cleanupCompileResult,h=t.signal;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.compilingRef=r,this.projectId=o,this.setChangedAt=i,this.setCompiling=a,this.setData=c,this.setFirstRenderDone=l,this.setDeliveryLatencies=s,this.setError=u,this.cleanupCompileResult=f,this.signal=h,this.projectRootDocId=null,this.clsiServerId=null,this.currentDoc=null,this.error=void 0,this.timer=0,this.defaultOptions={draft:!1,stopOnFirstError:!1},this.debouncedAutoCompile=(0,d.debounce)((function(){n.compile({isAutoCompileOnChange:!0})}),2500,{maxWait:5e3}),this._onDocSavedCallback=null}var t,n,r;return t=e,n=[{key:"_awaitBufferedOps",value:async function(){var e=this,t=function(){clearTimeout(e.pendingOpTimeout),e._onDocSavedCallback&&(window.removeEventListener("doc:saved",e._onDocSavedCallback),e._onDocSavedCallback=null)};return t(),new Promise((function(n){var r,o;if(null===(r=e.currentDoc)||void 0===r||null===(o=r.hasBufferedOps)||void 0===o||!o.call(r))return n();e._onDocSavedCallback=function(){t(),n()},clearTimeout(e.pendingOpTimeout),e.pendingOpTimeout=setTimeout((function(){t(),n()}),1e4),window.addEventListener("doc:saved",e._onDocSavedCallback),window.dispatchEvent(new CustomEvent("flush-changes"))}))}},{key:"compile",value:async function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!(e={...this.defaultOptions,...e}).isAutoCompileOnLoad||!(0,s.Z)("ol-preventCompileOnLoad")){var t=this.compilingRef.current;if(this.setCompiling(!0),t)e.isAutoCompileOnChange&&this.debouncedAutoCompile();else try{await this._awaitBufferedOps(),this.setChangedAt(0),this.validationIssues=void 0;var n=this.buildCompileParams(e),r=performance.now(),o=this.getRootDocOverrideId(),i={rootDoc_id:o,draft:e.draft,check:"silent",incrementalCompilesEnabled:!this.error,stopOnFirstError:e.stopOnFirstError},a=await(0,u.ty)("/project/".concat(this.projectId,"/compile?").concat(n),{body:i,signal:this.signal}),c=Math.ceil(performance.now()-r),l=(0,f.w)(a,c,r),d=l.deliveryLatencies,h=l.firstRenderDone;this.setDeliveryLatencies((function(){return d})),this.setFirstRenderDone((function(){return h})),this.setError(void 0),a.options=e,a.rootDocId=o,a.clsiServerId&&(this.clsiServerId=a.clsiServerId),this.setData(a)}catch(e){var m;p.c.error(e),this.cleanupCompileResult(),this.setError(429===(null===(m=e.info)||void 0===m?void 0:m.statusCode)?"rate-limited":"error")}finally{this.setCompiling(!1)}}}},{key:"getRootDocOverrideId",value:function(){if(this.currentDoc.doc_id!==this.projectRootDocId){var e=this.currentDoc.getSnapshot();if(e&&e.split("\n").some((function(e){return l.test(e)})))return this.currentDoc.doc_id}return null}},{key:"buildPostCompileParams",value:function(){var e=new URLSearchParams;return this.clsiServerId&&e.set("clsiserverid",this.clsiServerId),e}},{key:"buildCompileParams",value:function(e){var t=new URLSearchParams;return(e.isAutoCompileOnLoad||e.isAutoCompileOnChange)&&t.set("auto_compile","true"),h.ns&&t.set("enable_pdf_caching","true"),"true"===y.get("file_line_errors")&&(t.file_line_errors="true"),t}},{key:"stopCompile",value:function(){var e=this,t=this.buildPostCompileParams();return(0,u.ty)("/project/".concat(this.projectId,"/compile/stop?").concat(t),{signal:this.signal}).catch((function(t){p.c.error(t),e.setError("error")})).finally((function(){e.setCompiling(!1)}))}},{key:"clearCache",value:function(){var e=this,t=this.buildPostCompileParams();return(0,u.K$)("/project/".concat(this.projectId,"/output?").concat(t),{signal:this.signal}).catch((function(t){p.c.error(t),e.setError("clear-cache")}))}},{key:"setOption",value:function(e,t){this.defaultOptions[e]=t}}],n&&g(t.prototype,n),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),b=n(96227);n(95342),n(96708),n(35883),n(85940),n(49228),n(74069),n(16781),n(17368),n(24471),n(51172),n(93244),n(1939);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T(r.key),r)}}function j(e,t,n){return t&&x(e.prototype,t),n&&x(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function T(e){var t=function(e,t){if("object"!=w(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==w(t)?t:String(t)}var S=/^LaTeX(?:3| Font)? Warning: (.*)$/,I=/^(Over|Under)full \\(v|h)box/,C=/^((?:Package|Class|Module) \b.+\b Warning:.*)$/,E=/lines? ([0-9]+)/,O=/^(?:Package|Class|Module) (\b.+\b) Warning/,L=/^([./].*):(\d+): (.*)/,A=0,M=1,P=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k(this,e),this.state=A,this.fileBaseNames=n.fileBaseNames||[/compiles/,/\/usr\/local/],this.ignoreDuplicates=n.ignoreDuplicates,this.data=[],this.fileStack=[],this.currentFileList=this.rootFileList=[],this.openParens=0,this.latexWarningRegex=S,this.packageWarningRegex=C,this.packageRegex=O,this.log=new D(t)}return j(e,[{key:"parse",value:function(){for(;!1!==(this.currentLine=this.log.nextLine());)if(this.state===A&&(this.currentLineIsError()?(this.state=M,this.currentError={line:null,file:this.currentFilePath,level:"error",message:this.currentLine.slice(2),content:"",raw:this.currentLine+"\n"}):this.currentLineIsFileLineError()?(this.state=M,this.parseFileLineError()):this.currentLineIsRunawayArgument()?this.parseRunawayArgumentError():this.currentLineIsWarning()?this.parseSingleWarningLine(this.latexWarningRegex):this.currentLineIsHboxWarning()?this.parseHboxLine():this.currentLineIsPackageWarning()?this.parseMultipleWarningLine():this.parseParensForFilenames()),this.state===M){this.currentError.content+=this.log.linesUpToNextMatchingLine(/^l\.[0-9]+/).join("\n"),this.currentError.content+="\n",this.currentError.content+=this.log.linesUpToNextWhitespaceLine(!0).join("\n"),this.currentError.content+="\n",this.currentError.content+=this.log.linesUpToNextWhitespaceLine(!0).join("\n"),this.currentError.raw+=this.currentError.content;var e=this.currentError.raw.match(/l\.([0-9]+)/);e&&null===this.currentError.line&&(this.currentError.line=parseInt(e[1],10)),this.data.push(this.currentError),this.state=A}return this.postProcess(this.data)}},{key:"currentLineIsError",value:function currentLineIsError(){return"!"===this.currentLine[0]&&"!  ==> Fatal error occurred, no output PDF file produced!"!==this.currentLine}},{key:"currentLineIsFileLineError",value:function currentLineIsFileLineError(){return L.test(this.currentLine)}},{key:"currentLineIsRunawayArgument",value:function(){return this.currentLine.match(/^Runaway argument/)}},{key:"currentLineIsWarning",value:function(){return!!this.currentLine.match(this.latexWarningRegex)}},{key:"currentLineIsPackageWarning",value:function(){return!!this.currentLine.match(this.packageWarningRegex)}},{key:"currentLineIsHboxWarning",value:function(){return!!this.currentLine.match(I)}},{key:"parseFileLineError",value:function parseFileLineError(){var e=this.currentLine.match(L);this.currentError={line:e[2],file:e[1],level:"error",message:e[3],content:"",raw:this.currentLine+"\n"}}},{key:"parseRunawayArgumentError",value:function parseRunawayArgumentError(){this.currentError={line:null,file:this.currentFilePath,level:"error",message:this.currentLine,content:"",raw:this.currentLine+"\n"},this.currentError.content+=this.log.linesUpToNextWhitespaceLine().join("\n"),this.currentError.content+="\n",this.currentError.content+=this.log.linesUpToNextWhitespaceLine().join("\n"),this.currentError.raw+=this.currentError.content;var e=this.currentError.raw.match(/l\.([0-9]+)/);return e&&(this.currentError.line=parseInt(e[1],10)),this.data.push(this.currentError)}},{key:"parseSingleWarningLine",value:function(e){var t=this.currentLine.match(e);if(t){var n=t[1],r=n.match(E),o=r?parseInt(r[1],10):null;this.data.push({line:o,file:this.currentFilePath,level:"warning",message:n,raw:n})}}},{key:"parseMultipleWarningLine",value:function(){var e=this.currentLine.match(this.packageWarningRegex);if(e){for(var t=[e[1]],n=this.currentLine.match(E),r=n?parseInt(n[1],10):null,o=this.currentLine.match(this.packageRegex)[1],i=new RegExp("(?:\\("+o+"\\))*[\\s]*(.*)","i");this.currentLine=this.log.nextLine();)r=(n=this.currentLine.match(E))?parseInt(n[1],10):r,e=this.currentLine.match(i),t.push(e[1]);var a=t.join(" ");this.data.push({line:r,file:this.currentFilePath,level:"warning",message:a,raw:a})}}},{key:"parseHboxLine",value:function(){var e=this.currentLine.match(E),t=e?parseInt(e[1],10):null;this.data.push({line:t,file:this.currentFilePath,level:"typesetting",message:this.currentLine,raw:this.currentLine})}},{key:"parseParensForFilenames",value:function(){var e=this.currentLine.search(/[()]/);if(-1!==e){var t=this.currentLine[e];if(this.currentLine=this.currentLine.slice(e+1),"("===t){var n=this.consumeFilePath();if(n){this.currentFilePath=n;var r={path:n,files:[]};this.fileStack.push(r),this.currentFileList.push(r),this.currentFileList=r.files}else this.openParens++}else if(")"===t)if(this.openParens>0)this.openParens--;else if(this.fileStack.length>1){this.fileStack.pop();var o=this.fileStack[this.fileStack.length-1];this.currentFilePath=o.path,this.currentFileList=o.files}this.parseParensForFilenames()}}},{key:"consumeFilePath",value:function(){if(!this.currentLine.match(/^\/?([^ ()\\]+\/)+/))return!1;for(var e,t=this.currentLine.search(/[ ()\\]/);-1!==t&&" "===this.currentLine[t];){var n=this.currentLine.slice(0,t);if(/\.\w+$/.test(n))break;var r=this.currentLine.slice(t+1);if(/^\s*["()[\]]/.test(r))break;var o=r.search(/[ "()[\]]/);-1===o?t=-1:t+=o+1}return-1===t?(e=this.currentLine,this.currentLine=""):(e=this.currentLine.slice(0,t),this.currentLine=this.currentLine.slice(t)),e}},{key:"postProcess",value:function(e){var t=this,n=[],r={error:[],warning:[],typesetting:[]},o=new Set;return e.forEach((function(e){var i,a=e.raw;t.ignoreDuplicates&&o.has(a)||(null===(i=r[e.level])||void 0===i||i.push(e),n.push(e),o.add(a))})),{errors:r.error,warnings:r.warning,typesetting:r.typesetting,all:n,files:this.rootFileList}}}]),e}(),D=function(){function e(t){k(this,e),this.text=t.replace(/(\r\n)|\r/g,"\n");var n=this.text.split("\n");this.lines=[n[0]];for(var r=1;r<n.length;r++){var o=n[r-1],i=n[r];79===o.length&&"..."!==o.slice(-3)&&"!"!==i.charAt(0)?this.lines[this.lines.length-1]+=i:this.lines.push(i)}this.row=0}return j(e,[{key:"nextLine",value:function(){return this.row++,!(this.row>=this.lines.length)&&this.lines[this.row]}},{key:"rewindLine",value:function(){this.row--}},{key:"linesUpToNextWhitespaceLine",value:function(e){return this.linesUpToNextMatchingLine(/^ *$/,e)}},{key:"linesUpToNextMatchingLine",value:function(e,t){for(var n=[];;){var r=this.nextLine();if(!1===r)break;if(t&&r.match(/^! /)){this.rewindLine();break}if(n.push(r),r.match(e))break}return n}}]),e}(),F=n(56377),X=n(52322),Z=[].concat([{ruleId:"hint_misplaced_alignment_tab_character",regexToMatch:/Misplaced alignment tab character &/},{ruleId:"hint_extra_alignment_tab_has_been_changed",regexToMatch:/Extra alignment tab has been changed to \\cr/},{ruleId:"hint_display_math_should_end_with",regexToMatch:/Display math should end with \$\$/},{ruleId:"hint_missing_inserted",regexToMatch:/Missing [{$] inserted\./},{ruleId:"hint_reference_undefined",regexToMatch:/Reference.+undefined/},{ruleId:"hint_there_were_undefined_references",regexToMatch:/There were undefined references/},{ruleId:"hint_citation_on_page_undefined_on_input_line",regexToMatch:/Citation .+ on page .+ undefined on input line .+/},{ruleId:"hint_label_multiply_defined_labels",regexToMatch:/(Label .+)? multiply[ -]defined( labels)?/},{ruleId:"hint_float_specifier_changed",regexToMatch:/`!?h' float specifier changed to `!?ht/},{ruleId:"hint_no_positions_in_optional_float_specifier",regexToMatch:/No positions in optional float specifier/},{ruleId:"hint_undefined_control_sequence",regexToMatch:/Undefined control sequence/,contentRegex:/^[^\n]*(\\\S+)\s*[\n]/,improvedTitle:function(e,t){if(null!=t&&t.length&&F.G.has(t[0])){var n=t[0],r=F.G.get(n);return["Is ".concat(r.command," missing?"),(0,X.jsxs)("span",{children:["Is ",(0,X.jsx)("code",{children:r.command})," missing?"]})]}return e}},{ruleId:"hint_undefined_environment",regexToMatch:/LaTeX Error: Environment .+ undefined/,contentRegex:/\\begin\{(\S+)\}/,improvedTitle:function(e,t){if(null!=t&&t.length&&F.y.has(t[0])){var n=t[0],r=F.y.get(n);return["Is ".concat(r.command," missing?"),(0,X.jsxs)("span",{children:["Is ",(0,X.jsx)("code",{children:r.command})," missing?"]})]}return e}},{ruleId:"hint_file_not_found",regexToMatch:/File .+ not found/},{ruleId:"hint_unknown_graphics_extension",regexToMatch:/LaTeX Error: Unknown graphics extension: \..+/},{ruleId:"hint_unknown_float_option_h",regexToMatch:/LaTeX Error: Unknown float option `H/},{ruleId:"hint_unknown_float_option_q",regexToMatch:/LaTeX Error: Unknown float option `q/},{ruleId:"hint_math_allowed_only_in_math_mode",regexToMatch:/LaTeX Error: \\math.+ allowed only in math mode/},{ruleId:"hint_mismatched_environment",types:["environment"],regexToMatch:/Error: `([^']{2,})' expected, found `([^']{2,})'.*/,newMessage:"Error: environment does not match \\begin{$1} ... \\end{$2}"},{ruleId:"hint_mismatched_brackets",types:["environment"],regexToMatch:/Error: `([^a-zA-Z0-9])' expected, found `([^a-zA-Z0-9])'.*/,newMessage:"Error: brackets do not match, found '$2' instead of '$1'"},{ruleId:"hint_can_be_used_only_in_preamble",regexToMatch:/LaTeX Error: Can be used only in preamble/},{ruleId:"hint_missing_right_inserted",regexToMatch:/Missing \\right inserted/},{ruleId:"hint_double_superscript",regexToMatch:/Double superscript/},{ruleId:"hint_double_subscript",regexToMatch:/Double subscript/},{ruleId:"hint_no_author_given",regexToMatch:/No \\author given/},{ruleId:"hint_somethings_wrong_perhaps_a_missing_item",regexToMatch:/LaTeX Error: Something's wrong--perhaps a missing \\item/},{ruleId:"hint_misplaced_noalign",regexToMatch:/Misplaced \\noalign/},{ruleId:"hint_no_line_here_to_end",regexToMatch:/LaTeX Error: There's no line here to end/},{ruleId:"hint_verb_ended_by_end_of_line",regexToMatch:/LaTeX Error: \\verb ended by end of line/},{ruleId:"hint_illegal_unit_of_measure_pt_inserted",regexToMatch:/Illegal unit of measure (pt inserted)/},{ruleId:"hint_extra_right",regexToMatch:/Extra \\right/},{ruleId:"hint_missing_begin_document",regexToMatch:/Missing \\begin{document}/},{ruleId:"hint_mismatched_environment2",types:["environment"],cascadesFrom:["environment"],regexToMatch:/Error: `\\end\{([^\}]+)\}' expected but found `\\end\{([^\}]+)\}'.*/,newMessage:"Error: environments do not match: \\begin{$1} ... \\end{$2}"},{ruleId:"hint_mismatched_environment3",types:["environment"],cascadesFrom:["environment"],regexToMatch:/Warning: No matching \\end found for `\\begin\{([^\}]+)\}'.*/,newMessage:"Warning: No matching \\end found for \\begin{$1}"},{ruleId:"hint_mismatched_environment4",types:["environment"],cascadesFrom:["environment"],regexToMatch:/Error: Found `\\end\{([^\}]+)\}' without corresponding \\begin.*/,newMessage:"Error: found \\end{$1} without a corresponding \\begin{$1}"}],[{ruleId:"hint_character_invalid_at_this_point",regexToMatch:/^Package calc error: `(.+?)' invalid at this point/,package:"calc"},{ruleId:"hint_command_allowed_only_in_math_mode",regexToMatch:/^Package amsmath error: (.+?) allowed only in math mode/,package:"amsmath"},{ruleId:"hint_command_undefined",regexToMatch:/^LaTeX error: (.+?) undefined/,package:"LaTeX"},{ruleId:"hint_lt_in_mid_line",regexToMatch:/^LaTeX error: \\< in mid line/,package:"LaTeX"},{ruleId:"hint_a_box_was_supposed_to_be_here",regexToMatch:/^A <Box> was supposed to be here/i,package:"TeX"},{ruleId:"hint_accent_not_provided_by_font_family",regexToMatch:/^Package textcomp error: Accent (.+?) not provided by font family (.+)/,package:"textcomp"},{ruleId:"hint_argument_of_has_an_extra",regexToMatch:/^Argument of (.+?) has an extra }/,package:"TeX"},{ruleId:"hint_bad_line_or_vector_argument",regexToMatch:/^LaTeX error: Bad \\line or \\vector argument/,package:"LaTeX"},{ruleId:"hint_bad_math_environment_delimiter",regexToMatch:/^LaTeX error: Bad math environment delimiter/,package:"LaTeX"},{ruleId:"hint_begin_env_allowed_only_in_paragraph_mode",regexToMatch:/^Package amsmath error: \\begin{(.+?)} allowed only in paragraph mode/,package:"amsmath"},{ruleId:"hint_begin_env_on_input_line_x_ended_by_end_x",regexToMatch:/^LaTeX error: \\begin{(.+?)} on input line (.+?) ended by \\end{(.+?)}/,package:"LaTeX"},{ruleId:"hint_begin_split_wont_work_here",regexToMatch:/^Package amsmath error: \\begin{split} won't work here/,package:"amsmath"},{ruleId:"hint_can_be_used_only_in_preamble",regexToMatch:/^LaTeX error: Can be used only in preamble/,package:"LaTeX"},{ruleId:"hint_cannot_be_used_in_preamble",regexToMatch:/^LaTeX error: Cannot be used in preamble/,package:"LaTeX"},{ruleId:"hint_cannot_define_unicode_char_value_lt_00a0",regexToMatch:/^Package inputenc error: Cannot define Unicode char value < 00A0/,package:"inputenc"},{ruleId:"hint_cannot_determine_size_of_graphic_in_file",regexToMatch:/^Package (graphics|graphicx) error: Cannot determine size of graphic in (.+)/,package:"graphics/graphicx"},{ruleId:"hint_cannot_include_graphics_of_type",regexToMatch:/^Package (graphics|graphicx) error: Cannot include graphics of type\s*: (.+)/,package:"graphics/graphicx"},{ruleId:"hint_caption_outside_float",regexToMatch:/^LaTeX error: \\caption outside float/,package:"LaTeX"},{ruleId:"hint_command_already_defined",regexToMatch:/^LaTeX error: Command (.+?) already defined/,package:"LaTeX"},{ruleId:"hint_command_invalid_in_math_mode",regexToMatch:/^LaTeX error: Command (.+?) invalid in math mode/,package:"LaTeX"},{ruleId:"hint_command_not_defined_as_a_math_alphabet",regexToMatch:/^LaTeX error: Command (.+?) not defined as a math alphabet/,package:"LaTeX"},{ruleId:"hint_corrupted_nfss_tables",regexToMatch:/^LaTeX error: Corrupted NFSS tables/,package:"LaTeX"},{ruleId:"hint_counter_too_large",regexToMatch:/^LaTeX error: Counter too large/,package:"LaTeX"},{ruleId:"hint_dimension_too_large",regexToMatch:/^Dimension too large/,package:"TeX"},{ruleId:"hint_displaybreak_cannot_be_applied_here",regexToMatch:/^Package amsmath error: \\displaybreak cannot be applied here/,package:"amsmath"},{ruleId:"hint_division_by_0",regexToMatch:/^Package (graphics|graphicx) error: Division by 0/,package:"graphics/graphicx"},{ruleId:"hint_double_subscript",regexToMatch:/^Double subscript/,package:"TeX"},{ruleId:"hint_double_superscript",regexToMatch:/^Double superscript/,package:"TeX"},{ruleId:"hint_encoding_file_not_found",regexToMatch:/^Package fontenc error: Encoding file `(.+?)' not found/,package:"fontenc"},{ruleId:"hint_encoding_scheme_unknown",regexToMatch:/^LaTeX error: Encoding scheme `(.+?)' unknown/,package:"LaTeX"},{ruleId:"hint_environment_undefined",regexToMatch:/^LaTeX error: Environment (.+?) undefined/,package:"LaTeX"},{ruleId:"hint_erroneous_nesting_of_equation_structures",regexToMatch:/^Package amsmath error: Erroneous nesting of equation structures/,package:"amsmath"},{ruleId:"hint_extra_on_this_line",regexToMatch:/^Package amsmath error: Extra & on this line/,package:"amsmath"},{ruleId:"hint_extra_alignment_tab_has_been_changed_to_cr",regexToMatch:/^Extra alignment tab has been changed to \\cr/,package:"TeX"},{ruleId:"hint_extra_endgroup",regexToMatch:/^Extra \\endgroup/,package:"TeX"},{ruleId:"hint_extra_or",regexToMatch:/^Extra \\or/,package:"TeX"},{ruleId:"hint_extra_right",regexToMatch:/^Extra \\right/,package:"TeX"},{ruleId:"hint_extra_or_forgotten",regexToMatch:/^Extra }, or forgotten \$/,package:"TeX"},{ruleId:"hint_extra_or_forgotten_endgroup",regexToMatch:/^Extra }, or forgotten \\endgroup/,package:"TeX"},{ruleId:"hint_file_not_found",regexToMatch:/^LaTeX error: File `(.+?)' not found/,package:"LaTeX"},{ruleId:"hint_file_ended_while_scanning",regexToMatch:/^File ended while scanning (.+)/,package:"TeX"},{ruleId:"hint_float_lost",regexToMatch:/^LaTeX error: Float\(s\) lost/,package:"LaTeX"},{ruleId:"hint_font_family_unknown",regexToMatch:/^LaTeX error: Font family `(.+?)\+(.+?)' unknown/,package:"LaTeX"},{ruleId:"hint_font_not_found",regexToMatch:/^LaTeX error: Font (.+?) not found/,package:"LaTeX"},{ruleId:"hint_font_not_loaded_not_enough_room_left",regexToMatch:/^Font (.+?)=(.+?) not loaded: Not enough room left/,package:"TeX"},{ruleId:"hint_font_shape_not_found",regexToMatch:/^LaTeX error: Font shape (.+?) not found/,package:"LaTeX"},{ruleId:"hint_i_cant_find_file",regexToMatch:/^I can't find file `(.+?)'/,package:"TeX"},{ruleId:"hint_i_cant_write_on_file",regexToMatch:/^I can't write on file `(.+?)'/,package:"TeX"},{ruleId:"hint_illegal_character_in_array_arg",regexToMatch:/^LaTeX error: Illegal character in array arg/,package:"LaTeX"},{ruleId:"hint_illegal_parameter_number_in_definition_of",regexToMatch:/^Illegal parameter number in definition of (.+)/,package:"TeX"},{ruleId:"hint_illegal_unit_of_measure_pt_inserted",regexToMatch:/^Illegal unit of measure \(pt inserted\)/,package:"TeX"},{ruleId:"hint_improper_argument_for_math_accent",regexToMatch:/^Package amsmath error: Improper argument for math accent/,package:"amsmath"},{ruleId:"hint_improper_discretionary_list",regexToMatch:/^Improper discretionary list/,package:"TeX"},{ruleId:"hint_improper_hyphenation",regexToMatch:/^Improper \\hyphenation/,package:"TeX"},{ruleId:"hint_improper_prevdepth",regexToMatch:/^Improper \\prevdepth/,package:"TeX"},{ruleId:"hint_improper_spacefactor",regexToMatch:/^Improper \\spacefactor/,package:"TeX"},{ruleId:"hint_include_cannot_be_nested",regexToMatch:/^LaTeX error: \\include cannot be nested/,package:"LaTeX"},{ruleId:"hint_incompatible_list_cant_be_unboxed",regexToMatch:/^Incompatible list can't be unboxed/,package:"TeX"},{ruleId:"hint_incomplete_all_text_was_ignored_after_line",regexToMatch:/^Incomplete (.+?); all text was ignored after line (.+)/,package:"TeX"},{ruleId:"hint_infinite_glue_shrinkage_found",regexToMatch:/^Infinite glue shrinkage found (.+)/,package:"TeX"},{ruleId:"hint_interruption",regexToMatch:/^Interruption/,package:"TeX"},{ruleId:"hint_invalid_use_of_commande",regexToMatch:/^Package amsmath error: Invalid use of (.+)/,package:"amsmath"},{ruleId:"hint_keyboard_character_used_is_undefined_in_input_encoding",regexToMatch:/^Package inputenc error: Keyboard character used is undefined in input encoding (.+)/,package:"inputenc"},{ruleId:"hint_language_definition_file_not_found",regexToMatch:/^Package babel error: Language definition file (.+?)\.ldf not found /,package:"babel"},{ruleId:"hint_limit_controls_must_follow_a_math_operator",regexToMatch:/^Limit controls must follow a math operator/,package:"TeX"},{ruleId:"hint_loadclass_in_package_file",regexToMatch:/^LaTeX error: \\LoadClass in package file/,package:"LaTeX"},{ruleId:"hint_lonely_item_perhaps_a_missing_list_environment",regexToMatch:/^LaTeX error: Lonely \\item--perhaps a missing list environment/,package:"LaTeX"},{ruleId:"hint_math_alphabet_identifier_is_undefined_in_math_version",regexToMatch:/^LaTeX error: Math alphabet identifier (.+?) is undefined in math version (.+)/,package:"LaTeX"},{ruleId:"hint_math_version_is_not_defined",regexToMatch:/^LaTeX error: Math version (.+?) is not defined/,package:"LaTeX"},{ruleId:"hint_misplaced_alignment_tab_character",regexToMatch:/^Misplaced alignment tab character &/,package:"TeX"},{ruleId:"hint_misplaced_cr",regexToMatch:/^Misplaced \\cr/,package:"TeX"},{ruleId:"hint_misplaced_crcr",regexToMatch:/^Misplaced \\crcr/,package:"TeX"},{ruleId:"hint_misplaced_noalign",regexToMatch:/^Misplaced \\noalign/,package:"TeX"},{ruleId:"hint_misplaced_omit",regexToMatch:/^Misplaced \\omit/,package:"TeX"},{ruleId:"hint_missing_begin_document",regexToMatch:/^LaTeX error: Missing \\begin{document}/,package:"LaTeX"},{ruleId:"hint_missing_control_sequence_inserted",regexToMatch:/^Missing control sequence inserted/,package:"TeX"},{ruleId:"hint_missing_cr_inserted",regexToMatch:/^Missing \\cr inserted/,package:"TeX"},{ruleId:"hint_missing_delimiter_inserted",regexToMatch:/^Missing delimiter \(. inserted\)/,package:"TeX"},{ruleId:"hint_missing_endcsname_inserted",regexToMatch:/^Missing \\endcsname inserted/,package:"TeX"},{ruleId:"hint_missing_number_treated_as_zero",regexToMatch:/^Missing number, treated as zero/,package:"TeX"},{ruleId:"hint_missing_p_arg_in_array_arg",regexToMatch:/^LaTeX error: Missing p-arg in array arg/,package:"LaTeX"},{ruleId:"hint_missing_exp_in_array_arg",regexToMatch:/^LaTeX error: Missing @-exp in array arg/,package:"LaTeX"},{ruleId:"hint_missing_inserted_in_alignment_preamble",regexToMatch:/^Missing # inserted in alignment preamble/,package:"TeX"},{ruleId:"hint_missing_inserted_for_ifnum",regexToMatch:/^Missing = inserted for \\ifnum/,package:"TeX"},{ruleId:"hint_missing_inserted_for_ifdim",regexToMatch:/^Missing = inserted for \\ifdim/,package:"TeX"},{ruleId:"hint_missing_inserted",regexToMatch:/^Missing \$ inserted/,package:"TeX"},{ruleId:"hint_missing_endgroup_inserted",regexToMatch:/^Missing \\endgroup inserted/,package:"TeX"},{ruleId:"hint_missing_right_inserted",regexToMatch:/^Missing \\right\. inserted/,package:"TeX"},{ruleId:"hint_missing_inserted",regexToMatch:/^Missing \{ inserted/,package:"TeX"},{ruleId:"hint_missing_inserted",regexToMatch:/^Missing } inserted/,package:"TeX"},{ruleId:"hint_multiple_labels_label_tiquette_will_be_lost",regexToMatch:/^Package amsmath error: Multiple \\label's: label (.+?) will be lost/,package:"amsmath"},{ruleId:"hint_multiple_tag",regexToMatch:/^Package amsmath error: Multiple \\tag/,package:"amsmath"},{ruleId:"hint_no_counter_defined",regexToMatch:/^LaTeX error: No counter '(.+?)' defined/,package:"LaTeX"},{ruleId:"hint_no_cyrillic_encoding_definition_files_were_found",regexToMatch:/^Package babel error: No Cyrillic encoding definition files were found/,package:"babel"},{ruleId:"hint_no_declaration_for_shape",regexToMatch:/^LaTeX error: No declaration for shape (.+)/,package:"LaTeX"},{ruleId:"hint_no_driver_specified",regexToMatch:/^Package (color|graphics|graphicx) error: No driver specified/,package:"color/graphics/graphicx"},{ruleId:"hint_no_room_for_a_new_register",regexToMatch:/^No room for a new (.+)/,package:"TeX"},{ruleId:"hint_no_title_given",regexToMatch:/^LaTeX error: No \\title given/,package:"LaTeX"},{ruleId:"hint_not_a_letter",regexToMatch:/^Not a letter/,package:"TeX"},{ruleId:"hint_not_in_outer_par_mode",regexToMatch:/^LaTeX error: Not in outer par mode/,package:"LaTeX"},{ruleId:"hint_number_too_big",regexToMatch:/^Number too big/,package:"TeX"},{ruleId:"hint_ok_see_the_transcript_file",regexToMatch:/^OK \(see the transcript file\)/,package:"TeX"},{ruleId:"hint_old_form_should_be_begin",regexToMatch:/^Package amsmath error: Old form (.+?) should be \\begin{(.+?)} /,package:"amsmath"},{ruleId:"hint_only_one_is_allowed_per_tab",regexToMatch:/^Only one # is allowed per tab/,package:"TeX"},{ruleId:"hint_option_clash_for_package",regexToMatch:/^LaTeX error: Option clash for package (.+)/,package:"LaTeX"},{ruleId:"hint_page_height_already_too_large",regexToMatch:/^LaTeX error: Page height already too large/,package:"LaTeX"},{ruleId:"hint_paragraph_ended_before_command_was_complete",regexToMatch:/^Paragraph ended before (.+?) was complete/,package:"TeX"},{ruleId:"hint_please_type_a_command_or_say_end",regexToMatch:/^\(Please type a command or say `\\end'\)/,package:"TeX"},{ruleId:"hint_pushtabs_and_poptabs_dont_match",regexToMatch:/^LaTeX error: \\pushtabs and \\poptabs don't match/,package:"LaTeX"},{ruleId:"hint_requirepackage_or_loadclass_in_options_section",regexToMatch:/^LaTeX error: \\RequirePackage or \\LoadClass in Options Section/,package:"LaTeX"},{ruleId:"hint_rotation_not_supported",regexToMatch:/^Package (graphics|graphicx) error: Rotation not supported/,package:"graphics/graphicx"},{ruleId:"hint_runaway",regexToMatch:/^Runaway (.+)/,package:"TeX"},{ruleId:"hint_you_havent_specified_a_language_option",regexToMatch:/^Package babel error: You haven't specified a language option/,package:"babel"}],[{ruleId:"hint_calculating_math_sizes_for_size",regexToMatch:/^LaTeX (Font )?(Warning|Info): Calculating math sizes for size (.+)/,package:"LaTeX"},{ruleId:"hint_checking_defaults_for",regexToMatch:/^LaTeX (Font )?(Warning|Info): Checking defaults for (.+)/,package:"LaTeX"},{ruleId:"hint_citation_on_page_undefined",regexToMatch:/^LaTeX (Font )?(Warning|Info): Citation `(.+?)' on page (.+?) undefined/,package:"LaTeX"},{ruleId:"hint_command_invalid_in_math_mode",regexToMatch:/^LaTeX (Font )?(Warning|Info): Command (.+?) invalid in math mode/,package:"LaTeX"},{ruleId:"hint_document_class",regexToMatch:/^LaTeX (Font )?(Warning|Info): Document Class\s*: (.+)/,package:"LaTeX"},{ruleId:"hint_empty_thebibliography_environment",regexToMatch:/^LaTeX (Font )?(Warning|Info): Empty `thebibliography' environment/,package:"LaTeX"},{ruleId:"hint_encoding_has_changed_to_for",regexToMatch:/^LaTeX (Font )?(Warning|Info): Encoding (.+?) has changed to (.+?) for/,package:"LaTeX"},{ruleId:"hint_end_occurred_inside_a_group_at_level",regexToMatch:/^\(\\end occurred inside a group at level (.+)\)/,package:"TeX"},{ruleId:"hint_when_condition_on_line_was_incomplete",regexToMatch:/^\(\\end occurred when (.+?) on line (.+) was incomplete\)/,package:"TeX"},{ruleId:"hint_external_font_loaded_for_size",regexToMatch:/^LaTeX (Font )?(Warning|Info): External font (.+?) loaded for size (.+)/,package:"LaTeX"},{ruleId:"hint_faking_for_font_family_in_ts1_encoding",regexToMatch:/^Package TeXtcomp (Warning|Info): Faking (.+?) for font family (.+?) in TS1 encoding/,package:"TeXtcomp"},{ruleId:"hint_file_already_exists_on_the_system_not_generating_it_from_this_source",regexToMatch:/^LaTeX (Font )?(Warning|Info): File `(.+?)' already exists on the system\.\nNot generating it from this source\./,package:"LaTeX"},{ruleId:"hint_file",regexToMatch:/^LaTeX (Font )?(Warning|Info): File\s*: (.+)/,package:"LaTeX"},{ruleId:"hint_file_font_definition",regexToMatch:/^LaTeX (Font )?(Warning|Info): File\s*: (.+?)\.fd (.+)/,package:"LaTeX"},{ruleId:"hint_float_too_large_for_page_by",regexToMatch:/^LaTeX (Font )?(Warning|Info): Float too large for page by (.+)/,package:"LaTeX"},{ruleId:"hint_font_shape_in_size_not_available_external_font_used",regexToMatch:/^LaTeX (Font )?(Warning|Info): Font shape (.+?) in size (.+?) not available\nexternal font (.+?) used/,package:"LaTeX"},{ruleId:"hint_font_shape_in_size_not_available_size_substituted",regexToMatch:/^LaTeX (Font )?(Warning|Info): Font shape (.+?) in size (.+?) not available\nsize (.+?) substituted/,package:"LaTeX"},{ruleId:"hint_font_shape_in_size_not_available_shape_forme_tried",regexToMatch:/^LaTeX (Font )?(Warning|Info): Font shape (.+?) in size (.+?) not available\nshape (.+?) tried/,package:"LaTeX"},{ruleId:"hint_font_shape_forme_undefined_using_autre_forme_instead",regexToMatch:/^LaTeX (Font )?(Warning|Info): Font shape (.+?) undefined\. Using `(.+?)' instead/,package:"LaTeX"},{ruleId:"hint_font_shape_forme_will_be_scaled_to_size_taille_",regexToMatch:/^LaTeX (Font )?(Warning|Info): Font shape (.+?) will be scaled to size (.+)/,package:"LaTeX"},{ruleId:"hint_foreign_command",regexToMatch:/^Package amsmath (Warning|Info): Foreign command (.+?);/,package:"amsmath"},{ruleId:"hint_form_feed_has_been_converted_to_blank_line",regexToMatch:/^LaTeX (Font )?(Warning|Info): Form feed has been converted to Blank Line/,package:"LaTeX"},{ruleId:"hint_float_specifier_changed",regexToMatch:/^LaTeX (Font )?(Warning|Info): `(.+?)' float specifier changed to `(.+?)'/,package:"LaTeX"},{ruleId:"hint_ignoring_text_after_end",regexToMatch:/^LaTeX (Font )?(Warning|Info): Ignoring text `(.+?)' after \\end{(.+?)}/,package:"LaTeX"},{ruleId:"hint_label_multiply_defined",regexToMatch:/^LaTeX (Font )?(Warning|Info): Label `(.+?)' multiply defined/,package:"LaTeX"},{ruleId:"hint_labels_may_have_changed_rerun_to_get_cross_references_right",regexToMatch:/^LaTeX (Font )?(Warning|Info): Label\(s\) may have changed\. Rerun to get cross-references right\./,package:"LaTeX"},{ruleId:"hint_loose_hbox_badness",regexToMatch:/^Loose \\hbox \(badness (.+?)\) (.+)/,package:"TeX"},{ruleId:"hint_loose_vbox_badness",regexToMatch:/^Loose \\vbox \(badness (.+?)\) (.+)/,package:"TeX"},{ruleId:"hint_making_an_active_character",regexToMatch:/^Package babel (Warning|Info): Making (.+?) an active character/,package:"babel"},{ruleId:"hint_marginpar_on_page_moved",regexToMatch:/^LaTeX (Font )?(Warning|Info): Marginpar on page (.+?) moved/,package:"LaTeX"},{ruleId:"hint_missing_character_there_is_no_in_font",regexToMatch:/^Missing character\s*: There is no (.+?) in font (.+?)!/,package:"TeX"},{ruleId:"hint_no_author_given",regexToMatch:/^LaTeX (Font )?(Warning|Info): No \\author given/,package:"LaTeX"},{ruleId:"hint_no_auxiliary_output_files",regexToMatch:/^LaTeX (Font )?(Warning|Info): No auxiliary output files/,package:"LaTeX"},{ruleId:"hint_no_characters_defined_by_input_encoding_change_to",regexToMatch:/^LaTeX (Font )?(Warning|Info): No characters defined by input encoding change to (.+)/,package:"LaTeX"},{ruleId:"hint_no_file",regexToMatch:/^LaTeX (Font )?(Warning|Info): No file (.+)/,package:"LaTeX"},{ruleId:"hint_no_hyphenation_patterns_were_loaded_for_the_language",regexToMatch:/^Package babel (Warning|Info): No hyphenation patterns were loaded for the language `(.+?)'/,package:"babel"},{ruleId:"hint_no_input_encoding_specified_for_language",regexToMatch:/^Package babel (Warning|Info): No input encoding specified for (.+?) language/,package:"babel"},{ruleId:"hint_no_positions_in_optional_float_specifier",regexToMatch:/^LaTeX (Font )?(Warning|Info): No positions in optional float specifier\./,package:"LaTeX"},{ruleId:"hint_oldstyle_digits_unavailable_for_family",regexToMatch:/^LaTeX (Font )?(Warning|Info): Oldstyle digits unavailable for family (.+)/,package:"Textcomp"},{ruleId:"hint_optional_argument_of_twocolumn_too_tall_on_page",regexToMatch:/^LaTeX (Font )?(Warning|Info): Optional argument of \\twocolumn too tall on page (.+)/,package:"LaTeX"},{ruleId:"hint_oval_circle_or_line_size_unavailable",regexToMatch:/^LaTeX (Font )?(Warning|Info): \\oval, \\circle, or \\line size unavailable/,package:"LaTeX"},{ruleId:"hint_overfull_hbox_too_wide_quelque_part_",regexToMatch:/^Overfull \\hbox \((.+?)pt too wide\) (.+)/,package:"TeX"},{ruleId:"hint_overfull_vbox_pt_too_wide",regexToMatch:/^Overfull \\vbox \((.+?)pt too wide\)\) (.+)/,package:"TeX"},{ruleId:"hint_overwriting_encoding_scheme_quelque_chose_defaults",regexToMatch:/^LaTeX (Font )?(Warning|Info): Overwriting encoding scheme (.+?) defaults/,package:"LaTeX"},{ruleId:"hint_overwriting_in_version",regexToMatch:/^LaTeX (Font )?(Warning|Info): Overwriting (.+?) in version `(.+)'/,package:"LaTeX"},{ruleId:"hint_package",regexToMatch:/^LaTeX (Font )?(Warning|Info): Package: (.+)/,package:"LaTeX"},{ruleId:"hint_redeclaring_font_encoding",regexToMatch:/^LaTeX (Font )?(Warning|Info): Redeclaring font encoding (.+)/,package:"LaTeX"},{ruleId:"hint_redeclaring_math_accent",regexToMatch:/^LaTeX (Font )?(Warning|Info): Redeclaring math accent (.+)/,package:"LaTeX"},{ruleId:"hint_redeclaring_math_alphabet",regexToMatch:/^LaTeX (Font )?(Warning|Info): Redeclaring math alphabet (.+)/,package:"LaTeX"},{ruleId:"hint_redeclaring_math_symbol",regexToMatch:/^LaTeX (Font )?(Warning|Info): Redeclaring math symbol (.+)/,package:"LaTeX"},{ruleId:"hint_redeclaring_math_version",regexToMatch:/^LaTeX (Font )?(Warning|Info): Redeclaring math version (.+)/,package:"LaTeX"},{ruleId:"hint_redeclaring_symbol_font",regexToMatch:/^LaTeX (Font )?(Warning|Info): Redeclaring symbol font (.+)/,package:"LaTeX"},{ruleId:"hint_reference_on_page_undefined",regexToMatch:/^LaTeX (Font )?(Warning|Info): Reference `(.+?)' on page (.+?) undefined/,package:"LaTeX"},{ruleId:"hint_size_substitutions_with_differences_up_to_have_occurred",regexToMatch:/^LaTeX (Font )?(Warning|Info): Size substitutions with differences up to (.+?) have occurred/,package:"LaTeX"},{ruleId:"hint_some_font_shapes_were_not_available_defaults_substituted",regexToMatch:/^LaTeX (Font )?(Warning|Info): Some font shapes were not available, defaults substituted/,package:"LaTeX"},{ruleId:"hint_tab_has_been_converted_to_blank_space",regexToMatch:/^LaTeX (Font )?(Warning|Info): Tab has been converted to Blank Space/,package:"LaTeX"},{ruleId:"hint_text_page_contains_only_floats",regexToMatch:/^LaTeX (Font )?(Warning|Info): text page (.+?) contains only floats/,package:"LaTeX"},{ruleId:"hint_there_were_multiply_defined_labels",regexToMatch:/^LaTeX (Font )?(Warning|Info): There were multiply-defined labels/,package:"LaTeX"},{ruleId:"hint_there_were_undefined_references",regexToMatch:/^LaTeX (Font )?(Warning|Info): There were undefined references/,package:"LaTeX"},{ruleId:"hint_tight_hbox_badness",regexToMatch:/^Tight \\hbox \(badness (.+?)\) (.+)/,package:"TeX"},{ruleId:"hint_tight_vbox_badness",regexToMatch:/^Tight \\vbox \(badness (.+?)\) (.+)/,package:"TeX"},{ruleId:"hint_try_loading_font_information_for",regexToMatch:/^LaTeX (Font )?(Warning|Info): Try loading font information for (.+?)\+(.+)/,package:"LaTeX"},{ruleId:"hint_unable_to_redefine_math_accent",regexToMatch:/^Package amsmath (Warning|Info): Unable to redefine math accent (.+)/,package:"amsmath"},{ruleId:"hint_hbox_badness_detected_at_line",regexToMatch:/^Underfull \\hbox \(badness (.+?)\) (.+?) detected at line (.+)/,package:"TeX"},{ruleId:"hint_hbox_badness_has_occurred_while_output_is_active",regexToMatch:/^Underfull \\hbox \(badness (.+?)\) (.+?) has occurred while \\output is active/,package:"TeX"},{ruleId:"hint_hbox_badness_in_alignment_at_lines",regexToMatch:/^Underfull \\hbox \(badness (.+?)\) (.+?) in alignment at lines (.+)/,package:"TeX"},{ruleId:"hint_hbox_badness_in_paragraph_at_lines",regexToMatch:/^Underfull \\hbox \(badness (.+?)\) (.+?) in paragraph at lines (.+)/,package:"TeX"},{ruleId:"hint_vbox_badness_detected_at_line",regexToMatch:/^Underfull \\vbox \(badness (.+?)\) (.+?) detected at line (.+)/,package:"TeX"},{ruleId:"hint_vbox_badness_has_occurred_while_output_is_active",regexToMatch:/^Underfull \\vbox \(badness (.+?)\) (.+?) has occurred while \\output is active/,package:"TeX"},{ruleId:"hint_vbox_badness_in_alignment_at_lines",regexToMatch:/^Underfull \\vbox \(badness (.+?)\) (.+?) in alignment at lines (.+)/,package:"TeX"},{ruleId:"hint_unused_global_options",regexToMatch:/^LaTeX (Font )?(Warning|Info): Unused global option\(s\)\s*: \[(.+?)]/,package:"LaTeX"},{ruleId:"hint_writing_file",regexToMatch:/^LaTeX (Font )?(Warning|Info): Writing file `(.+?)'/,package:"LaTeX"},{ruleId:"hint_writing_text_before_end_as_last_line_of",regexToMatch:/^LaTeX (Font )?(Warning|Info): Writing text `(.+?)' before \\end{(.+?)} as last line of (.+)/,package:"LaTeX"},{ruleId:"hint_you_have_more_than_once_selected_the_attribute_for_language",regexToMatch:/^Package babel (Warning|Info): You have more than once selected the attribute `(.+?)' for language (.+)/,package:"babel"},{ruleId:"hint_you_have_requested_package_or_class_but_the_package_or_class_provides",regexToMatch:/^LaTeX (Font )?(Warning|Info): You have requested (package|class) `(.+?)', but the (package|class) provides `(.+?)'/,package:"LaTeX"},{ruleId:"hint_you_have_requested_release_date_of_latex_but_only_release_ancienne_date_is_available",regexToMatch:/^LaTeX (Font )?(Warning|Info): You have requested release `(.+?)' of LaTeX, but only release `(.+?)' is available/,package:"LaTeX"},{ruleId:"hint_you_have_requested_on_line_version_of_but_only_version_is_available",regexToMatch:/^LaTeX (Font )?(Warning|Info): You have requested, on line (.+?), version `(.+?)' of (.+?), but only version `(.+?)' is available/,package:"LaTeX"}]);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var W=function(e,t){var n="string"==typeof e?new P(e,t).parse():e,r={},o=function(e){var t=Z.find((function(t){return t.regexToMatch.test(e.message)}));if(t){if(t.ruleId&&(e.ruleId=t.ruleId),t.newMessage&&(e.message=e.message.replace(t.regexToMatch,t.newMessage)),t.contentRegex){var n=e.content.match(t.contentRegex);n&&(e.contentDetails=n.slice(1))}if(e.contentDetails&&t.improvedTitle){var o=t.improvedTitle(e.message,e.contentDetails);Array.isArray(o)?e.message=o[0]:e.message=o}if(t.cascadesFrom)for(var i of t.cascadesFrom)r[i]&&(e.suppressed=!0);if(t.types)for(var a of t.types)r[a]=!0}};for(var i of n.all)o(i);for(var a of Object.entries(n)){var c=U(a,2),l=c[0],s=c[1];"object"===R(s)&&s.length>0&&(n[l]=Array.from(s).filter((function(e){return!e.suppressed})))}return n};function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,q(r.key),r)}}function q(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$(t)?t:String(t)}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var H=/^\[(\d+)].*>\s(INFO|WARN|ERROR)\s-\s(.*)$/,G=/^Warning--(.+)\n--line (\d+) of file (.+)$/m,J=/^Warning--(.+)$/m,Y=/^(.*)---line (\d+) of file (.*)\n([^]+?)\nI'm skipping whatever remains of this entry$/m,K=/^(A bad cross reference---entry ".+?"\nrefers to entry.+?, which doesn't exist)$/m,Q=/^(.*)\n?---line (\d+) of file (.*)\n([^]+?)\nI'm skipping whatever remains of this command$/m,ee=/^(.*?)\nwhile executing---line (\d+) of file (.*)/m,te={INFO:"info",WARN:"warning",ERROR:"error"},ne=function(e){return function(t,n){var r=V(t,2),o=r[0],i=r[1],a=V(n,2),c=function(t,n,r){for(var o,i=t,a=[],c=0;o=n.exec(i);){c++;var l=r(o);if(null!=e&&c>=e)return[a,""];a.push(l),i=o.input.slice(0,o.index)+o.input.slice(o.index+o[0].length+1,o.input.length)}return[a,i]}(i,a[0],a[1]),l=V(c,2),s=l[0],u=l[1];return[o.concat(s),u]}},re=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"!=typeof t)throw new Error("BibLogParser Error: text parameter must be a string");this.text=t.replace(/(\r\n)|\r/g,"\n"),this.options=n,this.lines=t.split("\n"),this.warningParsers=[[G,function(e){var t=V(e,4),n=t[0],r=t[1],o=t[2];return{file:t[3],level:"warning",message:r,line:o,raw:n}}],[J,function(e){var t=V(e,2),n=t[0];return{file:"",level:"warning",message:t[1],line:"",raw:n}}]],this.errorParsers=[[Y,function(e){var t=V(e,5),n=t[0],r=t[1],o=t[2];return{file:t[3],level:"error",message:r+"\n"+t[4],line:o,raw:n}}],[K,function(e){var t=V(e,2),n=t[0];return{file:"",level:"error",message:t[1],line:"",raw:n}}],[Q,function(e){var t=V(e,5),n=t[0],r=t[1],o=t[2];return{file:t[3],level:"error",message:r+"\n"+t[4],line:o,raw:n}}],[ee,function(e){var t=V(e,4),n=t[0],r=t[1],o=t[2];return{file:t[3],level:"error",message:r,line:o,raw:n}}]]}var t,n,r;return t=e,(n=[{key:"parseBibtex",value:function(){var e=V(this.warningParsers.reduce(ne(this.options.maxErrors),[[],this.text]),2),t=e[0],n=e[1],r=V(this.errorParsers.reduce(ne(this.options.maxErrors),[[],n]),1)[0];return{all:t.concat(r),errors:r,warnings:t,files:[],typesetting:[]}}},{key:"parseBiber",value:function(){var e={all:[],errors:[],warnings:[],files:[],typesetting:[]};return this.lines.forEach((function(t){var n=t.match(H);if(n){var r=V(n,4),o=r[0],i=r[2],a=r[3],c={file:"",level:te[i]||"INFO",message:a,line:"",raw:o},l=c.message.match(/^BibTeX subsystem: \/.+\/(\w+\.\w+)_.+, line (\d+), (.+)$/);if(l){var s=V(l,4),u=s[1],d=s[2],f=s[3];c.file=u,c.line=d,c.message=f}switch(e.all.push(c),c.level){case"error":return e.errors.push(c);case"warning":return e.warnings.push(c)}}})),e}},{key:"parse",value:function(){var e=this.lines[0];if(e.match(/^.*INFO - This is Biber.*$/))return this.parseBiber();if(e.match(/^This is BibTeX, Version.+$/))return this.parseBibtex();throw new Error("BibLogParser Error: cannot determine whether text is biber or bibtex output")}}])&&B(t.prototype,n),r&&B(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),oe=n(22110);function ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||ce(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e){return function(e){if(Array.isArray(e))return le(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ce(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(e,t){if(e){if("string"==typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?le(e,t):void 0}}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var se=/^(Reference|Citation).+undefined on input line/;var ue=1;var de=async function(e,t,n){var r={log:null,logEntries:{errors:[],warnings:[],typesetting:[]}};function o(e,t){for(var n in r.logEntries)if(e[n]){var o;for(var i of e[n])t&&(i.type=e.type),i.file&&(i.file=he(i.file)),i.key="compile-log-entry-"+ue++;(o=r.logEntries[n]).push.apply(o,ae(e[n]))}}var i=e.get("output.log");if(i)try{var a=await fetch(fe(i,t.pdfDownloadDomain),{signal:n});r.log=await a.text();var c=W(r.log,{ignoreDuplicates:!0}),l=c.errors,s=c.warnings,u=c.typesetting;"stopped-on-first-error"===t.status&&(s=s.filter((function(e){return!function(e){return se.test(e.message)}(e)}))),o({errors:l,warnings:s,typesetting:u})}catch(e){p.c.warn(e)}var d=[];for(var f of e){var h=ie(f,2),m=h[0],g=h[1];m.endsWith(".blg")&&d.push(g)}for(var v of d)try{var y=await fetch(fe(v,t.pdfDownloadDomain),{signal:n}),_=await y.text();try{var b=new re(_,{maxErrors:100}).parse();o({errors:b.errors,warnings:b.warnings},"BibTeX:")}catch(e){}}catch(e){p.c.warn(e)}return r.logEntries.all=[].concat(ae(r.logEntries.errors),ae(r.logEntries.warnings),ae(r.logEntries.typesetting)),r};function fe(e,t){return e.build&&t?"".concat(t).concat(e.url):"".concat(window.origin).concat(e.url)}function he(e,t){return e=(e=(e=e.replace(/\/\//g,"/")).replace(/^.*\/compiles\/[0-9a-f]{24}(-[0-9a-f]{24})?\/(\.\/)?/,"")).replace(/^\/compile\//,""),t&&(e=e.replace(/^\.\//,t+"/")),e}var pe=n(96931),me=n(72526),ge=n(84050);n(44112),n(43430);function ve(e){return function(e){if(Array.isArray(e))return ye(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _e=["bbl","gls","ind"],be=["output.fls","output.fdb_latexmk"],we=n(39493),ke=n(63290),xe=n(47481),je=n(97502),Te=n(72309),Se=n(22276),Ie=n(91661);function Ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ee(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Oe=(0,r.createContext)(void 0),Le=function(e){var t=e.children,n=(0,pe.IM)(),l=(0,ge._i)(),s=l.hasPremiumCompile,u=l.isProjectOwner,d=(0,Ie.QA)().openDocId,f=(0,me.d)(),p=f._id,m=f.rootDocId,g=(0,we.l5)().pdfPreviewOpen,v=(0,ke.SE)(),y=v.features,w=v.alphaProgram,k=v.labsProgram,x=(0,xe.O)().fileTreeData,j=(0,je.Yt)().findEntityByPath,T=Ce((0,r.useState)(!1),2),S=T[0],I=T[1],C=Ce((0,r.useState)(!1),2),E=C[0],O=C[1],L=Ce((0,r.useState)(!1),2),A=L[0],M=L[1],P=Ce((0,i.Z)("pdf.logEntries"),2),D=P[0],F=P[1],Z=Ce((0,o.Z)("pdf.logEntryAnnotations"),2),R=Z[0],U=Z[1],N=(0,Te.cq)().userSettings,W=N.pdfViewer,$=N.syntaxValidation,B=Ce((0,i.Z)("pdf.downloadUrl"),2)[1],q=Ce((0,i.Z)("pdf.url"),2)[1],V=Ce((0,r.useState)(),2),z=V[0],H=V[1];(0,r.useEffect)((function(){B(null==z?void 0:z.pdfDownloadUrl),q(null==z?void 0:z.pdfUrl)}),[z,B,q]);var G=Ce((0,o.Z)("pdf.uncompiled"),2),J=G[0],Y=G[1],K=Ce((0,r.useState)(!1),2),Q=K[0],ee=K[1],te=Ce((0,r.useState)(),2),ne=te[0],re=te[1],ae=Ce((0,r.useState)(),2),ce=ae[0],le=ae[1],se=null==ce?void 0:ce.rootDocId,ue=Ce((0,r.useState)((function(){return function(){}})),2),ye=ue[0],Ee=ue[1],Le=Ce((0,r.useState)({}),2),Ae=Le[0],Me=Le[1],Pe=Ce((0,r.useState)(!1),2),De=Pe[0],Fe=Pe[1],Xe=Ce((0,r.useState)(!1),2),Ze=Xe[0],Re=Xe[1],Ue=Ce((0,r.useState)(!1),2),Ne=Ue[0],We=Ue[1],$e=Ce((0,r.useState)(!1),2),Be=$e[0],qe=$e[1],Ve=(0,r.useCallback)((function(){We((function(e){return e||(0,b.xQ)("ide-open-logs-once"),!e}))}),[We]),ze=Ce((0,r.useState)(),2),He=ze[0],Ge=ze[1],Je=Ce((0,r.useState)(),2),Ye=Je[0],Ke=Je[1],Qe=Ce((0,r.useState)(),2),et=Qe[0],tt=Qe[1],nt=Ce((0,r.useState)(),2),rt=nt[0],ot=nt[1],it=Ce((0,r.useState)(),2),at=it[0],ct=it[1],lt=Ce((0,a.Z)("pdf.position.".concat(p)),2),st=lt[0],ut=lt[1],dt=Ce((0,a.Z)("autocompile_enabled:".concat(p),!1,!0),2),ft=dt[0],ht=dt[1],pt=Ce((0,a.Z)("draft:".concat(p),!1,!0),2),mt=pt[0],gt=pt[1],vt=Ce((0,a.Z)("stop_on_first_error:".concat(p),!1,!0),2),yt=vt[0],_t=vt[1],bt=Ce((0,r.useState)(!1),2),wt=bt[0],kt=bt[1],xt=Ce((0,a.Z)("stop_on_validation_error:".concat(p),!0,!0),2),jt=xt[0],Tt=xt[1],St=Ce((0,o.Z)("editor.sharejs_doc"),1)[0],It=Ce((0,o.Z)("hasLintingError"),2),Ct=It[0],Et=It[1],Ot=Ce((0,r.useState)(0),2),Lt=Ot[0],At=Ot[1],Mt=(0,c.Z)().signal,Pt=(0,r.useCallback)((function(){H(void 0),F(null),U({})}),[H,F,U]),Dt=(0,r.useRef)(!1);(0,r.useEffect)((function(){Dt.current=S}),[S]);var Ft=(0,r.useCallback)((function(e){return function(e,t,n){var r=(0,oe.XX)(t,n),o={},i={};for(var a of e)if(a.file){var c;a.file=he(a.file,r);var l=null===(c=(0,oe.LZ)(t,a.file))||void 0===c?void 0:c.entity;if(l){l._id in o||(o[l._id]=[]);var s={id:a.key,entryIndex:o[l._id].length,row:a.line-1,type:"error"===a.level?"error":"warning",text:a.message,source:"compile",ruleId:a.ruleId};"typesetting"!==a.level&&(i[a.line]||(s.firstOnLine=!0,i[a.line]=!0)),o[l._id].push(s)}}return o}(e,x,se)}),[x,se]),Xt=(0,r.useRef)(Ft);(0,r.useEffect)((function(){Xt.current=Ft}),[Ft]);var Zt=Ce((0,r.useState)((function(){return new _({projectId:p,setChangedAt:At,setCompiling:I,setData:le,setFirstRenderDone:Ee,setDeliveryLatencies:Me,setError:Ge,cleanupCompileResult:Pt,compilingRef:Dt,signal:Mt})})),1)[0];(0,r.useEffect)((function(){Zt.currentDoc=St}),[Zt,St]),(0,r.useEffect)((function(){Zt.projectRootDocId=m}),[Zt,m]),(0,r.useEffect)((function(){Zt.setOption("draft",mt)}),[Zt,mt]),(0,r.useEffect)((function(){Zt.setOption("stopOnFirstError",yt)}),[Zt,yt]),(0,r.useEffect)((function(){Y(Lt>0)}),[Y,Lt]),(0,r.useEffect)((function(){ee(Lt>0)}),[ee,Lt]),(0,r.useEffect)((function(){!De&&St&&(Fe(!0),Zt.compile({isAutoCompileOnLoad:!0}))}),[De,St,Zt]),(0,r.useEffect)((function(){M(void 0!==(null==y?void 0:y.compileTimeout)&&y.compileTimeout<=60)}),[y]),(0,r.useEffect)((function(){if(A&&S&&u){var e=window.setTimeout((function(){O(!0)}),3e4);return function(){window.clearTimeout(e)}}}),[S,u,A]);var Rt=(0,Se.ye)("compile-log-events"),Ut=(0,r.useRef)(null),Nt=(0,r.useRef)({}),Wt=(0,r.useCallback)((function(e){Nt.current[e]=!0}),[]);(0,r.useEffect)((function(){var e=new AbortController,t=Nt.current;if(Nt.current={},ce){if(ce.clsiServerId&&re(ce.clsiServerId),ce.outputFiles){var n=new Map;for(var r of ce.outputFiles)n.set(r.path,r);"success"===ce.status&&H(function(e,t,n){var r=e.get("output.pdf");if(!r)return null;var o=new URLSearchParams({compileGroup:n.compileGroup});return n.clsiServerId&&o.set("clsiserverid",n.clsiServerId),h.ns&&o.set("enable_pdf_caching","true"),r.pdfUrl="".concat(fe(r,n.pdfDownloadDomain),"?").concat(o),o.set("popupDownload","true"),r.pdfDownloadUrl="/download/project/".concat(t,"/build/").concat(r.build,"/output/output.pdf?").concat(o),r}(n,p,ce)),Ke(function(e,t,n,r){var o={top:[],other:[]};if(e){var i=new URLSearchParams;t&&i.set("clsiserverid",t),n&&i.set("compileGroup",n);var a=i.toString(),c=[];for(var l of e.values())be.includes(l.path)||(l.main=l.path.startsWith("output."),a.length&&(l.url+="?".concat(a)),c.push(l));for(var s of(c.sort((function(e,t){return e.main&&!t.main?-1:t.main&&!e.main?1:e.path.localeCompare(t.path,void 0,{numeric:!0})})),c))_e.includes(s.type)?o.top.push(s):"pdf"===s.type&&!0===s.main||o.other.push(s);var u=[].concat(ve(o.top),ve(o.other));r&&u.length>0&&(u.forEach((function(e){return i.append("files",e.path)})),o.archive={...r,fileCount:u.length,url:"".concat(r.url,"?").concat(i.toString())})}return o}(n,ce.clsiServerId,ce.compileGroup,ce.outputFilesArchive)),U(null),F(null),tt(void 0),de(n,ce,e.signal).then((function(e){if(tt(e.log),F(e.logEntries),U(Xt.current(e.logEntries.all)),!w&&(["success","stopped-on-first-error"].includes(ce.status)&&(0,b.mP)("compile-result",{errors:e.logEntries.errors.length,warnings:e.logEntries.warnings.length,typesetting:e.logEntries.typesetting.length,newPdfPreview:!0,stopOnFirstError:ce.options.stopOnFirstError},.01),Rt||k)){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={};for(var n of e){var r="".concat(n.level,"_").concat(n.ruleId);t[r]=t[r]?t[r]+1:1}return t}(e.logEntries.all),r=Ut.current;Ut.current=n;var o=r?function(e,t){var n={};for(var r of Object.entries(e)){var o,i=ie(r,2),a=i[0],c=i[1],l=null!==(o=t[a])&&void 0!==o?o:0;n["delta_".concat(a)]=c-l}for(var s of Object.entries(t)){var u=ie(s,2),d=u[0],f=u[1];d in e||(n[d]=0,n["delta_".concat(d)]=-f)}return n}(n,r):{};(0,b.BZ)("compile-log-entries",{status:ce.status,stopOnFirstError:ce.options.stopOnFirstError,isAutoCompileOnLoad:!!ce.options.isAutoCompileOnLoad,isAutoCompileOnChange:!!ce.options.isAutoCompileOnChange,...t,...n,...o})}}))}switch(ce.status){case"success":Ge(void 0),We(!1);break;case"stopped-on-first-error":Ge(void 0),We(!0);break;case"clsi-maintenance":case"compile-in-progress":case"exited":case"failure":case"project-too-large":case"rate-limited":case"terminated":case"too-recently-compiled":Ge(ce.status);break;case"timedout":Ge("timedout"),!s&&u&&(0,b.lW)("subscription-funnel","editor-click-feature","compile-timeout");break;case"autocompile-backoff":ce.options.isAutoCompileOnLoad||(Ge("autocompile-disabled"),ht(!1));break;case"unavailable":Ge("clsi-unavailable");break;case"validation-problems":Ge("validation-problems"),ot(ce.validationProblems);break;default:Ge("error")}kt("stopped-on-first-error"===ce.status)}return function(){e.abort()}}),[ce,n,w,k,y,Rt,s,u,p,ht,re,F,U,H]),(0,r.useEffect)((function(){He&&We(!0)}),[He]);var $t=Boolean(ft&&$&&Ct),Bt=jt&&$t,qt=Boolean(ft&&g&&!Bt),Vt=Boolean(qt&&J&&De);(0,r.useEffect)((function(){qt?Lt>0&&Zt.debouncedAutoCompile():Zt.debouncedAutoCompile.cancel()}),[Zt,qt,Lt]),(0,r.useEffect)((function(){return function(){Zt.debouncedAutoCompile.cancel()}}),[Zt]);var zt=(0,r.useCallback)((function(e){Zt.compile(e)}),[Zt]),Ht=(0,r.useCallback)((function(){Zt.stopCompile()}),[Zt]),Gt=(0,r.useCallback)((function(){return Re(!0),Zt.clearCache().then((function(){Ke(void 0),H(void 0)})).finally((function(){Re(!1)}))}),[Zt]),Jt=(0,r.useCallback)((function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=j(e.file);o&&"doc"===o.type&&d(o.entity._id,{gotoLine:null!==(t=e.line)&&void 0!==t?t:void 0,gotoColumn:null!==(n=e.column)&&void 0!==n?n:void 0,keepCurrentView:r})}),[j,d]),Yt=(0,r.useCallback)((function(){Gt().then((function(){Zt.compile()}))}),[Gt,Zt]),Kt=(0,r.useMemo)((function(){return(null==ce?void 0:ce.options)||{}}),[ce]);(0,r.useEffect)((function(){var e=function(e){We(e.detail)};return window.addEventListener("editor:show-logs",e),function(){window.removeEventListener("editor:show-logs",e)}}),[]);var Qt=(0,r.useMemo)((function(){return{animateCompileDropdownArrow:Be,autoCompile:ft,clearCache:Gt,clearingCache:Ze,clsiServerId:ne,codeCheckFailed:Bt,compiling:S,deliveryLatencies:Ae,draft:mt,editedSinceCompileStarted:Q,error:He,fileList:Ye,hasChanges:Vt,hasShortCompileTimeout:A,highlights:at,isProjectOwner:u,lastCompileOptions:Kt,logEntryAnnotations:R,logEntries:D,pdfDownloadUrl:null==z?void 0:z.pdfDownloadUrl,pdfFile:z,pdfUrl:null==z?void 0:z.pdfUrl,pdfViewer:W,position:st,rawLog:et,recompileFromScratch:Yt,setAnimateCompileDropdownArrow:qe,setAutoCompile:ht,setCompiling:I,setDraft:gt,setError:Ge,setHasLintingError:Et,setHighlights:ct,setPosition:ut,showCompileTimeWarning:E,setShowCompileTimeWarning:O,setShowLogs:We,toggleLogs:Ve,setStopOnFirstError:_t,setStopOnValidationError:Tt,showLogs:Ne,startCompile:zt,stopCompile:Ht,stopOnFirstError:yt,stopOnValidationError:jt,stoppedOnFirstError:wt,uncompiled:J,validationIssues:rt,firstRenderDone:ye,setChangedAt:At,cleanupCompileResult:Pt,syncToEntry:Jt,recordAction:Wt}}),[Be,ft,Gt,Ze,ne,Bt,S,Ae,mt,Q,He,Ye,Vt,A,at,u,Kt,D,R,st,z,W,et,Yt,qe,ht,gt,Ge,Et,ct,ut,O,_t,Tt,E,Ne,zt,Ht,yt,jt,wt,J,rt,ye,At,Pt,We,Ve,Jt,Wt]);return(0,X.jsx)(Oe.Provider,{value:Qt,children:t})};function Ae(){var e=(0,r.useContext)(Oe);if(!e)throw new Error("useLocalCompileContext is only available inside LocalCompileProvider");return e}},72526:function(e,t,n){"use strict";n.d(t,{d:function(){return u},j:function(){return f}});n(71372),n(26936),n(43450),n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(27233),n(77950),n(21850);var r=n(2784),o=n(37246),i=n(66041),a=n(52322);function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=(0,r.createContext)(void 0);function u(){var e=(0,r.useContext)(s);if(!e)throw new Error("useProjectContext is only available inside ProjectProvider");return e}var d={_id:(0,i.Z)("ol-project_id"),name:"",features:{}},f=function(e){var t=e.children,n=c((0,o.Z)("project"),1)[0]||d,l=n._id,u=n.compiler,f=n.name,h=n.rootDoc_id,p=n.members,m=n.invites,g=n.features,v=n.publicAccesLevel,y=n.owner,_=n.trackChangesState,b=(0,r.useMemo)((function(){return((0,i.Z)("ol-projectTags")||[]).map((function(e){var t;return{...e,name:null!==(t=e.name)&&void 0!==t?t:""}}))}),[]),w=(0,r.useMemo)((function(){return{_id:l,compiler:u,name:f,rootDocId:h,members:p,invites:m,features:g,publicAccessLevel:v,owner:y,tags:b,trackChangesState:_}}),[l,u,f,h,p,m,g,v,y,b,_]);return(0,a.jsx)(s.Provider,{value:w,children:t})}},22276:function(e,t,n){"use strict";n.d(t,{_8:function(){return c},yW:function(){return l},ye:function(){return s}});n(71372);var r=n(2784),o=n(66041),i=n(52322),a=(0,r.createContext)(void 0),c=function(e){var t=e.children,n=(0,r.useMemo)((function(){return{splitTestVariants:(0,o.Z)("ol-splitTestVariants")||{},splitTestInfo:(0,o.Z)("ol-splitTestInfo")||{}}}),[]);return(0,i.jsx)(a.Provider,{value:n,children:t})};function l(){var e=(0,r.useContext)(a);if(!e)throw new Error("useSplitTestContext is only available within SplitTestProvider");return e}function s(e){return"enabled"===l().splitTestVariants[e]}},63290:function(e,t,n){"use strict";n.d(t,{SE:function(){return l},dr:function(){return c}});n(71372);var r=n(2784),o=n(66041),i=n(52322),a=(0,r.createContext)(void 0),c=function(e){var t=e.children,n=(0,r.useMemo)((function(){return(0,o.Z)("ol-user")}),[]);return(0,i.jsx)(a.Provider,{value:n,children:t})};function l(){var e=(0,r.useContext)(a);if(!e)throw new Error("useUserContext is only available inside UserContext, or `ol-user` meta is not defined");return e}},72309:function(e,t,n){"use strict";n.d(t,{B9:function(){return u},cq:function(){return d}});n(71372),n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850);var r=n(2784),o=n(66041),i=n(52322);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l={pdfViewer:"pdfjs",autoComplete:!0,autoPairDelimiters:!0,syntaxValidation:!1,editorTheme:"textmate",overallTheme:"",mode:"default",fontSize:12,fontFamily:"monaco",lineHeight:"normal"},s=(0,r.createContext)(void 0),u=function(e){var t=e.children,n=a((0,r.useState)((function(){return(0,o.Z)("ol-userSettings")||l})),2),c=n[0],u=n[1],d=(0,r.useMemo)((function(){return{userSettings:c,setUserSettings:u}}),[c,u]);return(0,r.useEffect)((function(){window.dispatchEvent(new CustomEvent("settings:change",{detail:c}))}),[c]),(0,i.jsx)(s.Provider,{value:d,children:t})};function d(){var e=(0,r.useContext)(s);if(!e)throw new Error("useUserSettingsContext is only available inside UserSettingsProvider");return e}},30286:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372),n(46533);var r=n(2784);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(){var e=o((0,r.useState)((function(){return new AbortController})),1)[0];return(0,r.useEffect)((function(){return function(){e.abort()}}),[e]),e}},73091:function(e,t,n){"use strict";n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372);var r=n(2784);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a,c=!1,l="";function s(e){document.hasFocus()||c||(l=window.document.title,window.document.title=e,c=!0,a=setInterval((function(){window.document.title===l?window.document.title=e:window.document.title=l}),800))}function u(){c&&(clearInterval(a),window.document.title=l,l="",c=!1)}function d(e){c?l=e:window.document.title=e}t.Z=function(){var e=o((0,r.useState)((function(){return document.hasFocus()})),2),t=e[0],n=e[1];return(0,r.useEffect)((function(){function e(){n(!0)}function t(){n(!1)}return window.addEventListener("focus",e),window.addEventListener("blur",t),function(){window.removeEventListener("focus",e),window.removeEventListener("blur",t)}}),[]),{hasFocus:t,flashTitle:s,stopFlashingTitle:u,setTitle:d}}},92242:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(2784),o=n(76635),i=n.n(o);function a(e,t){var n=(0,r.useRef)();return(0,r.useEffect)((function(){i().isEqual(t,n.current)||(n.current=t,e())}),t)}},83976:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});n(18178),n(26936),n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(27233),n(32501),n(88233),n(77950),n(21850),n(71372);var r=n(2784),o=n(99834),i=n(66041),a=n(45177);function c(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=(0,i.Z)("ol-debugPdfDetach");function u(e,t,n,i){var l=(0,o.JY)(),u=l.role,d=l.broadcastEvent,f=l.addEventHandler,h=l.deleteEventHandler,p="action-".concat(e),m=(0,r.useCallback)((function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];u===n?d(p,{args:r}):t.apply(void 0,r)}),[u,n,p,t,d]),g=(0,r.useCallback)((function(e){e.event===p&&u===i&&(s&&a.c.warn("Do ".concat(t.name," on event ").concat(p)),t.apply(void 0,c(e.data.args)))}),[u,i,p,t]);return(0,r.useEffect)((function(){return f(g),function(){return h(g)}}),[f,h,g]),m}},41740:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});n(58188),n(88233),n(34115),n(634),n(20796),n(15735),n(28673),n(6886),n(32501),n(26936),n(27233),n(77950),n(21850),n(71372);var r=n(2784),o=n(99834),i=n(66041),a=n(79862),c=n(96227),l=n(44694),s=n(45177);function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=(0,i.Z)("ol-debugPdfDetach"),h=6e4,p=1e4;function m(){var e=(0,o.JY)(),t=e.role,n=e.setRole,i=e.broadcastEvent,d=e.addEventHandler,m=e.deleteEventHandler,g=u((0,r.useState)(!1),2),v=g[0],y=g[1],_=u((0,r.useState)(!1),2),b=_[0],w=_[1],k=u((0,r.useState)(!1),2),x=k[0],j=k[1],T=(0,r.useRef)();(0,r.useEffect)((function(){f&&s.c.warn("Effect",{isLinked:b}),y(!1)}),[b,y]),(0,r.useEffect)((function(){f&&s.c.warn("Effect",{role:t,isLinked:b}),"detached"===t&&b&&c.BZ("project-layout-detached")}),[t,b]),(0,r.useEffect)((function(){T.current&&clearTimeout(T.current),"detacher"===t&&!1===b&&(T.current=setTimeout((function(){n(null)}),v?h:p))}),[t,v,b,n]),(0,r.useEffect)((function(){f&&s.c.warn("Effect",{isLinking:v})}),[v]);var S=(0,l.Z)(t);(0,r.useEffect)((function(){S&&!t&&c.BZ("project-layout-reattached")}),[S,t]);var I=(0,r.useCallback)((function(){i("reattach"),n(null),w(!1)}),[n,w,i]),C=(0,r.useCallback)((function(){j(!1),n("detacher"),y(!0),window.open((0,a.g)("detached").toString(),"_blank")}),[n,y]),E=(0,r.useCallback)((function(){f&&s.c.warn("Duplicate detacher detected, turning into a regular editor again"),j(!0),w(!1),n(null)}),[n,w]),O=(0,r.useCallback)((function(e){switch(e.event){case"connected":i("up"),w(!0);break;case"up":w(!0);break;case"closed":w(!1)}}),[w,i]),L=(0,r.useCallback)((function(e){switch(e.event){case"connected":i("up"),w(!0);break;case"up":w(!0);break;case"closed":w(!1);break;case"reattach":w(!1),window.close()}}),[w,i]),A=(0,r.useCallback)((function(e){if("closed"===e.event)i("up")}),[i]),M=(0,r.useCallback)((function(e){"detacher"===t?"detacher"===e.role?E():"detached"===e.role&&O(e):"detached"===t&&("detacher"===e.role?L(e):"detached"===e.role&&A(e))}),[t,E,O,L,A]);return(0,r.useEffect)((function(){return d(M),function(){return m(M)}}),[d,m,M]),{reattach:I,detach:C,isLinked:b,isLinking:v,role:t,isRedundant:x}}},69565:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});n(18178),n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372);var r=n(2784),o=n(99834),i=n(66041),a=n(45177);function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=(0,i.Z)("ol-debugPdfDetach");function u(e,t,n,i){var l=c((0,r.useState)(t),2),u=l[0],d=l[1],f=(0,o.JY)(),h=f.role,p=f.broadcastEvent,m=f.lastDetachedConnectedAt,g=f.addEventHandler,v=f.deleteEventHandler,y="state-".concat(e);(0,r.useEffect)((function(){h===n&&p(y,{value:u})}),[h,n,y,u,p,m]);var _=(0,r.useCallback)((function(e){e.event===y&&h===i&&(s&&a.c.warn("Set ".concat(e.data.value," for ").concat(y)),d(e.data.value))}),[h,i,y,d]);return(0,r.useEffect)((function(){return g(_),function(){return v(_)}}),[g,v,_]),[u,d]}},47417:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372);var r=n(2784),o=n(28316);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=i((0,r.useState)(e),2),n=t[0],a=t[1],c=(0,r.useRef)(null),l=(0,r.useCallback)((function(e){e&&(c.current=(0,o.findDOMNode)(e))}),[c]),s=(0,r.useCallback)((function(e){e.stopPropagation()}),[]),u=(0,r.useCallback)((function(e){a(e)}),[]),d=(0,r.useCallback)((function(e){c.current&&!c.current.contains(e.target)&&a(!1)}),[c]);return(0,r.useEffect)((function(){return n&&document.addEventListener("mousedown",d),function(){document.removeEventListener("mousedown",d)}}),[n,d]),{ref:l,onClick:s,onToggle:u,open:n}}},32687:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(2784);function o(e,t){(0,r.useEffect)((function(){return window.addEventListener(e,t),function(){window.removeEventListener(e,t)}}),[e,t])}},18977:function(e,t,n){"use strict";n(6710),n(34769),n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372);var r=n(2784),o=n(76635),i=n.n(o),a=n(76066),c=n(45177);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.Z=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=(0,r.useCallback)((function(e){var t=a.Z.getItem(e);return o?function(e){try{return JSON.parse(e)}catch(e){return c.c.error("double parse exception",e),null}}(t):t}),[o]),u=(0,r.useCallback)((function(e,t){var n=o?function(e){try{return JSON.stringify(e)}catch(e){return c.c.error("double stringify exception",e),null}}(t):t;a.Z.setItem(e,n)}),[o]),d=l((0,r.useState)((function(){var n;return null!==(n=s(e))&&void 0!==n?n:t})),2),f=d[0],h=d[1],p=(0,r.useCallback)((function(n){h((function(r){var o=i().isFunction(n)?n(r):n;return o===t?a.Z.removeItem(e):u(e,o),o}))}),[e,t,u]);return(0,r.useEffect)((function(){if(n){var r=function(n){var r;n.key===e&&h(null!==(r=s(e))&&void 0!==r?r:t)};return window.addEventListener("storage",r),function(){window.removeEventListener("storage",r)}}}),[t,e,n,s]),[f,p]}},44694:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(2784);function o(e){var t=(0,r.useRef)();return(0,r.useEffect)((function(){t.current=e})),t.current}},25897:function(e,t,n){"use strict";n.d(t,{y:function(){return a}});n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372);var r=n(2784);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(e){var t=(0,r.useRef)(null),n=(0,r.useCallback)((function(n){if(n&&"ResizeObserver"in window){t.current&&t.current.observer.unobserve(t.current.element);var r=new ResizeObserver((function(t){var n=o(t,1)[0];e(n.target)}));t.current={element:n,observer:r},r.observe(n),e(n)}}),[e]);return(0,r.useEffect)((function(){return function(){t.current&&t.current.observer.unobserve(t.current.element)}}),[]),{elementRef:n,resizeRef:t}}},44466:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});n(18178);var r=n(2784),o=n(96931);function i(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(0,o.IM)().scopeEventEmitter;return(0,r.useCallback)((function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];n.emit.apply(n,[e,t].concat(o))}),[n,e,t])}},51294:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(2784),o=n(96931);function i(e,t){var n=(0,o.IM)().scopeEventEmitter;(0,r.useEffect)((function(){return n.on(e,t)}),[n,e,t])}},32967:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372);var r=n(2784),o=n(96931),i=n(76635),a=n.n(i);function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){var n=(0,o.IM)().scopeStore,i=c((0,r.useState)(t),2),l=i[0],s=i[1];return[l,(0,r.useCallback)((function(t){s((function(r){var o=a().isFunction(t)?t(r):t;return n.set(e,o),o}))}),[e,n])]}},37246:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});n(34115),n(634),n(58188),n(20796),n(15735),n(28673),n(6886),n(32501),n(88233),n(26936),n(27233),n(77950),n(21850),n(71372);var r=n(2784),o=n(76635),i=n.n(o),a=n(96931);function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e){var t=(0,a.IM)().scopeStore,n=c((0,r.useState)((function(){return t.get(e)})),2),o=n[0],l=n[1];return(0,r.useEffect)((function(){return t.watch(e,(function(e){l((function(){return e}))}))}),[e,t]),[o,(0,r.useCallback)((function(n){l((function(r){var o=i().isFunction(n)?n(r):n;return t.set(e,o),o}))}),[e,t])]}},49819:function(e,t,n){"use strict";var r=n(84050),o=n(66041);t.Z=function(){var e=(0,r._i)().permissionsLevel;return(0,o.Z)("ol-linkSharingWarning")&&"readOnly"===e}},92193:function(e,t,n){"use strict";function r(e){var t,n="0123456789abcdef";function r(e){var t,r="";for(t=0;t<=3;t++)r+=n.charAt(e>>8*t+4&15)+n.charAt(e>>8*t&15);return r}function o(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function i(e,t,n,r,i,a){return o(function(e,t){return e<<t|e>>>32-t}(o(o(t,e),o(r,a)),i),n)}function a(e,t,n,r,o,a,c){return i(t&n|~t&r,e,t,o,a,c)}function c(e,t,n,r,o,a,c){return i(t&r|n&~r,e,t,o,a,c)}function l(e,t,n,r,o,a,c){return i(t^n^r,e,t,o,a,c)}function s(e,t,n,r,o,a,c){return i(n^(t|~r),e,t,o,a,c)}var u,d,f,h,p=function(e){var t,n=1+(e.length+8>>6),r=new Array(16*n);for(t=0;t<16*n;t++)r[t]=0;for(t=0;t<e.length;t++)r[t>>2]|=e.charCodeAt(t)<<t%4*8;return r[t>>2]|=128<<t%4*8,r[16*n-2]=8*e.length,r}(""+e),m=1732584193,g=-271733879,v=-1732584194,y=271733878;for(t=0;t<p.length;t+=16)u=m,d=g,f=v,h=y,m=a(m,g,v,y,p[t+0],7,-680876936),y=a(y,m,g,v,p[t+1],12,-389564586),v=a(v,y,m,g,p[t+2],17,606105819),g=a(g,v,y,m,p[t+3],22,-1044525330),m=a(m,g,v,y,p[t+4],7,-176418897),y=a(y,m,g,v,p[t+5],12,1200080426),v=a(v,y,m,g,p[t+6],17,-1473231341),g=a(g,v,y,m,p[t+7],22,-45705983),m=a(m,g,v,y,p[t+8],7,1770035416),y=a(y,m,g,v,p[t+9],12,-1958414417),v=a(v,y,m,g,p[t+10],17,-42063),g=a(g,v,y,m,p[t+11],22,-1990404162),m=a(m,g,v,y,p[t+12],7,1804603682),y=a(y,m,g,v,p[t+13],12,-40341101),v=a(v,y,m,g,p[t+14],17,-1502002290),m=c(m,g=a(g,v,y,m,p[t+15],22,1236535329),v,y,p[t+1],5,-165796510),y=c(y,m,g,v,p[t+6],9,-1069501632),v=c(v,y,m,g,p[t+11],14,643717713),g=c(g,v,y,m,p[t+0],20,-373897302),m=c(m,g,v,y,p[t+5],5,-701558691),y=c(y,m,g,v,p[t+10],9,38016083),v=c(v,y,m,g,p[t+15],14,-660478335),g=c(g,v,y,m,p[t+4],20,-405537848),m=c(m,g,v,y,p[t+9],5,568446438),y=c(y,m,g,v,p[t+14],9,-1019803690),v=c(v,y,m,g,p[t+3],14,-187363961),g=c(g,v,y,m,p[t+8],20,1163531501),m=c(m,g,v,y,p[t+13],5,-1444681467),y=c(y,m,g,v,p[t+2],9,-51403784),v=c(v,y,m,g,p[t+7],14,1735328473),m=l(m,g=c(g,v,y,m,p[t+12],20,-1926607734),v,y,p[t+5],4,-378558),y=l(y,m,g,v,p[t+8],11,-2022574463),v=l(v,y,m,g,p[t+11],16,1839030562),g=l(g,v,y,m,p[t+14],23,-35309556),m=l(m,g,v,y,p[t+1],4,-1530992060),y=l(y,m,g,v,p[t+4],11,1272893353),v=l(v,y,m,g,p[t+7],16,-155497632),g=l(g,v,y,m,p[t+10],23,-1094730640),m=l(m,g,v,y,p[t+13],4,681279174),y=l(y,m,g,v,p[t+0],11,-358537222),v=l(v,y,m,g,p[t+3],16,-722521979),g=l(g,v,y,m,p[t+6],23,76029189),m=l(m,g,v,y,p[t+9],4,-640364487),y=l(y,m,g,v,p[t+12],11,-421815835),v=l(v,y,m,g,p[t+15],16,530742520),m=s(m,g=l(g,v,y,m,p[t+2],23,-995338651),v,y,p[t+0],6,-198630844),y=s(y,m,g,v,p[t+7],10,1126891415),v=s(v,y,m,g,p[t+14],15,-1416354905),g=s(g,v,y,m,p[t+5],21,-57434055),m=s(m,g,v,y,p[t+12],6,1700485571),y=s(y,m,g,v,p[t+3],10,-1894986606),v=s(v,y,m,g,p[t+10],15,-1051523),g=s(g,v,y,m,p[t+1],21,-2054922799),m=s(m,g,v,y,p[t+8],6,1873313359),y=s(y,m,g,v,p[t+15],10,-30611744),v=s(v,y,m,g,p[t+6],15,-1560198380),g=s(g,v,y,m,p[t+13],21,1309151649),m=s(m,g,v,y,p[t+4],6,-145523070),y=s(y,m,g,v,p[t+11],10,-1120210379),v=s(v,y,m,g,p[t+2],15,718787259),g=s(g,v,y,m,p[t+9],21,-343485551),m=o(m,u),g=o(g,d),v=o(v,f),y=o(y,h);return r(m)+r(g)+r(v)+r(y)}n.d(t,{M:function(){return r}})},42957:function(e,t,n){"use strict";n.d(t,{Y:function(){return r}});n(16781),n(43450),n(35734),n(58188),n(88233);function r(e){var t=(new TextEncoder).encode(e),n=function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t}(t),r=8*t.length,o=[],i=1732584193,a=-271733879,c=-1732584194,l=271733878,s=-1009589776;n[r>>5]|=128<<24-r%32,n[15+(r+64>>>9<<4)]=r;for(var u=0;u<n.length;u+=16){for(var d=i,f=a,h=c,p=l,m=s,g=0;g<80;g++){if(g<16)o[g]=n[u+g];else{var v=o[g-3]^o[g-8]^o[g-14]^o[g-16];o[g]=v<<1|v>>>31}var y=(i<<5|i>>>27)+s+(o[g]>>>0)+(g<20?1518500249+(a&c|~a&l):g<40?1859775393+(a^c^l):g<60?(a&c|a&l|c&l)-1894007588:(a^c^l)-899497514);s=l,l=c,c=a<<30|a>>>2,a=i,i=y}i+=d,a+=f,c+=h,l+=p,s+=m}var _=function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t}([i,a,c,l,s]);return _.map((function(e){return e.toString(16).padStart(2,"0")})).join("")}},79862:function(e,t,n){"use strict";n.d(t,{g:function(){return r}});n(15735),n(58188),n(28673),n(6886),n(14121),n(60523),n(28399),n(77950),n(85940);function r(e){var t=new URL(window.location),n=t.pathname.replace(/\/(detached|detacher)\/?$/,"").replace(/\/$/,"");return e&&(n+="/".concat(e)),t.pathname=n,t}},78297:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});n(27233),n(28673),n(95342),n(58188),n(1939),n(9575),n(96264),n(34115),n(634),n(71372),n(71245),n(20796),n(15735),n(6886),n(32501),n(88233),n(26936),n(77950),n(21850);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],l=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:String(t)}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.events={}}var t,n,r;return t=e,n=[{key:"on",value:function(e,t){var n;this.events||(this.events={});var r=o(Array.from(e.split(".")),2);e=r[0],n=r[1],this.events[e]||(this.events[e]=[]),this.events[e].push({callback:t,namespace:n})}},{key:"off",value:function(e,t){if(this.events||(this.events={}),e){var n,r=o(e.split("."),2);e=r[0],n=r[1],this.events[e]||(this.events[e]=[]),t?this.events[e]=this.events[e].filter((function(e){return e.callback!==t})):n?this.events[e]=this.events[e].filter((function(e){return e.namespace!==n})):delete this.events[e]}else this.events={}}},{key:"trigger",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.events||(this.events={}),this.events[e]&&this.events[e].forEach((function(e){return e.callback.apply(e,n)}))}},{key:"emit",value:function(){this.trigger.apply(this,arguments)}}],n&&a(t.prototype,n),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},45177:function(e,t,n){"use strict";n.d(t,{c:function(){return o},j:function(){return r}});n(15735),n(58188),n(28673),n(6886),n(60523),n(28399),n(77950),n(94908);var r="true"===new URLSearchParams(window.location.search).get("debug"),o=r?console:{debug:function(){},log:function(){},warn:console.warn,error:console.error}},8846:function(e,t,n){"use strict";n.d(t,{w:function(){return r}});n(58188),n(1939);function r(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.forEach((function(e){return null==e?void 0:e.apply(void 0,n)}))}}},13684:function(e,t,n){"use strict";n.d(t,{A2:function(){return o},Zh:function(){return i},wM:function(){return r}});var r=function(e){return"i"in e},o=function(e){return"c"in e},i=function(e){return"d"in e}},58976:function(e,t,n){"use strict";n.d(t,{Q:function(){return u}});var r=n(42957),o=n(45177),i=n(66041);e=n.hmd(e);var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}const{Doc:u}=(()=>{var e,t,n,u=void 0;window.sharejs=u={};var d=u.types={};u._bt=t=function(e,t,n,r){var o=void 0;return e.transformX=e.transformX=o=function(e,i){n(e),n(i);var a,c,s,u=[],d=!0,f=!1,h=void 0;try{for(var p,m=Array.from(i)[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){for(var g=p.value,v=[],y=0;y<e.length;){var _,b=[];if(a=e[y],s=b,t(v,a,c=g,"left"),t(s,c,a,"right"),y++,1!==b.length){if(0===b.length){var w=!0,k=!1,x=void 0;try{for(var j,T=Array.from(e.slice(y))[Symbol.iterator]();!(w=(j=T.next()).done);w=!0)_=j.value,r(v,_)}catch(e){k=!0,x=e}finally{try{!w&&T.return&&T.return()}finally{if(k)throw x}}g=null;break}var S=Array.from(o(e.slice(y),b)),I=l(S,2),C=I[0],E=I[1],O=!0,L=!1,A=void 0;try{for(var M,P=Array.from(C)[Symbol.iterator]();!(O=(M=P.next()).done);O=!0)_=M.value,r(v,_)}catch(e){L=!0,A=e}finally{try{!O&&P.return&&P.return()}finally{if(L)throw A}}var D=!0,F=!1,X=void 0;try{for(var Z,R=Array.from(E)[Symbol.iterator]();!(D=(Z=R.next()).done);D=!0){var U=Z.value;r(u,U)}}catch(e){F=!0,X=e}finally{try{!D&&R.return&&R.return()}finally{if(F)throw X}}g=null;break}g=b[0]}null!=g&&r(u,g),e=v}}catch(e){f=!0,h=e}finally{try{!d&&m.return&&m.return()}finally{if(f)throw h}}return[e,u]},e.transform=e.transform=function(e,n,r){if("left"!==r&&"right"!==r)throw new Error("type must be 'left' or 'right'");if(0===n.length)return e;if(1===e.length&&1===n.length)return t([],e[0],n[0],r);if("left"===r){var i,a=Array.from(o(e,n)),c=l(a,2);return i=c[0],c[1],i}var s=Array.from(o(n,e)),u=l(s,2);return u[0],u[1]}};var f={name:"text",create:function(){return""}},h=function(e,t,n){return e.slice(0,t)+n+e.slice(t)},p=function(e){if("number"!=typeof e.p)throw new Error("component missing position field");if(!("string"===c(e.i)^"string"===c(e.d)^"string"===c(e.c)))throw new Error("component needs an i, d or c field");if(!(e.p>=0))throw new Error("position cannot be negative")},m=function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=Array.from(e)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;p(a)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return!0};f.apply=function(e,t){m(t);var n=!0,r=!1,o=void 0;try{for(var i,a=Array.from(t)[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var c=i.value;if(null!=c.i)e=h(e,c.p,c.i);else if(null!=c.d){var l=e.slice(c.p,c.p+c.d.length);if(c.d!==l)throw new Error("Delete component '"+c.d+"' does not match deleted text '"+l+"'");e=e.slice(0,c.p)+e.slice(c.p+c.d.length)}else{if(null==c.c)throw new Error("Unknown op type");var s=e.slice(c.p,c.p+c.c.length);if(c.c!==s)throw new Error("Comment component '"+c.c+"' does not match commented text '"+s+"'")}}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return e};var g=function(e,t){var n=void 0,r={};for(var o in e)n=e[o],r[o]=n;for(o in t)n=t[o],r[o]=n;return r};f._append=e=function(e,t){if(""!==t.i&&""!==t.d){if(0===e.length)return e.push(t);var n=e[e.length-1];return null!=n.i&&null!=t.i&&n.p<=t.p&&t.p<=n.p+n.i.length&&n.u===t.u?e[e.length-1]=g(n,{i:h(n.i,t.p-n.p,t.i)}):null!=n.d&&null!=t.d&&t.p<=n.p&&n.p<=t.p+t.d.length&&n.u===t.u?e[e.length-1]=g(n,{d:h(t.d,n.p-t.p,n.d),p:t.p}):e.push(t)}},f.compose=function(t,n){m(t),m(n);var r=t.slice(),o=!0,i=!1,a=void 0;try{for(var c,l=Array.from(n)[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var s=c.value;e(r,s)}}catch(e){i=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}return r},f.compress=function(e){return f.compose([],e)},f.normalize=function(t){var n=[];null==t.i&&null==t.p||(t=[t]);var r=!0,o=!1,i=void 0;try{for(var a,c=Array.from(t)[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var l=a.value;null==l.p&&(l.p=0),e(n,l)}}catch(e){o=!0,i=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw i}}return n};var v=function(e,t,n){if(null!=t.i)return t.p<e||t.p===e&&n?e+t.i.length:e;if(null!=t.d)return e<=t.p?e:e<=t.p+t.d.length?t.p:e-t.d.length;if(null!=t.c)return e;throw new Error("unknown op type")};f.transformCursor=function(e,t,n){var r="right"===n,o=!0,i=!1,a=void 0;try{for(var c,l=Array.from(t)[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var s=c.value;e=v(e,s,r)}}catch(e){i=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}return e},f._tc=n=function(t,n,r,o){var i=void 0,a=void 0,c=void 0;if(m([n]),m([r]),null!=n.i)e(t,g(n,{p:v(n.p,r,"right"===o)}));else if(null!=n.d)if(null!=r.i){var l=n.d;n.p<r.p&&(e(t,g(n,{d:l.slice(0,r.p-n.p)})),l=l.slice(r.p-n.p)),""!==l&&e(t,g(n,{d:l,p:n.p+r.i.length}))}else if(null!=r.d)if(n.p>=r.p+r.d.length)e(t,g(n,{p:n.p-r.d.length}));else if(n.p+n.d.length<=r.p)e(t,n);else{if(c=g(n,{d:""}),n.p<r.p&&(c.d=n.d.slice(0,r.p-n.p)),n.p+n.d.length>r.p+r.d.length&&(c.d+=n.d.slice(r.p+r.d.length-n.p)),a=Math.max(n.p,r.p),i=Math.min(n.p+n.d.length,r.p+r.d.length),n.d.slice(a-n.p,i-n.p)!==r.d.slice(a-r.p,i-r.p))throw new Error("Delete ops delete different text in the same region of the document");""!==c.d&&(c.p=v(c.p,r),e(t,c))}else{if(null==r.c)throw new Error("unknown op type");e(t,n)}else if(null!=n.c)if(null!=r.i)if(n.p<r.p&&r.p<n.p+n.c.length){var s=r.p-n.p,u=n.c.slice(0,+(s-1)+1||void 0)+r.i+n.c.slice(s);e(t,g(n,{c:u}))}else e(t,g(n,{p:v(n.p,r,!0)}));else if(null!=r.d)if(n.p>=r.p+r.d.length)e(t,g(n,{p:n.p-r.d.length}));else if(n.p+n.c.length<=r.p)e(t,n);else{if(c=g(n,{c:""}),n.p<r.p&&(c.c=n.c.slice(0,r.p-n.p)),n.p+n.c.length>r.p+r.d.length&&(c.c+=n.c.slice(r.p+r.d.length-n.p)),a=Math.max(n.p,r.p),i=Math.min(n.p+n.c.length,r.p+r.d.length),n.c.slice(a-n.p,i-n.p)!==r.d.slice(a-r.p,i-r.p))throw new Error("Delete ops delete different text in the same region of the document");c.p=v(c.p,r),e(t,c)}else{if(null==r.c)throw new Error("unknown op type");e(t,n)}return t};f.invert=function(e){return Array.from(e.slice().reverse()).map((function(e){return function(e){return null!=e.i?{d:e.i,p:e.p}:{i:e.d,p:e.p}}(e)}))},u.types||(u.types={}),t(f,n,m,e),u.types.text=f,f.api={provides:{text:!0},getLength:function(){return this.snapshot.length},getText:function(){return this.snapshot},insert:function(e,t,n,r){var o={p:e,i:t};return n&&(o.u=!0),o=[o],this.submitOp(o,r),o},del:function(e,t,n,r){var o={p:e,d:this.snapshot.slice(e,e+t)};return n&&(o.u=!0),o=[o],this.submitOp(o,r),o},_register:function(){return this.on("remoteop",(function(e){var t=this;return function(){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=Array.from(e)[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var l=a.value;void 0!==l.i?n.push(t.emit("insert",l.p,l.i)):void 0!==l.d?n.push(t.emit("delete",l.p,l.d)):n.push(void 0)}}catch(e){o=!0,i=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw i}}return n}()}))}};var y=function(e){return setTimeout(e,0)},_=function(){function e(){s(this,e)}return a(e,[{key:"on",value:function(e,t){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push(t),this}},{key:"removeListener",value:function(e,t){var n=this;this._events||(this._events={});for(var r=this._events[e]||(this._events[e]=[]),o=0;o<r.length;)r[o]===t&&(r[o]=void 0),o++;return y((function(){return n._events[e]=Array.from(n._events[e]).filter((function(e){return e}))})),this}},{key:"emit",value:function(e){if(!(null!=this._events?this._events[e]:void 0))return this;for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=!0,i=!1,a=void 0;try{for(var c,l=Array.from(this._events[e])[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var s=c.value;s&&s.apply(this,n)}}catch(e){i=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}return this}}]),e}();_.mixin=function(e){var t=e.prototype||e;return t.on=_.prototype.on,t.removeListener=_.prototype.removeListener,t.emit=_.prototype.emit,e},u.extendDoc=function(e,t){return b.prototype[e]=t};var b=function(){function e(t,n,r){s(this,e),this.flush=this.flush.bind(this),this.setFlushDelay=this.setFlushDelay.bind(this),this.shout=this.shout.bind(this),this.connection=t,this.name=n,r||(r={}),this.version=r.v,this.snapshot=r.snaphot,r.type&&this._setType(r.type),this.state="closed",this.autoOpen=!1,this._create=r.create,this.inflightOp=null,this.inflightCallbacks=[],this.inflightSubmittedIds=[],this.pendingOp=null,this.pendingCallbacks=[]}return a(e,[{key:"_xf",value:function(e,t){return this.type.transformX?this.type.transformX(e,t):[this.type.transform(e,t,"left"),this.type.transform(t,e,"right")]}},{key:"_otApply",value:function(e,t,n){var r=this.snapshot;if(this.snapshot=this.type.apply(this.snapshot,e),this.emit("change",e,r,n),t)return this.emit("remoteop",e,r,n)}},{key:"_connectionStateChanged",value:function(e,t){switch(e){case"disconnected":this.state="closed",this.inflightOp&&this.inflightSubmittedIds.push(this.connection.id),this.emit("closed");break;case"ok":this.autoOpen&&this.open();break;case"stopped":"function"==typeof this._openCallback&&this._openCallback(t)}return this.emit(e,t)}},{key:"_setType",value:function(e){if("string"==typeof e&&(e=d[e]),!e||!e.compose)throw new Error("Support for types without compose() is not implemented");if(this.type=e,e.api){for(var t in e.api){var n=e.api[t];this[t]=n}return"function"==typeof this._register?this._register():void 0}return this.provides={}}},{key:"_onMessage",value:function(e){if(!0===e.open){if(this.state="open",this._create=!1,null==this.created&&(this.created=!!e.create),e.type&&this._setType(e.type),e.create?(this.created=!0,this.snapshot=this.type.create()):(!0!==this.created&&(this.created=!1),void 0!==e.snapshot&&(this.snapshot=e.snapshot)),null!=e.v&&(this.version=e.v),this.inflightOp){var t={doc:this.name,op:this.inflightOp,v:this.version};this.inflightSubmittedIds.length&&(t.dupIfSource=this.inflightSubmittedIds),this.connection.send(t)}else this.flush();return this.emit("open"),"function"==typeof this._openCallback?this._openCallback(null):void 0}if(!1===e.open)return e.error&&(o.c.error("Could not open document: "+e.error),this.emit("error",e.error),"function"==typeof this._openCallback&&this._openCallback(e.error)),this.state="closed",this.emit("closed"),"function"==typeof this._closeCallback&&this._closeCallback(),this._closeCallback=null;if(null!==e.op||"Op already submitted"!==r){if(void 0===e.op&&void 0!==e.v||e.op&&Array.from(this.inflightSubmittedIds).includes(e.meta.source)){var n=this.inflightOp;this.inflightOp=null,this.inflightSubmittedIds.length=0,null===this.pendingOp&&this.emit("saved");var r=e.error;if(r){if(this.type.invert){var i=this.type.invert(n);if(this.pendingOp){var a=Array.from(this._xf(this.pendingOp,i)),c=l(a,2);this.pendingOp=c[0],i=c[1]}this._otApply(i,!0,e)}else this.emit("error","Op apply failed ("+r+") and the op could not be reverted");var s=!0,u=!1,d=void 0;try{for(var f,h=Array.from(this.inflightCallbacks)[Symbol.iterator]();!(s=(f=h.next()).done);s=!0)(0,f.value)(r)}catch(e){u=!0,d=e}finally{try{!s&&h.return&&h.return()}finally{if(u)throw d}}}else{if(e.v<this.version)return;if(e.v!==this.version)throw new Error("Invalid version from server");this.version++,this.emit("acknowledge",n);var p=!0,m=!1,g=void 0;try{for(var v,y=Array.from(this.inflightCallbacks)[Symbol.iterator]();!(p=(v=y.next()).done);p=!0)(0,v.value)(null,n)}catch(e){m=!0,g=e}finally{try{!p&&y.return&&y.return()}finally{if(m)throw g}}}return this.delayedFlush()}if(e.op){if(e.v<this.version)return;if(e.doc!==this.name)return this.emit("error","Expected docName '"+this.name+"' but got "+e.doc);if(e.v!==this.version)return this.emit("error","Expected version "+this.version+" but got "+e.v);var _=e.op;if(null!==this.inflightOp){var b=Array.from(this._xf(this.inflightOp,_)),w=l(b,2);this.inflightOp=w[0],_=w[1]}if(null!==this.pendingOp){var k=Array.from(this._xf(this.pendingOp,_)),x=l(k,2);this.pendingOp=x[0],_=x[1]}return this.version++,this._otApply(_,!0,e)}if(e.meta){var j=e.meta,T=j.path,S=j.value;return"shout"===(null!=T?T[0]:void 0)?this.emit("shout",S):o.c.warn("Unhandled meta op:",e)}return o.c.warn("Unhandled document message:",e)}}},{key:"flush",value:function(){if(this.flushTimeout=null,"ok"===this.connection.state&&null===this.inflightOp&&null!==this.pendingOp){if(this.inflightOp=this.pendingOp,this.inflightCallbacks=this.pendingCallbacks,this.pendingOp=null,this.pendingCallbacks=[],this.emit("flipped_pending_to_inflight"),(0,i.Z)("ol-useShareJsHash")||o.j){var e=Date.now(),t=this.__lastSubmitTimestamp&&e-this.__lastSubmitTimestamp;if(!this.__lastSubmitTimestamp||t>5e3||t<0||o.j){var n=(0,r.Y)("blob "+this.snapshot.length+"\0"+this.snapshot);this.__lastSubmitTimestamp=e}}var a=this.__lastVersion;return this.__lastVersion=this.version,this.connection.send({doc:this.name,op:this.inflightOp,v:this.version,lastV:a,hash:n})}}},{key:"submitOp",value:function(e,t){null!=this.type.normalize&&(e=this.type.normalize(e));var n=this.snapshot;return this.snapshot=this.type.apply(this.snapshot,e),null!==this.pendingOp?this.pendingOp=this.type.compose(this.pendingOp,e):this.pendingOp=e,t&&this.pendingCallbacks.push(t),this.emit("change",e,n),this.delayedFlush()}},{key:"delayedFlush",value:function(){if(null==this.flushTimeout)return this.flushTimeout=setTimeout(this.flush,this._flushDelay||0)}},{key:"setFlushDelay",value:function(e){return this._flushDelay=e}},{key:"shout",value:function(e){return this.connection.send({doc:this.name,meta:{path:["shout"],value:e}})}},{key:"open",value:function(e){var t=this;if(this.autoOpen=!0,"closed"===this.state){var n={doc:this.name,open:!0};return void 0===this.snapshot&&(n.snapshot=null),this.type&&(n.type=this.type.name),null!=this.version&&(n.v=this.version),this._create&&(n.create=!0),this.connection.send(n),this.state="opening",this._openCallback=function(n){return t._openCallback=null,"function"==typeof e?e(n):void 0}}}},{key:"close",value:function(e){return this.autoOpen=!1,"closed"===this.state?"function"==typeof e?e():void 0:(this.connection.send({doc:this.name,open:!1}),this.state="closed",this.emit("closing"),this._closeCallback=e)}}]),e}();return _.mixin(b),u.Doc=b,u})();window.sharejs}}]);